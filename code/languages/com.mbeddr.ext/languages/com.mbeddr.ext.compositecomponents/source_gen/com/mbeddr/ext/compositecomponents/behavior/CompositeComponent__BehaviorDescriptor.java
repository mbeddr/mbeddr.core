package com.mbeddr.ext.compositecomponents.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import jetbrains.mps.baseLanguage.tuples.runtime.Tuples;
import java.util.List;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.internal.collections.runtime.Sequence;
import com.mbeddr.ext.components.behavior.Component__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import jetbrains.mps.baseLanguage.closures.runtime.Wrappers;
import com.mbeddr.ext.components.behavior.Runnable__BehaviorDescriptor;
import jetbrains.mps.baseLanguage.tuples.runtime.MultiTuple;
import com.mbeddr.core.base.behavior.IRequiresConfigItem__BehaviorDescriptor;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public final class CompositeComponent__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0x54f2a59b97bb4c09L, 0xaf92928ebf9c5966L, 0x6bfba9786e44b3b0L, "com.mbeddr.ext.compositecomponents.structure.CompositeComponent");

  public static final SMethod<SNode> resolveEffectiveRunnableForOperation_idpTHqv6LhL9 = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("resolveEffectiveRunnableForOperation").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(466603768608529481L).languageId(0x97fc7bd73b1f5f40L, 0x97d2424451db4e2eL).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""), SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<Boolean> isAbstract_id3PT6Z48L3oi = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isAbstract").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4429602430543738386L).languageId(0x97fc7bd73b1f5f40L, 0x97d2424451db4e2eL).build2();
  public static final SMethod<SNode> innerInstanceConfig_id6JVEnxIjbYq = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("innerInstanceConfig").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(7780999115924357018L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<Iterable<SNode>> delegatingConnectors_id4FYctDz5Kra = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("delegatingConnectors").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5403811416926258890L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<Iterable<SNode>> allDelegatedProvidedPorts_id4FYctDz4gVr = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("allDelegatedProvidedPorts").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5403811416925867739L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<Iterable<SNode>> allDelegatedRequiredPorts_id4FYctDz4pxF = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("allDelegatedRequiredPorts").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5403811416925902955L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<Iterable<SNode>> allNonDelegatedProvidedPorts_id4FYctDz4zDx = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("allNonDelegatedProvidedPorts").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5403811416925944417L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<Iterable<SNode>> allNonDelegatedRequiredPorts_id4FYctDz4QOB = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("allNonDelegatedRequiredPorts").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5403811416926022951L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<String> generatedInstanceConfigFunctionName_id6JVEnxIjv5t = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("generatedInstanceConfigFunctionName").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(7780999115924435293L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<Boolean> isDelegated_id3_MZZHrtYKG = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isDelegated").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4139652462543367212L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<SNode> getDelegatingConnector_id3_MZZHrtYP0 = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("getDelegatingConnector").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4139652462543367488L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<Boolean> translatesIntoAtomicComponent_id3_MZZHrtZ3j = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("translatesIntoAtomicComponent").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4139652462543368403L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<String> shadowComponentName_id5vJvKD7x8Ka = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("shadowComponentName").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882859846666L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<SNode> createShadowComponent_id5vJvKD7x8K0 = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("createShadowComponent").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882859846656L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<SNode> findShadowComponent_id5vJvKD7x8Kk = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("findShadowComponent").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882859846676L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<SNode> createShadowInstance_id5vJvKD7xN05 = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("createShadowInstance").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882860019717L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<SNode> findShadowInstance_id5vJvKD7xN3Q = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("findShadowInstance").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882860019958L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<String> shadowInstanceName_id5vJvKD7xPJg = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("shadowInstanceName").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882860030928L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2();
  public static final SMethod<Boolean> isDelegated_id5vJvKD7x94j = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isDelegated").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882859847955L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<Iterable<Tuples._2<SNode, SNode>>> delegationTarget_id5vJvKD7x92J = new SMethodBuilder<Iterable<Tuples._2<SNode, SNode>>>(new SJavaCompoundTypeImpl((Class<Iterable<Tuples._2<SNode, SNode>>>) ((Class) Object.class))).name("delegationTarget").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6336422882859847855L).languageId(0xaf92928ebf9c5966L, 0x54f2a59b97bb4c09L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<Iterable<SNode>> getUniquelyNamedElements_id4qSf1u1TRfj = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("getUniquelyNamedElements").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5095889050031059923L).languageId(0xaa41d1b2bffa7eb1L, 0xd4280a54f6df4383L).build2();
  public static final SMethod<Boolean> exportable_id5HxjapwgqKI = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("exportable").modifiers(9, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6584628407655574574L).languageId(0x8efc09336c1b0001L, 0x6d11763d483d4b2bL).build2();
  public static final SMethod<List<SNode>> getConfigItem_id5HxjapwgqMb = new SMethodBuilder<List<SNode>>(new SJavaCompoundTypeImpl((Class<List<SNode>>) ((Class) Object.class))).name("getConfigItem").modifiers(9, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6584628407655574667L).languageId(0xaa41d1b2bffa7eb1L, 0xd4280a54f6df4383L).build2();

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(resolveEffectiveRunnableForOperation_idpTHqv6LhL9, isAbstract_id3PT6Z48L3oi, innerInstanceConfig_id6JVEnxIjbYq, delegatingConnectors_id4FYctDz5Kra, allDelegatedProvidedPorts_id4FYctDz4gVr, allDelegatedRequiredPorts_id4FYctDz4pxF, allNonDelegatedProvidedPorts_id4FYctDz4zDx, allNonDelegatedRequiredPorts_id4FYctDz4QOB, generatedInstanceConfigFunctionName_id6JVEnxIjv5t, isDelegated_id3_MZZHrtYKG, getDelegatingConnector_id3_MZZHrtYP0, translatesIntoAtomicComponent_id3_MZZHrtZ3j, shadowComponentName_id5vJvKD7x8Ka, createShadowComponent_id5vJvKD7x8K0, findShadowComponent_id5vJvKD7x8Kk, createShadowInstance_id5vJvKD7xN05, findShadowInstance_id5vJvKD7xN3Q, shadowInstanceName_id5vJvKD7xPJg, isDelegated_id5vJvKD7x94j, delegationTarget_id5vJvKD7x92J, getUniquelyNamedElements_id4qSf1u1TRfj, exportable_id5HxjapwgqKI, getConfigItem_id5HxjapwgqMb);

  private static void ___init___(@NotNull SNode __thisNode__) {
    SLinkOperations.addNewChild(__thisNode__, LINKS.contents$Hh35, CONCEPTS.CompositeComponentInstanceConfig$8Y);
    SPropertyOperations.assign(__thisNode__, PROPS.exported$V4am, true);
  }

  /*package*/ static SNode resolveEffectiveRunnableForOperation_idpTHqv6LhL9(@NotNull SNode __thisNode__, SNode port, SNode op) {
    return null;
  }
  /*package*/ static boolean isAbstract_id3PT6Z48L3oi(@NotNull SNode __thisNode__) {
    return false;
  }
  /*package*/ static SNode innerInstanceConfig_id6JVEnxIjbYq(@NotNull SNode __thisNode__) {
    return SNodeOperations.cast(ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.contents$Hh35)).findFirst((it) -> SNodeOperations.isInstanceOf(it, CONCEPTS.CompositeComponentInstanceConfig$8Y)), CONCEPTS.CompositeComponentInstanceConfig$8Y);
  }
  /*package*/ static Iterable<SNode> delegatingConnectors_id4FYctDz5Kra(@NotNull SNode __thisNode__) {
    return CompositeComponentInstanceConfig__BehaviorDescriptor.delegatingConnectors_id3_MZZHrtYLf.invoke(CompositeComponent__BehaviorDescriptor.innerInstanceConfig_id6JVEnxIjbYq.invoke(__thisNode__));
  }
  /*package*/ static Iterable<SNode> allDelegatedProvidedPorts_id4FYctDz4gVr(@NotNull SNode __thisNode__) {
    return SNodeOperations.ofConcept(Sequence.fromIterable(CompositeComponent__BehaviorDescriptor.delegatingConnectors_id4FYctDz5Kra.invoke(__thisNode__)).select((it) -> SLinkOperations.getTarget(it, LINKS.outsidePort$z5z3)), CONCEPTS.ProvidedPort$RN);
  }
  /*package*/ static Iterable<SNode> allDelegatedRequiredPorts_id4FYctDz4pxF(@NotNull SNode __thisNode__) {
    return SNodeOperations.ofConcept(Sequence.fromIterable(CompositeComponent__BehaviorDescriptor.delegatingConnectors_id4FYctDz5Kra.invoke(__thisNode__)).select((it) -> SLinkOperations.getTarget(it, LINKS.outsidePort$z5z3)), CONCEPTS.RequiredPort$Si);
  }
  /*package*/ static Iterable<SNode> allNonDelegatedProvidedPorts_id4FYctDz4zDx(@NotNull SNode __thisNode__) {
    return Sequence.fromIterable(Component__BehaviorDescriptor.allProvidedPorts_id71UKpntoZW7.invoke(__thisNode__)).disjunction(Sequence.fromIterable(CompositeComponent__BehaviorDescriptor.allDelegatedProvidedPorts_id4FYctDz4gVr.invoke(__thisNode__)).distinct());
  }
  /*package*/ static Iterable<SNode> allNonDelegatedRequiredPorts_id4FYctDz4QOB(@NotNull SNode __thisNode__) {
    return Sequence.fromIterable(Component__BehaviorDescriptor.allRequiredPorts_id71UKpntoZWS.invoke(__thisNode__)).disjunction(Sequence.fromIterable(CompositeComponent__BehaviorDescriptor.allDelegatedRequiredPorts_id4FYctDz4pxF.invoke(__thisNode__)).distinct());
  }
  /*package*/ static String generatedInstanceConfigFunctionName_id6JVEnxIjv5t(@NotNull SNode __thisNode__) {
    return "cc_instanceconfig_init_" + SPropertyOperations.getString(__thisNode__, PROPS.name$MnvL);
  }
  /*package*/ static boolean isDelegated_id3_MZZHrtYKG(@NotNull SNode __thisNode__, SNode p) {
    return (CompositeComponent__BehaviorDescriptor.getDelegatingConnector_id3_MZZHrtYP0.invoke(__thisNode__, p) != null);
  }
  /*package*/ static SNode getDelegatingConnector_id3_MZZHrtYP0(@NotNull SNode __thisNode__, final SNode p) {
    return Sequence.fromIterable(CompositeComponentInstanceConfig__BehaviorDescriptor.delegatingConnectors_id3_MZZHrtYLf.invoke(CompositeComponent__BehaviorDescriptor.innerInstanceConfig_id6JVEnxIjbYq.invoke(__thisNode__))).findFirst((it) -> SLinkOperations.getTarget(it, LINKS.outsidePort$z5z3) == p);
  }
  /*package*/ static boolean translatesIntoAtomicComponent_id3_MZZHrtZ3j(@NotNull SNode __thisNode__) {
    // TODO should be added later again as an optimization
    return true;
  }
  /*package*/ static String shadowComponentName_id5vJvKD7x8Ka(@NotNull SNode __thisNode__) {
    return SPropertyOperations.getString(__thisNode__, PROPS.name$MnvL);
  }
  /*package*/ static SNode createShadowComponent_id5vJvKD7x8K0(@NotNull final SNode __thisNode__) {
    final SNode shadow = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4de73L, "com.mbeddr.ext.components.structure.AtomicComponent"));

    SNode ccName = new IAttributeDescriptor.NodeAttribute(CONCEPTS.CompositeComponentName$Sr).setNew(shadow);
    SPropertyOperations.assign(ccName, PROPS.name$MnvL, SPropertyOperations.getString(__thisNode__, PROPS.name$MnvL));
    SPropertyOperations.assign(shadow, PROPS.name$MnvL, CompositeComponent__BehaviorDescriptor.shadowComponentName_id5vJvKD7x8Ka.invoke(__thisNode__));
    SPropertyOperations.assign(shadow, PROPS.exported$V4am, SPropertyOperations.getBoolean(__thisNode__, PROPS.exported$V4am));
    ListSequence.fromList(SLinkOperations.getChildren(shadow, LINKS.contents$Hh35)).addSequence(ListSequence.fromList(SLinkOperations.getChildren(__thisNode__, LINKS.contents$Hh35)).where((it) -> !(SNodeOperations.isInstanceOf(it, CONCEPTS.CompositeComponentInstanceConfig$8Y)) && !(SNodeOperations.isInstanceOf(it, CONCEPTS.ProvidedPort$RN) && ((boolean) CompositeComponent__BehaviorDescriptor.isDelegated_id3_MZZHrtYKG.invoke(__thisNode__, SNodeOperations.cast(it, CONCEPTS.ProvidedPort$RN))))).select((it) -> SNodeOperations.copyNode(it)));

    // rebind references to fields and required ports (now owned by shadow instead of CC)
    ListSequence.fromList(SNodeOperations.getNodeDescendants(shadow, CONCEPTS.FieldRef$b$, false, new SAbstractConcept[]{})).visitAll((final SNode fieldRef) -> SLinkOperations.setTarget(fieldRef, LINKS.field$P8O8, Sequence.fromIterable(Component__BehaviorDescriptor.fields_id6JVEnxIj2nQ.invoke(shadow)).findFirst((field) -> SPropertyOperations.getString(field, PROPS.name$MnvL).equals(SPropertyOperations.getString(SLinkOperations.getTarget(fieldRef, LINKS.field$P8O8), PROPS.name$MnvL)))));
    ListSequence.fromList(SNodeOperations.getNodeDescendants(shadow, CONCEPTS.PortRefExpr$IW, false, new SAbstractConcept[]{})).visitAll((final SNode portRef) -> SLinkOperations.setTarget(portRef, LINKS.port$IUw8, Sequence.fromIterable(Component__BehaviorDescriptor.allRequiredPorts_id71UKpntoZWS.invoke(shadow)).findFirst((field) -> SPropertyOperations.getString(field, PROPS.name$MnvL).equals(SPropertyOperations.getString(SLinkOperations.getTarget(portRef, LINKS.port$IUw8), PROPS.name$MnvL)))));
    ListSequence.fromList(SNodeOperations.getNodeDescendants(shadow, CONCEPTS.OperationTrigger$S8, false, new SAbstractConcept[]{})).visitAll((final SNode opTrigger) -> SLinkOperations.setTarget(opTrigger, LINKS.providedPort$G_H1, Sequence.fromIterable(Component__BehaviorDescriptor.allProvidedPorts_id71UKpntoZW7.invoke(shadow)).findFirst((pp) -> SPropertyOperations.getString(pp, PROPS.name$MnvL).equals(SPropertyOperations.getString(SLinkOperations.getTarget(opTrigger, LINKS.providedPort$G_H1), PROPS.name$MnvL)))));
    ListSequence.fromList(SNodeOperations.getNodeDescendants(shadow, CONCEPTS.InternalRunnableCall$$h, false, new SAbstractConcept[]{})).visitAll((final SNode call) -> SLinkOperations.setTarget(call, LINKS.runnable$RlaC, Sequence.fromIterable(Component__BehaviorDescriptor.allRunnables_id7BIOMJxff0s.invoke(shadow)).findFirst((r) -> SPropertyOperations.getString(r, PROPS.name$MnvL).equals(SPropertyOperations.getString(SLinkOperations.getTarget(call, LINKS.runnable$RlaC), PROPS.name$MnvL)))));

    // if CC has on-init runnable, it is moved over to the shadow component; otherwise create one.
    final Wrappers._T<SNode> onInitRunnable = new Wrappers._T<SNode>(Component__BehaviorDescriptor.onInitRunnable_id6JVEnxIjpG_.invoke(shadow));
    if ((onInitRunnable.value == null)) {
      onInitRunnable.value = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4c1c6L, "com.mbeddr.ext.components.structure.Runnable"));
      SLinkOperations.setTarget(onInitRunnable.value, LINKS.type$sXU3, SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x6d872ef9245a0d19L, "com.mbeddr.core.expressions.structure.VoidType")));
      SLinkOperations.setTarget(onInitRunnable.value, LINKS.trigger$4EcB, SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x4070c9f3cc58752aL, "com.mbeddr.ext.components.structure.OnInitTrigger")));
      SPropertyOperations.assign(onInitRunnable.value, PROPS.name$MnvL, "__setup");
      SLinkOperations.addNewChild(SLinkOperations.getTarget(onInitRunnable.value, LINKS.body$Qjc8), LINKS.statements$euTV, CONCEPTS.InitializeInternalInstances$pc);
      ListSequence.fromList(SLinkOperations.getChildren(shadow, LINKS.contents$Hh35)).addElement(onInitRunnable.value);
    }

    // fill all the on init runnable calls with their corresponding provided ports references as arguments
    Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.collectMany(SNodeOperations.ofConcept(SLinkOperations.getChildren(__thisNode__, LINKS.contents$Hh35), CONCEPTS.CompositeComponentInstanceConfig$8Y), LINKS.contents$E4B8), CONCEPTS.ComponentInstance$zN)).translate((it) -> (Iterable<SNode>) Runnable__BehaviorDescriptor.allReferencedProvidedPortsWithContext_id3LPPE_giCuF.invoke(Component__BehaviorDescriptor.onInitRunnable_id6JVEnxIjpG_.invoke(SLinkOperations.getTarget(it, LINKS.component$ikVC)), SPropertyOperations.getString(it, PROPS.name$MnvL))).visitAll((it) -> ListSequence.fromList(SLinkOperations.getChildren(onInitRunnable.value, LINKS.arguments$6da0)).addElement(createArgument_hlt2xp_a0a0a0a0t0n(SPropertyOperations.getString(it, PROPS.instanceName$PjJE) + "_" + SPropertyOperations.getString(SLinkOperations.getTarget(it, LINKS.providedPort$Pdbe), PROPS.name$MnvL), SLinkOperations.getTarget(SLinkOperations.getTarget(it, LINKS.providedPort$Pdbe), LINKS.intf$QYND))));
    return shadow;
  }
  /*package*/ static SNode findShadowComponent_id5vJvKD7x8Kk(@NotNull final SNode __thisNode__) {
    return SNodeOperations.cast(ListSequence.fromList(SNodeOperations.getAllSiblings(__thisNode__, false)).findFirst((it) -> SNodeOperations.isInstanceOf(it, CONCEPTS.AtomicComponent$ym) && SPropertyOperations.getString(SNodeOperations.cast(it, CONCEPTS.AtomicComponent$ym), PROPS.name$MnvL).equals(CompositeComponent__BehaviorDescriptor.shadowComponentName_id5vJvKD7x8Ka.invoke(__thisNode__))), CONCEPTS.AtomicComponent$ym);
  }
  /*package*/ static SNode createShadowInstance_id5vJvKD7xN05(@NotNull SNode __thisNode__) {
    SNode shadowInstance = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4de76L, "com.mbeddr.ext.components.structure.ComponentInstance"));

    SPropertyOperations.assign(shadowInstance, PROPS.name$MnvL, CompositeComponent__BehaviorDescriptor.shadowInstanceName_id5vJvKD7xPJg.invoke(__thisNode__));

    // We set the component here in that way so that the constraint is not called. Otherwise an init field initializer would be created by that constraint
    shadowInstance.setReferenceTarget(LINKS.component$ikVC, CompositeComponent__BehaviorDescriptor.findShadowComponent_id5vJvKD7x8Kk.invoke(__thisNode__));
    return shadowInstance;
  }
  /*package*/ static SNode findShadowInstance_id5vJvKD7xN3Q(@NotNull final SNode __thisNode__) {
    return SNodeOperations.cast(ListSequence.fromList(SLinkOperations.getChildren(CompositeComponent__BehaviorDescriptor.innerInstanceConfig_id6JVEnxIjbYq.invoke(__thisNode__), LINKS.contents$E4B8)).findFirst((it) -> SNodeOperations.isInstanceOf(it, CONCEPTS.ComponentInstance$zN) && SPropertyOperations.getString(SNodeOperations.cast(it, CONCEPTS.ComponentInstance$zN), PROPS.name$MnvL).equals(CompositeComponent__BehaviorDescriptor.shadowInstanceName_id5vJvKD7xPJg.invoke(__thisNode__))), CONCEPTS.ComponentInstance$zN);
  }
  /*package*/ static String shadowInstanceName_id5vJvKD7xPJg(@NotNull SNode __thisNode__) {
    return "__shadow";
  }
  /*package*/ static boolean isDelegated_id5vJvKD7x94j(@NotNull SNode __thisNode__, SNode port) {
    return CompositeComponent__BehaviorDescriptor.delegationTarget_id5vJvKD7x92J.invoke(__thisNode__, port) != null;
  }
  /*package*/ static Iterable<Tuples._2<SNode, SNode>> delegationTarget_id5vJvKD7x92J(@NotNull SNode __thisNode__, final SNode port) {
    return Sequence.fromIterable(CompositeComponentInstanceConfig__BehaviorDescriptor.delegatingConnectors_id3_MZZHrtYLf.invoke(CompositeComponent__BehaviorDescriptor.innerInstanceConfig_id6JVEnxIjbYq.invoke(__thisNode__))).where((it) -> SLinkOperations.getTarget(it, LINKS.outsidePort$z5z3) == port).select((it) -> MultiTuple.<SNode,SNode>from(SLinkOperations.getTarget(it, LINKS.internalInstance$2LQn), SLinkOperations.getTarget(it, LINKS.internalPort$2M5o)));
  }
  /*package*/ static Iterable<SNode> getUniquelyNamedElements_id4qSf1u1TRfj(@NotNull SNode __thisNode__) {
    return SNodeOperations.ofConcept(SLinkOperations.getChildren(__thisNode__, LINKS.contents$Hh35), CONCEPTS.INamedConcept$Kd);
  }
  /*package*/ static boolean exportable_id5HxjapwgqKI(@NotNull SAbstractConcept __thisConcept__) {
    return true;
  }
  /*package*/ static List<SNode> getConfigItem_id5HxjapwgqMb(@NotNull SAbstractConcept __thisConcept__) {
    List<SNode> result = IRequiresConfigItem__BehaviorDescriptor.getConfigItem_id5HxjapwgqMb.invoke0(__thisConcept__, CONCEPTS.Component$va);
    ListSequence.fromList(result).addElement(SNodeOperations.getNode("r:34a46663-c408-427f-8f72-90db466b797d(com.mbeddr.ext.compositecomponents.structure)", "7540109328385923714"));
    return result;
  }

  /*package*/ CompositeComponent__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((SNode) resolveEffectiveRunnableForOperation_idpTHqv6LhL9(node, (SNode) parameters[0], (SNode) parameters[1]));
      case 1:
        return (T) ((Boolean) isAbstract_id3PT6Z48L3oi(node));
      case 2:
        return (T) ((SNode) innerInstanceConfig_id6JVEnxIjbYq(node));
      case 3:
        return (T) ((Iterable<SNode>) delegatingConnectors_id4FYctDz5Kra(node));
      case 4:
        return (T) ((Iterable<SNode>) allDelegatedProvidedPorts_id4FYctDz4gVr(node));
      case 5:
        return (T) ((Iterable<SNode>) allDelegatedRequiredPorts_id4FYctDz4pxF(node));
      case 6:
        return (T) ((Iterable<SNode>) allNonDelegatedProvidedPorts_id4FYctDz4zDx(node));
      case 7:
        return (T) ((Iterable<SNode>) allNonDelegatedRequiredPorts_id4FYctDz4QOB(node));
      case 8:
        return (T) ((String) generatedInstanceConfigFunctionName_id6JVEnxIjv5t(node));
      case 9:
        return (T) ((Boolean) isDelegated_id3_MZZHrtYKG(node, (SNode) parameters[0]));
      case 10:
        return (T) ((SNode) getDelegatingConnector_id3_MZZHrtYP0(node, (SNode) parameters[0]));
      case 11:
        return (T) ((Boolean) translatesIntoAtomicComponent_id3_MZZHrtZ3j(node));
      case 12:
        return (T) ((String) shadowComponentName_id5vJvKD7x8Ka(node));
      case 13:
        return (T) ((SNode) createShadowComponent_id5vJvKD7x8K0(node));
      case 14:
        return (T) ((SNode) findShadowComponent_id5vJvKD7x8Kk(node));
      case 15:
        return (T) ((SNode) createShadowInstance_id5vJvKD7xN05(node));
      case 16:
        return (T) ((SNode) findShadowInstance_id5vJvKD7xN3Q(node));
      case 17:
        return (T) ((String) shadowInstanceName_id5vJvKD7xPJg(node));
      case 18:
        return (T) ((Boolean) isDelegated_id5vJvKD7x94j(node, (SNode) parameters[0]));
      case 19:
        return (T) ((Iterable<Tuples._2<SNode, SNode>>) delegationTarget_id5vJvKD7x92J(node, (SNode) parameters[0]));
      case 20:
        return (T) ((Iterable<SNode>) getUniquelyNamedElements_id4qSf1u1TRfj(node));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 21:
        return (T) ((Boolean) exportable_id5HxjapwgqKI(concept));
      case 22:
        return (T) ((List<SNode>) getConfigItem_id5HxjapwgqMb(concept));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }
  private static SNode createArgument_hlt2xp_a0a0a0a0t0n(String p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.Argument$9m);
    n0.setProperty(PROPS.name$MnvL, p0);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.type$sXU3).init(CONCEPTS.InterfaceType$7N);
      n1.setReferenceTarget(LINKS.intf$e6VC, p1);
    }
    return n0.getResult();
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink contents$Hh35 = MetaAdapterFactory.getContainmentLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a235c9L, 0x53d712bee4273158L, "contents");
    /*package*/ static final SReferenceLink outsidePort$z5z3 = MetaAdapterFactory.getReferenceLink(0x54f2a59b97bb4c09L, 0xaf92928ebf9c5966L, 0x6bfba9786e4aa19eL, 0x6bfba9786e4aa1c7L, "outsidePort");
    /*package*/ static final SReferenceLink field$P8O8 = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x49ac54536383aff9L, 0x49ac54536383affaL, "field");
    /*package*/ static final SReferenceLink port$IUw8 = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x707ac195dd6397aaL, 0x707ac195dd6397abL, "port");
    /*package*/ static final SReferenceLink providedPort$G_H1 = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3ea55efd4126ca5eL, 0x3ea55efd4126d978L, "providedPort");
    /*package*/ static final SReferenceLink runnable$RlaC = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x12151330b682b51dL, 0x12151330b682b51eL, "runnable");
    /*package*/ static final SContainmentLink type$sXU3 = MetaAdapterFactory.getContainmentLink(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x46a2a92ac61b183L, 0x46a2a92ac61b184L, "type");
    /*package*/ static final SContainmentLink trigger$4EcB = MetaAdapterFactory.getContainmentLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4c1c6L, 0x3e5659cd94a4ca74L, "trigger");
    /*package*/ static final SContainmentLink body$Qjc8 = MetaAdapterFactory.getContainmentLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4c1c6L, 0x3e5659cd94a57da3L, "body");
    /*package*/ static final SContainmentLink statements$euTV = MetaAdapterFactory.getContainmentLink(0xa9d696470840491eL, 0xbf392eb0805d2011L, 0x3a16e3a9c7ad9955L, 0x3a16e3a9c7ad9956L, "statements");
    /*package*/ static final SContainmentLink contents$E4B8 = MetaAdapterFactory.getContainmentLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x6bfba9786e466b00L, 0x6bfba9786e467315L, "contents");
    /*package*/ static final SReferenceLink component$ikVC = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4de76L, 0x3e5659cd94a4de77L, "component");
    /*package*/ static final SContainmentLink arguments$6da0 = MetaAdapterFactory.getContainmentLink(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x707ac195dd5d51f2L, 0x4f39f90935e92f45L, "arguments");
    /*package*/ static final SReferenceLink providedPort$Pdbe = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x2a85aaf6fa57eba2L, 0x2a85aaf6fa58cdefL, "providedPort");
    /*package*/ static final SReferenceLink intf$QYND = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a25d82L, 0x3e5659cd94a25d84L, "intf");
    /*package*/ static final SReferenceLink internalInstance$2LQn = MetaAdapterFactory.getReferenceLink(0x54f2a59b97bb4c09L, 0xaf92928ebf9c5966L, 0x6bfba9786e4aa19eL, 0x6bfba9786e4b773dL, "internalInstance");
    /*package*/ static final SReferenceLink internalPort$2M5o = MetaAdapterFactory.getReferenceLink(0x54f2a59b97bb4c09L, 0xaf92928ebf9c5966L, 0x6bfba9786e4aa19eL, 0x6bfba9786e4b773eL, "internalPort");
    /*package*/ static final SReferenceLink intf$e6VC = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x707ac195dd613e9cL, 0x707ac195dd613e9dL, "intf");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept CompositeComponentInstanceConfig$8Y = MetaAdapterFactory.getConcept(0x54f2a59b97bb4c09L, 0xaf92928ebf9c5966L, 0x6bfba9786e4680d3L, "com.mbeddr.ext.compositecomponents.structure.CompositeComponentInstanceConfig");
    /*package*/ static final SConcept ProvidedPort$RN = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a48fa8L, "com.mbeddr.ext.components.structure.ProvidedPort");
    /*package*/ static final SConcept RequiredPort$Si = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a48fa9L, "com.mbeddr.ext.components.structure.RequiredPort");
    /*package*/ static final SConcept CompositeComponentName$Sr = MetaAdapterFactory.getConcept(0x54f2a59b97bb4c09L, 0xaf92928ebf9c5966L, 0x3c30d7a406607220L, "com.mbeddr.ext.compositecomponents.structure.CompositeComponentName");
    /*package*/ static final SConcept FieldRef$b$ = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x49ac54536383aff9L, "com.mbeddr.ext.components.structure.FieldRef");
    /*package*/ static final SConcept PortRefExpr$IW = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x707ac195dd6397aaL, "com.mbeddr.ext.components.structure.PortRefExpr");
    /*package*/ static final SConcept OperationTrigger$S8 = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4c1cdL, "com.mbeddr.ext.components.structure.OperationTrigger");
    /*package*/ static final SConcept InternalRunnableCall$$h = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x12151330b682b51dL, "com.mbeddr.ext.components.structure.InternalRunnableCall");
    /*package*/ static final SConcept InitializeInternalInstances$pc = MetaAdapterFactory.getConcept(0x54f2a59b97bb4c09L, 0xaf92928ebf9c5966L, 0x6bfba9786e4cbf4aL, "com.mbeddr.ext.compositecomponents.structure.InitializeInternalInstances");
    /*package*/ static final SConcept ComponentInstance$zN = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4de76L, "com.mbeddr.ext.components.structure.ComponentInstance");
    /*package*/ static final SConcept AtomicComponent$ym = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a4de73L, "com.mbeddr.ext.components.structure.AtomicComponent");
    /*package*/ static final SInterfaceConcept INamedConcept$Kd = MetaAdapterFactory.getInterfaceConcept(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, "jetbrains.mps.lang.core.structure.INamedConcept");
    /*package*/ static final SConcept Component$va = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x3e5659cd94a235c9L, "com.mbeddr.ext.components.structure.Component");
    /*package*/ static final SConcept Argument$9m = MetaAdapterFactory.getConcept(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x6d872ef9245a20d7L, "com.mbeddr.core.modules.structure.Argument");
    /*package*/ static final SConcept InterfaceType$7N = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x707ac195dd613e9cL, "com.mbeddr.ext.components.structure.InterfaceType");
  }

  private static final class PROPS {
    /*package*/ static final SProperty exported$V4am = MetaAdapterFactory.getProperty(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x595522006a5b934fL, 0x124a1a47a69807f0L, "exported");
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
    /*package*/ static final SProperty instanceName$PjJE = MetaAdapterFactory.getProperty(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x2a85aaf6fa57eba2L, 0x2a85aaf6fa58cdf6L, "instanceName");
  }
}
