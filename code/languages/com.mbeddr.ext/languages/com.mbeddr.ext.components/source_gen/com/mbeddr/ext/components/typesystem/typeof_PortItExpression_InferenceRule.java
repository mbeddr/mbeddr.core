package com.mbeddr.ext.components.typesystem;

/*Generated by MPS */

import jetbrains.mps.lang.typesystem.runtime.AbstractInferenceRule_Runtime;
import jetbrains.mps.lang.typesystem.runtime.InferenceRule_Runtime;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.typesystem.inference.TypeCheckingContext;
import jetbrains.mps.lang.typesystem.runtime.IsApplicableStatus;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.typesystem.inference.EquationInfo;
import com.mbeddr.core.expressions.behavior.IInitializationContext__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SProperty;

public class typeof_PortItExpression_InferenceRule extends AbstractInferenceRule_Runtime implements InferenceRule_Runtime {
  public typeof_PortItExpression_InferenceRule() {
  }
  public void applyRule(final SNode it, final TypeCheckingContext typeCheckingContext, IsApplicableStatus status) {
    if ((SNodeOperations.getNodeAncestor(it, CONCEPTS.ForEachPortStatement$3j, true, false) != null)) {
      {
        SNode _nodeToCheck_1029348928467 = it;
        EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:c480d4b6-a379-41b5-b76a-c94ccc817c4e(com.mbeddr.ext.components.typesystem)", "6616054089645035694", 0, null);
        typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:c480d4b6-a379-41b5-b76a-c94ccc817c4e(com.mbeddr.ext.components.typesystem)", "6616054089645008083", true), (SNode) SNodeOperations.copyNode(typeCheckingContext.typeOf(SNodeOperations.getNodeAncestor(it, CONCEPTS.ForEachPortStatement$3j, true, false), "r:c480d4b6-a379-41b5-b76a-c94ccc817c4e(com.mbeddr.ext.components.typesystem)", "5105303971783426315", true)), _info_12389875345);
      }
    } else if ((SNodeOperations.getNodeAncestor(it, CONCEPTS.ForEachPortVarStatement$iY, true, false) != null)) {
      SNode ancestor = SNodeOperations.getNodeAncestor(it, CONCEPTS.ForEachPortVarStatement$iY, true, false);
      SNode portType = SNodeOperations.cast(IInitializationContext__BehaviorDescriptor.getType_id67hg1wL_GfW.invoke(SLinkOperations.getTarget(ancestor, LINKS.portVarRef$8A5X)), CONCEPTS.PortType$gc);
      {
        SNode _nodeToCheck_1029348928467 = it;
        EquationInfo _info_12389875345 = new EquationInfo(_nodeToCheck_1029348928467, null, "r:c480d4b6-a379-41b5-b76a-c94ccc817c4e(com.mbeddr.ext.components.typesystem)", "7584262324101437402", 0, null);
        typeCheckingContext.createEquation((SNode) typeCheckingContext.typeOf(_nodeToCheck_1029348928467, "r:c480d4b6-a379-41b5-b76a-c94ccc817c4e(com.mbeddr.ext.components.typesystem)", "7584262324101437420", true), (SNode) createPortType_b439kk_a0c0a0a1(SLinkOperations.getTarget(portType, LINKS.port$jarD), SLinkOperations.getTarget(portType, LINKS.component$CcBY)), _info_12389875345);
      }
    }
  }
  public SAbstractConcept getApplicableConcept() {
    return CONCEPTS.PortItExpression$JS;
  }
  public IsApplicableStatus isApplicableAndPattern(SNode argument) {
    return new IsApplicableStatus(argument.getConcept().isSubConceptOf(getApplicableConcept()), null);
  }
  public boolean overrides() {
    return false;
  }
  private static SNode createPortType_b439kk_a0c0a0a1(SNode p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.PortType$gc);
    n0.setReferenceTarget(LINKS.port$jarD, p0);
    n0.setReferenceTarget(LINKS.component$CcBY, p1);
    n0.setProperty(PROPS.singlePortAccess$i$qY, "" + (true));
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ForEachPortStatement$3j = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x69f3833e7e61a939L, "com.mbeddr.ext.components.structure.ForEachPortStatement");
    /*package*/ static final SConcept ForEachPortVarStatement$iY = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x7970b44af5134d40L, "com.mbeddr.ext.components.structure.ForEachPortVarStatement");
    /*package*/ static final SConcept PortType$gc = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x176257c4ce13e2faL, "com.mbeddr.ext.components.structure.PortType");
    /*package*/ static final SConcept PortItExpression$JS = MetaAdapterFactory.getConcept(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x5bd0f22423fa0ee2L, "com.mbeddr.ext.components.structure.PortItExpression");
  }

  private static final class LINKS {
    /*package*/ static final SReferenceLink portVarRef$8A5X = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x7970b44af5134d40L, 0x7970b44af53f3588L, "portVarRef");
    /*package*/ static final SReferenceLink port$jarD = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x176257c4ce13e2faL, 0x176257c4ce192d0fL, "port");
    /*package*/ static final SReferenceLink component$CcBY = MetaAdapterFactory.getReferenceLink(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x176257c4ce13e2faL, 0x176257c4ce7e8c13L, "component");
  }

  private static final class PROPS {
    /*package*/ static final SProperty singlePortAccess$i$qY = MetaAdapterFactory.getProperty(0x97d2424451db4e2eL, 0x97fc7bd73b1f5f40L, 0x176257c4ce13e2faL, 0x6940b6668f82caf1L, "singlePortAccess");
  }
}
