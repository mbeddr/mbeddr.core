package com.mbeddr.ext.statemachines.utils;

/*Generated by MPS */

import java.util.regex.Pattern;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import java.util.regex.Matcher;
import com.mbeddr.ext.statemachines.behavior.AbstractTransition__BehaviorDescriptor;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;

public class StatemachineNamingUtils {

  private static String EVENT_ARG_VARIABLE_NAME_FORMAT = "___%s_%s_%s__arg";
  private static Pattern EVENT_ARG_VARIABLE_NAME_PATTERN = Pattern.compile("___\\w+_(\\w+)_\\w+__arg");

  private static String EVENTS_ARG_VARIABLE_NAME_FORMAT = "___%s_%s__args";
  private static String TRANSITON_END_LABEL_NAME_FORMAT = "%s_%s__end";

  public static String computeNameOfEventVariable(SNode machine, SNode evt, SNode arg) {
    return String.format(EVENT_ARG_VARIABLE_NAME_FORMAT, SPropertyOperations.getString(machine, PROPS.name$MnvL), SPropertyOperations.getString(evt, PROPS.name$MnvL), SPropertyOperations.getString(arg, PROPS.name$MnvL));
  }

  public static String computeNameOfEventsVariable(SNode machine, SNode evt) {
    return String.format(EVENTS_ARG_VARIABLE_NAME_FORMAT, SPropertyOperations.getString(machine, PROPS.name$MnvL), SPropertyOperations.getString(evt, PROPS.name$MnvL));
  }

  public static boolean isEventVariable(String varName) {
    return EVENT_ARG_VARIABLE_NAME_PATTERN.matcher(varName).matches();
  }

  public static String computeEventName(String varName) {
    Matcher matcher = EVENT_ARG_VARIABLE_NAME_PATTERN.matcher(varName);
    if (matcher.matches()) {
      return matcher.group(1);
    }
    return null;
  }

  public static String computeNameOfTransitionEndLabel(SNode machine, SNode transition) {
    return String.format(TRANSITON_END_LABEL_NAME_FORMAT, SPropertyOperations.getString(machine, PROPS.name$MnvL), AbstractTransition__BehaviorDescriptor.readableName_id5ngFs$3SyGM.invoke(transition));
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
  }
}
