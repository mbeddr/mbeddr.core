package com.mbeddr.core.buildconfig.typesystem;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import com.mbeddr.core.buildconfig.behavior.Binary__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import java.util.List;
import com.mbeddr.core.base.behavior.IRequiresConfigItem__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class MissingConfigurationItemsComputer {

  public static Iterable<SNode> computeMissingConfigItems(SNode bin) {
    Iterable<SNode> allModules = Binary__BehaviorDescriptor.allReferencedModules_id3BbcpZJ16uV.invoke(bin);
    Iterable<SNode> nodesWhichRequireConfigItem;
    nodesWhichRequireConfigItem = Sequence.fromIterable(allModules).translate((it) -> SNodeOperations.getNodeDescendants(it, CONCEPTS.IRequiresConfigItem$Ys, false, new SAbstractConcept[]{}));
    Iterable<SAbstractConcept> neededConfigItemsConcepts;
    neededConfigItemsConcepts = Sequence.fromIterable(nodesWhichRequireConfigItem).select((it) -> SNodeOperations.getConcept(it));
    Iterable<SNode> neededConfigItems;
    neededConfigItems = Sequence.fromIterable(neededConfigItemsConcepts).translate((it) -> (List<SNode>) IRequiresConfigItem__BehaviorDescriptor.getConfigItem_id5HxjapwgqMb.invoke(SNodeOperations.asSConcept(it))).distinct();
    Iterable<SNode> existingConfigItems;
    existingConfigItems = SNodeOperations.ofConcept(ListSequence.fromList(SLinkOperations.getChildren(SNodeOperations.getNodeAncestor(bin, CONCEPTS.BuildConfiguration$kH, false, false), LINKS.configurationItems$HPvE)).select((it) -> SNodeOperations.getConcept(it)).select((it) -> SNodeOperations.asNode(it)), CONCEPTS.ConceptDeclaration$gH);
    return Sequence.fromIterable(neededConfigItems).subtract(Sequence.fromIterable(existingConfigItems));
  }

  private static final class CONCEPTS {
    /*package*/ static final SInterfaceConcept IRequiresConfigItem$Ys = MetaAdapterFactory.getInterfaceConcept(0xd4280a54f6df4383L, 0xaa41d1b2bffa7eb1L, 0x16fdbcc716a403ecL, "com.mbeddr.core.base.structure.IRequiresConfigItem");
    /*package*/ static final SConcept BuildConfiguration$kH = MetaAdapterFactory.getConcept(0x2d7fadf533f64e80L, 0xa78f0f739add2bdeL, 0x6b1af9f9f43c2f48L, "com.mbeddr.core.buildconfig.structure.BuildConfiguration");
    /*package*/ static final SConcept ConceptDeclaration$gH = MetaAdapterFactory.getConcept(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0xf979ba0450L, "jetbrains.mps.lang.structure.structure.ConceptDeclaration");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink configurationItems$HPvE = MetaAdapterFactory.getContainmentLink(0xd4280a54f6df4383L, 0xaa41d1b2bffa7eb1L, 0x3de41a718bc20029L, 0x3de41a718bc2002aL, "configurationItems");
  }
}
