package com.mbeddr.core.buildconfig.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.generator.template.TemplateQueryContext;
import java.util.List;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import com.mbeddr.core.base.behavior.IConfigurationContainer__BehaviorDescriptor;
import jetbrains.mps.lang.core.behavior.INamedConcept__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SProperty;

public class BCHelper {
  public BCHelper() {
  }
  public static SNode findBC(SModel m, TemplateQueryContext ctx, String sourceGenerator) {
    List<SNode> buildConfigurations = SModelOperations.roots(m, CONCEPTS.BuildConfiguration$kH);
    if (ListSequence.fromList(buildConfigurations).isEmpty()) {
      return null;
    }
    if (ListSequence.fromList(buildConfigurations).count() > 1) {
      ctx.showErrorMessage(null, sourceGenerator + ": more than one build configurations found for " + SModelOperations.getModelName(m));
      return null;
    }
    return ListSequence.fromList(buildConfigurations).first();
  }
  public static SNode findBC(SModel m) {
    List<SNode> buildConfigurations = SModelOperations.roots(m, CONCEPTS.BuildConfiguration$kH);
    if (ListSequence.fromList(buildConfigurations).isEmpty() || ListSequence.fromList(buildConfigurations).count() > 1) {
      return null;
    }
    return ListSequence.fromList(buildConfigurations).first();
  }
  public static SNode expectBCConfigItem(SModel m, TemplateQueryContext ctx, String sourceGenerator, SNode concept) {
    SNode bc = findBC(m, ctx, sourceGenerator);
    if (bc == null) {
      return null;
    }
    SNode item = IConfigurationContainer__BehaviorDescriptor.findItemOfType_id3R$6B6bL1DB.invoke(bc, concept);
    if (item == null) {
      String modelName = INamedConcept__BehaviorDescriptor.getFqName_idhEwIO9y.invoke(SModelOperations.getModuleStub(m)) + "." + SModelOperations.getModelName(m);
      ctx.showErrorMessage(null, sourceGenerator + ": expected config item (" + SPropertyOperations.getString(concept, PROPS.conceptAlias$OL_L) + ") not found for model: " + modelName);
    }
    return item;
  }
  public static boolean hasBCConfigItem(SModel m, TemplateQueryContext ctx, String sourceGenerator, SNode concept, String infoMessage) {
    SNode bc = findBC(m, ctx, sourceGenerator);
    if (bc == null) {
      return false;
    }
    SNode item = IConfigurationContainer__BehaviorDescriptor.findItemOfType_id3R$6B6bL1DB.invoke(bc, concept);
    if (item != null) {
      return true;
    }
    ctx.showInformationMessage(null, "no config item " + SPropertyOperations.getString(concept, PROPS.name$MnvL) + "found; " + infoMessage);
    return false;
  }
  public static SNode findBCConfigItem(SModel m, TemplateQueryContext ctx, String sourceGenerator, SNode concept, String infoMessage) {
    SNode bc = findBC(m, ctx, sourceGenerator);
    if (bc == null) {
      return null;
    }
    SNode item = IConfigurationContainer__BehaviorDescriptor.findItemOfType_id3R$6B6bL1DB.invoke(bc, concept);
    if (item != null) {
      return item;
    }
    if ((infoMessage != null && infoMessage.length() > 0)) {
      ctx.showInformationMessage(null, "no config item " + SPropertyOperations.getString(concept, PROPS.name$MnvL) + "found; " + infoMessage);
    }
    return item;
  }
  public static SNode expectSureCI(SModel m, TemplateQueryContext ctx, SNode concept) {
    SNode bc = ListSequence.fromList(SModelOperations.roots(m, CONCEPTS.BuildConfiguration$kH)).first();
    SNode item = IConfigurationContainer__BehaviorDescriptor.findItemOfType_id3R$6B6bL1DB.invoke(bc, concept);
    return item;
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept BuildConfiguration$kH = MetaAdapterFactory.getConcept(0x2d7fadf533f64e80L, 0xa78f0f739add2bdeL, 0x6b1af9f9f43c2f48L, "com.mbeddr.core.buildconfig.structure.BuildConfiguration");
  }

  private static final class PROPS {
    /*package*/ static final SProperty conceptAlias$OL_L = MetaAdapterFactory.getProperty(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0x1103553c5ffL, 0x46ab0ad5826c74caL, "conceptAlias");
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
  }
}
