package com.mbeddr.core.util.pluginSolution.plugin;

/*Generated by MPS */

import javax.swing.JPanel;
import org.jetbrains.mps.openapi.module.SRepository;
import com.mbeddr.core.base.pluginSolution.plugin.Filter;
import jetbrains.mps.project.DevKit;
import java.util.List;
import javax.swing.JCheckBox;
import org.jetbrains.mps.openapi.module.SModule;
import jetbrains.mps.VisibleModuleRegistry;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import com.intellij.uiDesigner.core.GridLayoutManager;
import com.intellij.uiDesigner.core.GridConstraints;

public class NewSolutionWizardHelper {

  protected static JPanel createDevKitPanel(SRepository repo, final Filter<DevKit> devkitFilter, final List<DevKit> devKits, List<JCheckBox> devKitBoxes) {

    Iterable<SModule> projectModules = repo.getModules();
    final VisibleModuleRegistry registry = VisibleModuleRegistry.getInstance();

    Sequence.fromIterable(projectModules).ofType(DevKit.class).where((it) -> registry.isVisible(it)).where((it) -> devkitFilter.filter(it)).visitAll((it) -> ListSequence.fromList(devKits).addElement(it));

    JPanel devkitPanle = new JPanel(new GridLayoutManager(6, (ListSequence.fromList(devKits).count() / 6) + 1));
    GridConstraints constrain = new GridConstraints(0, 0, 1, 1, GridConstraints.ANCHOR_NORTHWEST, GridConstraints.FILL_HORIZONTAL, GridConstraints.SIZEPOLICY_CAN_SHRINK | GridConstraints.SIZEPOLICY_CAN_GROW, GridConstraints.SIZEPOLICY_FIXED, null, null, null);
    int i = 0;
    for (String devkit : ListSequence.fromList(devKits).select((it) -> it.getModuleName())) {
      JCheckBox box = new JCheckBox(devkit);
      ListSequence.fromList(devKitBoxes).addElement(box);
      devkitPanle.add(box, constrain);
      i++;
      constrain.setRow(i % 6);
      constrain.setColumn(i / 6);
    }
    return devkitPanle;
  }
}
