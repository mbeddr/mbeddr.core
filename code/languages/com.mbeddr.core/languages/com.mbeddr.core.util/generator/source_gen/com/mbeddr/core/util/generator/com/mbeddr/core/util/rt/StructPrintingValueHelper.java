package com.mbeddr.core.util.generator.com.mbeddr.core.util.rt;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;

public class StructPrintingValueHelper {

  public static void addAnnotationRecursively(SNode decl) {

    for (SNode m : Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(decl, LINKS.members$C59R), CONCEPTS.Member$J1))) {
      SNode type = unwrap(SLinkOperations.getTarget(m, LINKS.type$sXU3));
      {
        final SNode pt = type;
        if (SNodeOperations.isInstanceOf(pt, CONCEPTS.PointerType$HX)) {
          {
            final SNode st = unwrap(SLinkOperations.getTarget(pt, LINKS.baseType$zMGV));
            if (SNodeOperations.isInstanceOf(st, CONCEPTS.StructType$B3)) {
              StructPrintingValueHelper.addAnnotation(st);
            }
          }
        }
      }
      {
        final SNode pt = type;
        if (SNodeOperations.isInstanceOf(pt, CONCEPTS.ArrayType$WW)) {
          {
            final SNode st = unwrap(SLinkOperations.getTarget(pt, LINKS.baseType$zMGV));
            if (SNodeOperations.isInstanceOf(st, CONCEPTS.StructType$B3)) {
              StructPrintingValueHelper.addAnnotation(st);
            }
          }
        }
      }
      {
        final SNode st = type;
        if (SNodeOperations.isInstanceOf(st, CONCEPTS.StructType$B3)) {
          StructPrintingValueHelper.addAnnotation(st);
        }
      }
    }
  }
  private static void addAnnotation(SNode st) {
    if ((new IAttributeDescriptor.NodeAttribute(CONCEPTS.GenStructPrintFunction$aj).get(SLinkOperations.getTarget(st, LINKS.struct$WCsg)) == null)) {
      new IAttributeDescriptor.NodeAttribute(CONCEPTS.GenStructPrintFunction$aj).setNew(SLinkOperations.getTarget(st, LINKS.struct$WCsg));
      addAnnotationRecursively(SLinkOperations.getTarget(st, LINKS.struct$WCsg));
    }
  }

  private static SNode unwrap(SNode original) {
    {
      final SNode tdt = original;
      if (SNodeOperations.isInstanceOf(tdt, CONCEPTS.TypeDefType$3U)) {
        return unwrap(SLinkOperations.getTarget(SLinkOperations.getTarget(tdt, LINKS.typeDef$LmRK), LINKS.original$$TxO));
      }
    }
    return original;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink type$sXU3 = MetaAdapterFactory.getContainmentLink(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x46a2a92ac61b183L, 0x46a2a92ac61b184L, "type");
    /*package*/ static final SContainmentLink baseType$zMGV = MetaAdapterFactory.getContainmentLink(0xa9d696470840491eL, 0xbf392eb0805d2011L, 0x6bbcdccef5e46755L, 0x6bbcdccef5e46756L, "baseType");
    /*package*/ static final SContainmentLink members$C59R = MetaAdapterFactory.getContainmentLink(0xefda956e491e4f00L, 0xba1436af2f213ecfL, 0x6285e27d4ff6c9f5L, 0x6285e27d4ff7db92L, "members");
    /*package*/ static final SReferenceLink struct$WCsg = MetaAdapterFactory.getReferenceLink(0xefda956e491e4f00L, 0xba1436af2f213ecfL, 0x58bef62304fc0a38L, 0x58bef62304fc0a39L, "struct");
    /*package*/ static final SReferenceLink typeDef$LmRK = MetaAdapterFactory.getReferenceLink(0xefda956e491e4f00L, 0xba1436af2f213ecfL, 0x54e261614fd09a17L, 0x54e261614fd09a18L, "typeDef");
    /*package*/ static final SContainmentLink original$$TxO = MetaAdapterFactory.getContainmentLink(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x6b0ac27ac5014717L, 0x54e261614fd09a16L, "original");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept PointerType$HX = MetaAdapterFactory.getConcept(0x3bf5377ae9044dedL, 0x97545a516023bfaaL, 0x3e0cae5e366d630L, "com.mbeddr.core.pointers.structure.PointerType");
    /*package*/ static final SConcept StructType$B3 = MetaAdapterFactory.getConcept(0xefda956e491e4f00L, 0xba1436af2f213ecfL, 0x58bef62304fc0a38L, "com.mbeddr.core.udt.structure.StructType");
    /*package*/ static final SConcept ArrayType$WW = MetaAdapterFactory.getConcept(0x3bf5377ae9044dedL, 0x97545a516023bfaaL, 0x4ed16d83a1d30c81L, "com.mbeddr.core.pointers.structure.ArrayType");
    /*package*/ static final SConcept Member$J1 = MetaAdapterFactory.getConcept(0xefda956e491e4f00L, 0xba1436af2f213ecfL, 0x51a277741cc50918L, "com.mbeddr.core.udt.structure.Member");
    /*package*/ static final SConcept GenStructPrintFunction$aj = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x5345bf19ce14aacL, "com.mbeddr.core.util.structure.GenStructPrintFunction");
    /*package*/ static final SConcept TypeDefType$3U = MetaAdapterFactory.getConcept(0xefda956e491e4f00L, 0xba1436af2f213ecfL, 0x54e261614fd09a17L, "com.mbeddr.core.udt.structure.TypeDefType");
  }
}
