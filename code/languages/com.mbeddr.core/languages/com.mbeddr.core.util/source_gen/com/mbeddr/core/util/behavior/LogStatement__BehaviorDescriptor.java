package com.mbeddr.core.util.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.model.SModel;
import java.util.List;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import de.slisson.mps.richtext.behavior.IWord__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import com.mbeddr.core.expressions.behavior.Type__BehaviorDescriptor;
import com.mbeddr.core.expressions.typesystem.MeetTypeHelper;
import jetbrains.mps.typechecking.TypecheckingFacade;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public final class LogStatement__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x1abfe28bd1ac1ac6L, "com.mbeddr.core.util.structure.LogStatement");

  public static final SMethod<Boolean> suppressSpaceAfter_id6TPUpo_efNz = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("suppressSpaceAfter").modifiers(1, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(7959524747526077667L).languageId(0xab13f57227d675f2L, 0x2693fc719b0e4b05L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<Boolean> suppressSpaceBefore_id3PUmE2lLGid = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("suppressSpaceBefore").modifiers(1, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4429952829226402957L).languageId(0xab13f57227d675f2L, 0x2693fc719b0e4b05L).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<String> messageString_id1EZSCJhUnyz = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("messageString").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(1927508255687932067L).languageId(0xab13f57227d675f2L, 0x2693fc719b0e4b05L).build2(SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<Iterable<SNode>> expressions_id1EZSCJhU$Wc = new SMethodBuilder<Iterable<SNode>>(new SJavaCompoundTypeImpl((Class<Iterable<SNode>>) ((Class) Object.class))).name("expressions").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(1927508255687986956L).languageId(0xab13f57227d675f2L, 0x2693fc719b0e4b05L).build2();

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(suppressSpaceAfter_id6TPUpo_efNz, suppressSpaceBefore_id3PUmE2lLGid, messageString_id1EZSCJhUnyz, expressions_id1EZSCJhU$Wc);

  private static void ___init___(@NotNull SNode __thisNode__) {
  }

  /*package*/ static boolean suppressSpaceAfter_id6TPUpo_efNz(@NotNull SAbstractConcept __thisConcept__, SNode word) {
    SAbstractConcept cncpt = SNodeOperations.getConcept(word);
    boolean noneMatched = true;
    if (noneMatched && SConceptOperations.isSubConceptOf(cncpt, CONCEPTS.Word$5r)) {
      noneMatched = false;
      // Return true if given message
      // - is empty, or
      // - ends with a space, \n or \t, or
      // - ends with certain punctuation mark (. , : ), or
      // - ends with 0x or #, or
      // - ends with some opening parenthesis-like character (( [ {), or
      // - ends with an arithmetic operator (+, -, *, /), or
      // - ends with \, ", ', or
      // - ends with § or ~
      return isEmptyString(IWord__BehaviorDescriptor.toTextString_id3Q5enzfMT4t.invoke(word)) || IWord__BehaviorDescriptor.toTextString_id3Q5enzfMT4t.invoke(word).matches(".*( |\\\\[nt]|[\\.,:]|0x|#|[\\(\\[\\{]|[\\+\\-*/]|[\\\\\"']|[§~])");
    }
    if (noneMatched && SConceptOperations.isSubConceptOf(cncpt, CONCEPTS.LogExpressionWord$CT)) {
      noneMatched = false;
      return false;
    }
    return (word == null) && isEmptyString(IWord__BehaviorDescriptor.toTextString_id3Q5enzfMT4t.invoke(word));
  }
  /*package*/ static boolean suppressSpaceBefore_id3PUmE2lLGid(@NotNull SAbstractConcept __thisConcept__, SNode word) {
    SAbstractConcept cncpt = SNodeOperations.getConcept(word);
    boolean noneMatched = true;
    if (noneMatched && SConceptOperations.isSubConceptOf(cncpt, CONCEPTS.Word$5r)) {
      noneMatched = false;
      // Return true if given word 
      // - is empty, or 
      // - starts with a space, \n or \t, or 
      // - starts with some punctuation mark (. , : ; ? !), or
      // - starts with some closing parenthesis-like character () ] }), or
      // - starts with an arithmetic operator (+, -, *, /), or
      // - starts with \, ", ', or
      // - starts with % or °
      return isEmptyString(IWord__BehaviorDescriptor.toTextString_id3Q5enzfMT4t.invoke(word)) || IWord__BehaviorDescriptor.toTextString_id3Q5enzfMT4t.invoke(word).matches("( |\\\\[nt]|[\\.,:;?!]|[\\)\\]\\}]|[\\+\\-*/]|[\\\\\"']|[%°]).*");
    }
    if (noneMatched && SConceptOperations.isSubConceptOf(cncpt, CONCEPTS.LogExpressionWord$CT)) {
      noneMatched = false;
      return false;
    }
    return (word == null) && isEmptyString(IWord__BehaviorDescriptor.toTextString_id3Q5enzfMT4t.invoke(word));
  }
  /*package*/ static String messageString_id1EZSCJhUnyz(@NotNull SNode __thisNode__, SModel model) {
    String result = "";

    for (SNode word : ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(__thisNode__, LINKS.text$OohJ), LINKS.words$C8QZ))) {
      {
        final SNode plainWord = word;
        if (SNodeOperations.isInstanceOf(plainWord, CONCEPTS.Word$5r)) {
          result += IWord__BehaviorDescriptor.toTextString_id3Q5enzfMT4t.invoke(plainWord);
        }
      }
      {
        final SNode exprWord = word;
        if (SNodeOperations.isInstanceOf(exprWord, CONCEPTS.LogExpressionWord$CT)) {
          result += Type__BehaviorDescriptor.getEffectivePrintfFormatSpecifier_id4zXqh6Tyh0Y.invoke(SNodeOperations.cast(MeetTypeHelper.getConcreteNonConstVolatileType(SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(SLinkOperations.getTarget(exprWord, LINKS.expr$tGvB)), CONCEPTS.IType$a9)), CONCEPTS.Type$dP), model);
        }
      }
      if (!((boolean) LogStatement__BehaviorDescriptor.suppressSpaceAfter_id6TPUpo_efNz.invoke(__thisNode__.getConcept(), word)) && !((boolean) LogStatement__BehaviorDescriptor.suppressSpaceBefore_id3PUmE2lLGid.invoke(__thisNode__.getConcept(), SNodeOperations.as(SNodeOperations.getNextSibling(word), CONCEPTS.IWord$8d)))) {
        result += " ";
      }
    }

    return result;
  }
  /*package*/ static Iterable<SNode> expressions_id1EZSCJhU$Wc(@NotNull SNode __thisNode__) {
    return ListSequence.fromList(SNodeOperations.getNodeDescendants(SLinkOperations.getTarget(__thisNode__, LINKS.text$OohJ), CONCEPTS.LogExpressionWord$CT, false, new SAbstractConcept[]{})).select((it) -> SLinkOperations.getTarget(it, LINKS.expr$tGvB));
  }

  /*package*/ LogStatement__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 2:
        return (T) ((String) messageString_id1EZSCJhUnyz(node, (SModel) parameters[0]));
      case 3:
        return (T) ((Iterable<SNode>) expressions_id1EZSCJhU$Wc(node));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((Boolean) suppressSpaceAfter_id6TPUpo_efNz(concept, (SNode) parameters[0]));
      case 1:
        return (T) ((Boolean) suppressSpaceBefore_id3PUmE2lLGid(concept, (SNode) parameters[0]));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }
  private static boolean isEmptyString(String str) {
    return str == null || str.isEmpty();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Word$5r = MetaAdapterFactory.getConcept(0x92d2ea165a424fdfL, 0xa676c7604efe3504L, 0x237c8da86a9f2e0cL, "de.slisson.mps.richtext.structure.Word");
    /*package*/ static final SConcept LogExpressionWord$CT = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x1abfe28bd1ba4d87L, "com.mbeddr.core.util.structure.LogExpressionWord");
    /*package*/ static final SInterfaceConcept IType$a9 = MetaAdapterFactory.getInterfaceConcept(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x11f8a0774f2L, "jetbrains.mps.lang.core.structure.IType");
    /*package*/ static final SConcept Type$dP = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba36L, "com.mbeddr.core.expressions.structure.Type");
    /*package*/ static final SInterfaceConcept IWord$8d = MetaAdapterFactory.getInterfaceConcept(0x92d2ea165a424fdfL, 0xa676c7604efe3504L, 0x237c8da86a9e7aecL, "de.slisson.mps.richtext.structure.IWord");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink expr$tGvB = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x1abfe28bd1ba4d87L, 0x1abfe28bd1ba4d88L, "expr");
    /*package*/ static final SContainmentLink text$OohJ = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x1abfe28bd1ac1ac6L, 0x1abfe28bd1ac1f9fL, "text");
    /*package*/ static final SContainmentLink words$C8QZ = MetaAdapterFactory.getContainmentLink(0x92d2ea165a424fdfL, 0xa676c7604efe3504L, 0x237c8da86a9e4e61L, 0x237c8da86a9e7aeeL, "words");
  }
}
