package com.mbeddr.core.util.intentions;

/*Generated by MPS */

import jetbrains.mps.intentions.AbstractIntentionDescriptor;
import jetbrains.mps.openapi.intentions.IntentionFactory;
import jetbrains.mps.openapi.intentions.Kind;
import jetbrains.mps.smodel.SNodePointer;
import java.util.Collection;
import jetbrains.mps.openapi.intentions.IntentionExecutable;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.EditorContext;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import com.mbeddr.core.base.behavior.IVisibleElementProvider__BehaviorDescriptor;
import jetbrains.mps.intentions.AbstractIntentionExecutable;
import jetbrains.mps.openapi.intentions.ParameterizedIntentionExecutable;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import com.mbeddr.core.base.behavior.NameExtractionHelper;
import com.mbeddr.core.expressions.typesystem.MeetTypeHelper;
import jetbrains.mps.typechecking.TypecheckingFacade;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.openapi.intentions.IntentionDescriptor;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;

public final class logThisExpressionAsNewItem_Intention extends AbstractIntentionDescriptor implements IntentionFactory {

  public logThisExpressionAsNewItem_Intention() {
    super(Kind.NORMAL, false, new SNodePointer("r:a97b0256-d67b-46d6-8dd5-fd70d5b31e78(com.mbeddr.core.util.intentions)", "4944376863018096808"));
  }

  @Override
  public String getPresentation() {
    return "logThisExpressionAsNewItem";
  }

  @Override
  public boolean isSurroundWith() {
    return false;
  }

  public Collection<IntentionExecutable> instances(final SNode node, final EditorContext context) {
    List<IntentionExecutable> list = ListSequence.fromList(new ArrayList<IntentionExecutable>());
    List<SNode> paramList = parameter(node, context);
    if (paramList != null) {
      for (SNode param : paramList) {
        ListSequence.fromList(list).addElement(new IntentionImplementation(param));
      }
    }
    return list;
  }
  private List<SNode> parameter(final SNode node, final EditorContext editorContext) {
    SNode prov = SNodeOperations.getNodeAncestor(node, CONCEPTS.IVisibleElementProvider$$O, false, false);
    if ((prov != null)) {
      return Sequence.fromIterable(SNodeOperations.ofConcept(IVisibleElementProvider__BehaviorDescriptor.visibleContentsOfType_id6clJcrJXo2_.invoke(prov, CONCEPTS.DataLoggerDeclaration$5X.getDeclarationNode()), CONCEPTS.DataLoggerDeclaration$5X)).toList();
    }
    return null;
  }
  /*package*/ final class IntentionImplementation extends AbstractIntentionExecutable implements ParameterizedIntentionExecutable {
    private SNode myParameter;
    public IntentionImplementation(SNode parameter) {
      myParameter = parameter;
    }

    @Override
    public String getDescription(final SNode node, final EditorContext editorContext) {
      return "LOGGER: " + ("Log expression with " + SPropertyOperations.getString(myParameter, PROPS.name$MnvL) + " as a new item");
    }

    @Override
    public void execute(final SNode node, final EditorContext editorContext) {
      SNode datalogger = myParameter;
      SNode newItem = createDataItem_viu7pv_a0b0a(NameExtractionHelper.extractExampleName(node), MeetTypeHelper.getConcreteNonConstVolatileType(SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(node), CONCEPTS.IType$a9)));
      ListSequence.fromList(SLinkOperations.getChildren(datalogger, LINKS.items$rLi7)).addElement(newItem);

      SNode s = createExpressionStatement_viu7pv_a0e0a(datalogger, newItem, SNodeOperations.copyNode(node));

      SNodeOperations.insertNextSiblingChild(SNodeOperations.getNodeAncestor(node, CONCEPTS.Statement$zV, false, false), s);

    }

    @Override
    public boolean isApplicable(final SNode node, final EditorContext editorContext) {
      if (!(isApplicableToNode(node, editorContext))) {
        return false;
      }
      return true;
    }

    private boolean isApplicableToNode(final SNode node, final EditorContext editorContext) {
      return (SNodeOperations.getNodeAncestor(node, CONCEPTS.Statement$zV, false, false) != null);
    }


    @Override
    public IntentionDescriptor getDescriptor() {
      return logThisExpressionAsNewItem_Intention.this;
    }

    public Object getParameter() {
      return myParameter;
    }
  }
  private static SNode createDataItem_viu7pv_a0b0a(String p0, SNode p1) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.DataItem$xH);
    n0.setProperty(PROPS.name$MnvL, p0);
    n0.forChild(LINKS.type$sXU3).initNode(p1, CONCEPTS.Type$dP, true);
    n0.setProperty(PROPS.size$vk_i, "" + (1));
    n0.setProperty(PROPS.active$F8DW, "" + (true));
    {
      SNodeBuilder n1 = n0.forChild(LINKS.initValue$4EyG).init(CONCEPTS.NumberLiteral$jK);
      n1.setProperty(PROPS.value$qZmE, "0");
    }
    return n0.getResult();
  }
  private static SNode createExpressionStatement_viu7pv_a0e0a(SNode p0, SNode p1, SNode p2) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.ExpressionStatement$SU);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.expr$vamr).init(CONCEPTS.GenericDotExpression$uQ);
      {
        SNodeBuilder n2 = n1.forChild(LINKS.expression$PfNq).init(CONCEPTS.DataLoggerRef$JQ);
        n2.setReferenceTarget(LINKS.datalogger$bfY7, p0);
      }
      {
        SNodeBuilder n3 = n1.forChild(LINKS.target$CEPF).init(CONCEPTS.GenericDLLogOp$yM);
        n3.setReferenceTarget(LINKS.item$3DF8, p1);
        n3.forChild(LINKS.value$3Ds7).initNode(p2, CONCEPTS.Expression$bT, true);
      }
    }
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SInterfaceConcept IVisibleElementProvider$$O = MetaAdapterFactory.getInterfaceConcept(0xd4280a54f6df4383L, 0xaa41d1b2bffa7eb1L, 0x6315bcc6eff580a3L, "com.mbeddr.core.base.structure.IVisibleElementProvider");
    /*package*/ static final SConcept DataLoggerDeclaration$5X = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x1567b4046d19f344L, "com.mbeddr.core.util.structure.DataLoggerDeclaration");
    /*package*/ static final SInterfaceConcept IType$a9 = MetaAdapterFactory.getInterfaceConcept(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x11f8a0774f2L, "jetbrains.mps.lang.core.structure.IType");
    /*package*/ static final SConcept Statement$zV = MetaAdapterFactory.getConcept(0xa9d696470840491eL, 0xbf392eb0805d2011L, 0x3a16e3a9c7ad6d03L, "com.mbeddr.core.statements.structure.Statement");
    /*package*/ static final SConcept DataItem$xH = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x449df48f7ad4e2fcL, "com.mbeddr.core.util.structure.DataItem");
    /*package*/ static final SConcept Type$dP = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba36L, "com.mbeddr.core.expressions.structure.Type");
    /*package*/ static final SConcept NumberLiteral$jK = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba67L, "com.mbeddr.core.expressions.structure.NumberLiteral");
    /*package*/ static final SConcept ExpressionStatement$SU = MetaAdapterFactory.getConcept(0xa9d696470840491eL, 0xbf392eb0805d2011L, 0x64ae61a4018a8592L, "com.mbeddr.core.statements.structure.ExpressionStatement");
    /*package*/ static final SConcept GenericDotExpression$uQ = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x401df715da462c0cL, "com.mbeddr.core.expressions.structure.GenericDotExpression");
    /*package*/ static final SConcept DataLoggerRef$JQ = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x449df48f7b1e6175L, "com.mbeddr.core.util.structure.DataLoggerRef");
    /*package*/ static final SConcept GenericDLLogOp$yM = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x59d32c6e7c9920f1L, "com.mbeddr.core.util.structure.GenericDLLogOp");
    /*package*/ static final SConcept Expression$bT = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba32L, "com.mbeddr.core.expressions.structure.Expression");
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
    /*package*/ static final SProperty size$vk_i = MetaAdapterFactory.getProperty(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x449df48f7ad4e2fcL, 0x449df48f7ad54941L, "size");
    /*package*/ static final SProperty active$F8DW = MetaAdapterFactory.getProperty(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x449df48f7ad4e2fcL, 0x1c84074b5cef4609L, "active");
    /*package*/ static final SProperty value$qZmE = MetaAdapterFactory.getProperty(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x1eb611a68febd3e5L, 0x1eb611a68fec38b0L, "value");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink items$rLi7 = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x1567b4046d19f344L, 0x449df48f7ad54a01L, "items");
    /*package*/ static final SContainmentLink type$sXU3 = MetaAdapterFactory.getContainmentLink(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x46a2a92ac61b183L, 0x46a2a92ac61b184L, "type");
    /*package*/ static final SContainmentLink initValue$4EyG = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x449df48f7ad4e2fcL, 0x2d59c2f8a407991dL, "initValue");
    /*package*/ static final SContainmentLink expr$vamr = MetaAdapterFactory.getContainmentLink(0xa9d696470840491eL, 0xbf392eb0805d2011L, 0x64ae61a4018a8592L, 0x64ae61a4018a8593L, "expr");
    /*package*/ static final SContainmentLink expression$PfNq = MetaAdapterFactory.getContainmentLink(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x29b5b7c4a3763232L, 0x64ae61a4018a9c50L, "expression");
    /*package*/ static final SReferenceLink datalogger$bfY7 = MetaAdapterFactory.getReferenceLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x449df48f7b1e6175L, 0x449df48f7b1e6176L, "datalogger");
    /*package*/ static final SContainmentLink target$CEPF = MetaAdapterFactory.getContainmentLink(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x401df715da462c0cL, 0x619e8ce80b7ff48bL, "target");
    /*package*/ static final SReferenceLink item$3DF8 = MetaAdapterFactory.getReferenceLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x59d32c6e7c9920f1L, 0x59d32c6e7c9920f3L, "item");
    /*package*/ static final SContainmentLink value$3Ds7 = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x59d32c6e7c9920f1L, 0x59d32c6e7c9920f2L, "value");
  }
}
