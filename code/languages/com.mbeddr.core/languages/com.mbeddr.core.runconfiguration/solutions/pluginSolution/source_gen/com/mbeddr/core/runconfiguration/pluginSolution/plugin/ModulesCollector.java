package com.mbeddr.core.runconfiguration.pluginSolution.plugin;

/*Generated by MPS */

import java.util.List;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.ArrayList;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;

public class ModulesCollector {
  public ModulesCollector() {
  }
  public static List<SNode> getMouldesFromBinary(SNode binary) {
    List<SNode> modules = new ArrayList<SNode>();
    ListSequence.fromList(modules).addSequence(ListSequence.fromList(resolveModuleReferences(binary)));
    if (SNodeOperations.isInstanceOf(binary, CONCEPTS.Executable$4V)) {
      for (SNode library : ListSequence.fromList(resolveLibraryReferences(SNodeOperations.cast(binary, CONCEPTS.Executable$4V)))) {
        ListSequence.fromList(modules).addSequence(ListSequence.fromList(resolveModuleReferences(library)));
      }
    }
    return modules;
  }
  public static List<SNode> resolveModuleReferences(SNode binary) {
    return ListSequence.fromList(SLinkOperations.getChildren(binary, LINKS.referencedModules$Su7l)).select((it) -> SLinkOperations.getTarget(it, LINKS.module$6_LN)).toList();
  }
  public static List<SNode> resolveLibraryReferences(SNode binary) {
    return ListSequence.fromList(SLinkOperations.getChildren(binary, LINKS.referencedLibs$IDrM)).select((it) -> SLinkOperations.getTarget(it, LINKS.lib$uEWN)).toList();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Executable$4V = MetaAdapterFactory.getConcept(0x2d7fadf533f64e80L, 0xa78f0f739add2bdeL, 0x46097107c8d98c12L, "com.mbeddr.core.buildconfig.structure.Executable");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink referencedModules$Su7l = MetaAdapterFactory.getContainmentLink(0x2d7fadf533f64e80L, 0xa78f0f739add2bdeL, 0x46097107c8d98c14L, 0x46097107c8d98c17L, "referencedModules");
    /*package*/ static final SReferenceLink module$6_LN = MetaAdapterFactory.getReferenceLink(0x2d7fadf533f64e80L, 0xa78f0f739add2bdeL, 0x6b1af9f9f43c2f4bL, 0x6b1af9f9f43c2f4cL, "module");
    /*package*/ static final SContainmentLink referencedLibs$IDrM = MetaAdapterFactory.getContainmentLink(0x2d7fadf533f64e80L, 0xa78f0f739add2bdeL, 0x46097107c8d98c12L, 0x25147963acda7554L, "referencedLibs");
    /*package*/ static final SReferenceLink lib$uEWN = MetaAdapterFactory.getReferenceLink(0x2d7fadf533f64e80L, 0xa78f0f739add2bdeL, 0x25147963acda747eL, 0x25147963acda747fL, "lib");
  }
}
