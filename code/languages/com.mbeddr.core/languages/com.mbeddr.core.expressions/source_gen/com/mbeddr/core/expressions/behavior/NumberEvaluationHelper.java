package com.mbeddr.core.expressions.behavior;

/*Generated by MPS */

import java.math.RoundingMode;
import java.math.BigInteger;
import java.math.BigDecimal;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import com.mbeddr.core.expressions.typesystem.NumLiteralTypeHelper;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class NumberEvaluationHelper extends EH {

  public static Number mul(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).multiply(EH.asInt(n2));
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).multiply(EH.asDec(n2));
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).multiply(EH.asDec(n2));
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).multiply(EH.asDec(n2));
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static Number div(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).divide(EH.asInt(n2));
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      try {
        return EH.asDec(n1).divide(EH.asDec(n2));
      } catch (ArithmeticException ex) {
        return EH.asDec(n1).divide(EH.asDec(n2), 100, RoundingMode.HALF_UP);
      }
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      try {
        return EH.asDec(n1).divide(EH.asDec(n2));
      } catch (ArithmeticException ex) {
        return EH.asDec(n1).divide(EH.asDec(n2), 100, RoundingMode.HALF_UP);
      }
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      try {
        return EH.asDec(n1).divide(EH.asDec(n2));
      } catch (ArithmeticException ex) {
        return EH.asDec(n1).divide(EH.asDec(n2), 100, RoundingMode.HALF_UP);
      }
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static Number plus(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).add(EH.asInt(n2));
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).add(EH.asDec(n2));
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).add(EH.asDec(n2));
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).add(EH.asDec(n2));
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static Number minus(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).subtract(EH.asInt(n2));
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).subtract(EH.asDec(n2));
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).subtract(EH.asDec(n2));
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).subtract(EH.asDec(n2));
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }
  public static Number abs(Number n) {
    if (EH.isNaturalNumber(n)) {
      return EH.asInt(n).abs();
    }
    if (EH.isFloatingPointNumber(n)) {
      return EH.asDec(n).abs();
    }
    if (EH.isNaturalNumber(n)) {
      return EH.asDec(n).abs();
    }
    if (EH.isNaturalNumber(n)) {
      return EH.asDec(n).abs();
    }
    throw NumberEvaluationHelper.createLongException(n);
  }


  public static BigInteger leftShift(BigInteger n1, int n2) {
    return n1.shiftLeft(n2);
  }

  public static BigInteger rightShift(BigInteger n1, int n2) {
    return n1.shiftRight(n2);
  }

  public static BigInteger bitAnd(BigInteger n1, BigInteger n2) {
    return n1.and(n2);
  }

  public static BigInteger bitExOr(BigInteger n1, BigInteger n2) {
    return n1.xor(n2);
  }

  public static BigInteger bitOr(BigInteger n1, BigInteger n2) {
    return n1.or(n2);
  }

  public static boolean less(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).compareTo(EH.asInt(n2)) < 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) < 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) < 0;
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) < 0;
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static boolean greater(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).compareTo(EH.asInt(n2)) > 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) > 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) > 0;
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) > 0;
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static boolean lessEqual(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).compareTo(EH.asInt(n2)) <= 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) <= 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) <= 0;
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) <= 0;
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static boolean greaterEqual(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).compareTo(EH.asInt(n2)) >= 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) >= 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) >= 0;
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) >= 0;
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static boolean equal(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).compareTo(EH.asInt(n2)) == 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) == 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) == 0;
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) == 0;
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static boolean notEqual(Number n1, Number n2) {
    if (EH.isNaturalNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asInt(n1).compareTo(EH.asInt(n2)) != 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) != 0;
    }
    if (EH.isFloatingPointNumber(n1) && EH.isNaturalNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) != 0;
    }
    if (EH.isNaturalNumber(n1) && EH.isFloatingPointNumber(n2)) {
      return EH.asDec(n1).compareTo(EH.asDec(n2)) != 0;
    }
    throw NumberEvaluationHelper.createIntDecException(n1, n2);
  }

  public static BigInteger bitNot(BigInteger n) {
    return n.not();
  }

  public static BigDecimal unaryPlus(BigDecimal n) {
    return n.plus();
  }

  public static Number unaryMinus(Number n) {
    if (EH.isNaturalNumber(n)) {
      return EH.asInt(n).negate();
    }
    if (EH.isFloatingPointNumber(n)) {
      return EH.asDec(n).negate();
    }
    throw NumberEvaluationHelper.createLongDoubleException(n);

  }

  public static BigInteger modulo(BigInteger n1, BigInteger n2) {
    return n1.mod(n2);
  }

  public static SNode toNode(Object num) {
    if (EH.isNumber(num)) {
      SNode nl = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba67L, "com.mbeddr.core.expressions.structure.NumberLiteral"));
      SPropertyOperations.assign(nl, PROPS.value$qZmE, num.toString());
      return nl;
    }
    throw new IllegalArgumentException("Not a number: " + num.getClass().getName());
  }

  public static SNode staticType(SNode leftType, SNode rightType, SNode e) {
    if ((boolean) Expression__BehaviorDescriptor.isStaticallyEvaluatable_id3ilck8Kr3zN.invoke(e)) {
      Object staticValue = Expression__BehaviorDescriptor.evaluateStatically_id6OxpEKG0KPv.invoke(e);
      if (staticValue == null) {
        throw new IllegalArgumentException("static evaluation for " + SNodeOperations.getConcept(e) + " returned null but was statically evaluatable");
      }

      SNode type = SNodeOperations.cast(NumLiteralTypeHelper.type(staticValue, e), CONCEPTS.IType$a9);
      if (SNodeOperations.isInstanceOf(e, CONCEPTS.BinaryExpression$cR) && SNodeOperations.isInstanceOf(type, CONCEPTS.MeetType$ZG) && SNodeOperations.isInstanceOf(leftType, CONCEPTS.IUnsigned$5A) && SNodeOperations.isInstanceOf(rightType, CONCEPTS.IUnsigned$5A)) {
        return ListSequence.fromList(SLinkOperations.getChildren(SNodeOperations.cast(type, CONCEPTS.MeetType$ZG), LINKS.argument$r2cT)).findFirst((it) -> SNodeOperations.isInstanceOf(it, CONCEPTS.IUnsigned$5A));
      }
      return type;
    }
    throw new IllegalArgumentException("Not statically evaluatable");
  }

  private static IllegalArgumentException createLongException(Number n) {
    return new IllegalArgumentException("only long allowed but was: " + n + " (" + n.getClass().getName() + ")");
  }

  private static IllegalArgumentException createLongDoubleException(Number n) {
    return new IllegalArgumentException("only long or double allowed but was: " + n + " (" + n.getClass().getName() + ")");
  }

  private static IllegalArgumentException createLongException(Number n1, Number n2) {
    return new IllegalArgumentException("only long allowed but was: " + n1 + " (" + n1.getClass().getName() + ") and " + n2 + " (" + n2.getClass().getName() + ")");
  }

  private static IllegalArgumentException createIntDecException(Number n1, Number n2) {
    return new IllegalArgumentException("only big int or big decimal allowed but was: " + n1 + " (" + n1.getClass().getName() + ") and " + n2 + " (" + n2.getClass().getName() + ")");
  }

  private static final class PROPS {
    /*package*/ static final SProperty value$qZmE = MetaAdapterFactory.getProperty(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x1eb611a68febd3e5L, 0x1eb611a68fec38b0L, "value");
  }

  private static final class CONCEPTS {
    /*package*/ static final SInterfaceConcept IType$a9 = MetaAdapterFactory.getInterfaceConcept(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x11f8a0774f2L, "jetbrains.mps.lang.core.structure.IType");
    /*package*/ static final SConcept MeetType$ZG = MetaAdapterFactory.getConcept(0x7a5dda6291404668L, 0xab76d5ed1746f2b2L, 0x114b68ad132L, "jetbrains.mps.lang.typesystem.structure.MeetType");
    /*package*/ static final SInterfaceConcept IUnsigned$5A = MetaAdapterFactory.getInterfaceConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x61f402d2a8753377L, "com.mbeddr.core.expressions.structure.IUnsigned");
    /*package*/ static final SConcept BinaryExpression$cR = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba34L, "com.mbeddr.core.expressions.structure.BinaryExpression");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink argument$r2cT = MetaAdapterFactory.getContainmentLink(0x7a5dda6291404668L, 0xab76d5ed1746f2b2L, 0x114b68ad132L, 0x114b68b040bL, "argument");
  }
}
