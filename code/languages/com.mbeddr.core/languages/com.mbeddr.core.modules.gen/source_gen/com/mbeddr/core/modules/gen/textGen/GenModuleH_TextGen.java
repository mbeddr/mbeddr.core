package com.mbeddr.core.modules.gen.textGen;

/*Generated by MPS */

import jetbrains.mps.text.rt.TextGenDescriptorBase;
import jetbrains.mps.text.rt.TextGenContext;
import jetbrains.mps.text.impl.TextGenSupport;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import com.mbeddr.core.modules.gen.behavior.AbstractGenModule__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import com.mbeddr.core.modules.gen.behavior.UniquifyIncludeGuard__BehaviorDescriptor;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class GenModuleH_TextGen extends TextGenDescriptorBase {
  @Override
  public void generateText(final TextGenContext ctx) {
    final TextGenSupport tgs = new TextGenSupport(ctx);
    if (isNotEmptyString(SPropertyOperations.getString(ctx.getPrimaryInput(), PROPS.copyrightNoticePath$y0oA))) {
      tgs.append(AbstractGenModule__BehaviorDescriptor.readCopyrightNotice_id6TPUpoFAGOQ.invoke(ctx.getPrimaryInput()));
      tgs.newLine();
    }

    if ((new IAttributeDescriptor.NodeAttribute(CONCEPTS.UniquifyIncludeGuard$Kz).get(ctx.getPrimaryInput()) != null)) {
      tgs.append("#ifndef ");
      tgs.append(UniquifyIncludeGuard__BehaviorDescriptor.uniquifyIncludeGuard_id1lYd87JBZv6.invoke(new IAttributeDescriptor.NodeAttribute(CONCEPTS.UniquifyIncludeGuard$Kz).get(ctx.getPrimaryInput()), AbstractGenModule__BehaviorDescriptor.genName_id7Aba6Bzz6b$.invoke(ctx.getPrimaryInput())));
      tgs.newLine();
      tgs.append("#define ");
      tgs.append(UniquifyIncludeGuard__BehaviorDescriptor.uniquifyIncludeGuard_id1lYd87JBZv6.invoke(new IAttributeDescriptor.NodeAttribute(CONCEPTS.UniquifyIncludeGuard$Kz).get(ctx.getPrimaryInput()), AbstractGenModule__BehaviorDescriptor.genName_id7Aba6Bzz6b$.invoke(ctx.getPrimaryInput())));
      tgs.newLine();
    } else {
      tgs.append("#ifndef ");
      tgs.append(AbstractGenModule__BehaviorDescriptor.genName_id7Aba6Bzz6b$.invoke(ctx.getPrimaryInput()).toUpperCase() + "_" + SPropertyOperations.getString(ctx.getPrimaryInput(), PROPS.fileExtension$IoTz).toUpperCase());
      tgs.newLine();
      tgs.append("#define ");
      tgs.append(AbstractGenModule__BehaviorDescriptor.genName_id7Aba6Bzz6b$.invoke(ctx.getPrimaryInput()).toUpperCase() + "_" + SPropertyOperations.getString(ctx.getPrimaryInput(), PROPS.fileExtension$IoTz).toUpperCase());
      tgs.newLine();
    }
    tgs.newLine();

    for (SNode f : ListSequence.fromList(SLinkOperations.getChildren(ctx.getPrimaryInput(), LINKS.headerImports$M5SR))) {
      tgs.appendNode(f);
    }
    if (ListSequence.fromList(SLinkOperations.getChildren(ctx.getPrimaryInput(), LINKS.headerImports$M5SR)).isNotEmpty()) {
      tgs.newLine();
    }

    if ((new IAttributeDescriptor.NodeAttribute(CONCEPTS.SuppressExternCBlock$F6).get(ctx.getPrimaryInput()) == null)) {
      tgs.append("#ifdef __cplusplus");
      tgs.newLine();
      tgs.append("extern \"C\" {");
      tgs.newLine();
      tgs.append("#endif");
      tgs.newLine();
      tgs.newLine();
    }

    for (SNode content : ListSequence.fromList(SLinkOperations.getChildren(ctx.getPrimaryInput(), LINKS.contents$F2O3)).where((it) -> !(SNodeOperations.isInstanceOf(it, CONCEPTS.EmptyModuleContent$uN)))) {
      tgs.appendNode(content);
      if (SNodeOperations.getIndexInParent(content) < ListSequence.fromList(SLinkOperations.getChildren(ctx.getPrimaryInput(), LINKS.contents$F2O3)).count() - 1) {
        tgs.newLine();
      }
    }

    if ((new IAttributeDescriptor.NodeAttribute(CONCEPTS.SuppressExternCBlock$F6).get(ctx.getPrimaryInput()) == null)) {
      tgs.newLine();
      tgs.append("#ifdef __cplusplus");
      tgs.newLine();
      tgs.append("} /* extern \"C\" */");
      tgs.newLine();
      tgs.append("#endif");
      tgs.newLine();
      tgs.newLine();
    }

    tgs.append("#endif");
    tgs.newLine();
  }
  private static boolean isNotEmptyString(String str) {
    return str != null && str.length() > 0;
  }

  private static final class PROPS {
    /*package*/ static final SProperty copyrightNoticePath$y0oA = MetaAdapterFactory.getProperty(0x62296a07bc3846d2L, 0x8034198c24063588L, 0x6492560dd5e536beL, 0x6e75e9962b82b6eeL, "copyrightNoticePath");
    /*package*/ static final SProperty fileExtension$IoTz = MetaAdapterFactory.getProperty(0x62296a07bc3846d2L, 0x8034198c24063588L, 0x6492560dd5e536beL, 0x6492560dd5e536bfL, "fileExtension");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept UniquifyIncludeGuard$Kz = MetaAdapterFactory.getConcept(0x62296a07bc3846d2L, 0x8034198c24063588L, 0x157e3481ef9ff7beL, "com.mbeddr.core.modules.gen.structure.UniquifyIncludeGuard");
    /*package*/ static final SConcept SuppressExternCBlock$F6 = MetaAdapterFactory.getConcept(0x62296a07bc3846d2L, 0x8034198c24063588L, 0x4e8b5d19eb57b197L, "com.mbeddr.core.modules.gen.structure.SuppressExternCBlock");
    /*package*/ static final SConcept EmptyModuleContent$uN = MetaAdapterFactory.getConcept(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x7bfc48eac80b1723L, "com.mbeddr.core.modules.structure.EmptyModuleContent");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink headerImports$M5SR = MetaAdapterFactory.getContainmentLink(0x62296a07bc3846d2L, 0x8034198c24063588L, 0x1865bdb749ca065eL, 0x4d4a3140e3d18b26L, "headerImports");
    /*package*/ static final SContainmentLink contents$F2O3 = MetaAdapterFactory.getContainmentLink(0x62296a07bc3846d2L, 0x8034198c24063588L, 0x1865bdb749ca065eL, 0x1865bdb749ca065fL, "contents");
  }
}
