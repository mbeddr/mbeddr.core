package com.mbeddr.core.modules.typesystem;

/*Generated by MPS */

import jetbrains.mps.errors.QuickFix_Runtime;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.typechecking.TypecheckingFacade;
import com.mbeddr.core.expressions.behavior.PrimitiveType__BehaviorDescriptor;
import com.mbeddr.core.modules.enumMigration.ArgumentKind_MigrationUtils;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SConcept;

public class syncFunctionTypeSignature_QuickFix extends QuickFix_Runtime {
  public syncFunctionTypeSignature_QuickFix() {
    super(new SNodePointer("r:7b158038-abbe-4e11-b171-d5a959b4e91a(com.mbeddr.core.modules.typesystem)", "7338356769017216648"));
  }
  public void execute(SNode node) {
    SPropertyOperations.assign(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), PROPS.exported$V4am, false);
    SPropertyOperations.assign(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), PROPS.extern$WI8W, false);
    SPropertyOperations.assign(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), PROPS.preventNameMangling$DOH5, true);

    for (SNode argumentType : ListSequence.fromList(SLinkOperations.getChildren(SNodeOperations.cast(SLinkOperations.getTarget(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("typeDef")[0]), LINKS.original$$TxO), CONCEPTS.FunctionRefType$7x), LINKS.argTypes$R93A))) {
      SNode concreteArgument = null;

      if (SNodeOperations.getIndexInParent(argumentType) < ListSequence.fromList(SLinkOperations.getChildren(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), LINKS.arguments$6da0)).count()) {
        concreteArgument = ListSequence.fromList(SLinkOperations.getChildren(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), LINKS.arguments$6da0)).getElement(SNodeOperations.getIndexInParent(argumentType));
      }

      if (concreteArgument == null) {
        concreteArgument = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x6d872ef9245a20d7L, "com.mbeddr.core.modules.structure.Argument"));
        ListSequence.fromList(SLinkOperations.getChildren(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), LINKS.arguments$6da0)).addElement(concreteArgument);
      }

      if (isEmptyString(SPropertyOperations.getString(concreteArgument, PROPS.name$MnvL))) {
        SPropertyOperations.assign(concreteArgument, PROPS.name$MnvL, "arg_" + SNodeOperations.getIndexInParent(argumentType));
      }

      if (SNodeOperations.isInstanceOf(TypecheckingFacade.getFromContext().getTypeOf(argumentType), CONCEPTS.PrimitiveBasicIntegralType$$2)) {
        SLinkOperations.setTarget(concreteArgument, LINKS.type$sXU3, SNodeOperations.copyNode(PrimitiveType__BehaviorDescriptor.getCorrespondingC99Type_id1rZqEK2gLnh.invoke(SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(argumentType), CONCEPTS.PrimitiveBasicIntegralType$$2))));
      } else {
        SNode type = SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(argumentType), CONCEPTS.Type$dP);
        ListSequence.fromList(SLinkOperations.getChildren(type, LINKS.smodelAttribute$KJ43)).removeWhere((it) -> SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(SNodeOperations.getConcept(it)), CONCEPTS.ArgumentKindAnnotation$FQ));
        SLinkOperations.setTarget(concreteArgument, LINKS.type$sXU3, type);
      }

      if (ArgumentKind_MigrationUtils.value(SPropertyOperations.getEnum(new IAttributeDescriptor.NodeAttribute(CONCEPTS.ArgumentKindAnnotation$FQ).get(argumentType), PROPS.value$_XOt)) == null) {
        SNodeOperations.deleteNode(SLinkOperations.getTarget(concreteArgument, LINKS.kind$ebZT));
      } else {
        if (SLinkOperations.getTarget(concreteArgument, LINKS.kind$ebZT) == null) {
          SLinkOperations.setTarget(concreteArgument, LINKS.kind$ebZT, SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0xc42f172f6d01a6eL, "com.mbeddr.core.modules.structure.ArgumentKindContainer")));
        }
        SPropertyOperations.assignEnum(SLinkOperations.getTarget(concreteArgument, LINKS.kind$ebZT), PROPS.value$1$x_, SPropertyOperations.getEnum(new IAttributeDescriptor.NodeAttribute(CONCEPTS.ArgumentKindAnnotation$FQ).get(argumentType), PROPS.value$_XOt));
      }
    }

    ListSequence.fromList(SLinkOperations.getChildren(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), LINKS.arguments$6da0)).where((it) -> SNodeOperations.getIndexInParent(it) >= ListSequence.fromList(SLinkOperations.getChildren(SNodeOperations.cast(SLinkOperations.getTarget(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("typeDef")[0]), LINKS.original$$TxO), CONCEPTS.FunctionRefType$7x), LINKS.argTypes$R93A)).count()).visitAll((it) -> SNodeOperations.deleteNode(it));

    SPropertyOperations.assign(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), PROPS.name$MnvL, SPropertyOperations.getString(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("typeDef")[0]), PROPS.name$MnvL));
    SPropertyOperations.assign(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), PROPS.preventNameMangling$DOH5, false);
    if (SNodeOperations.isInstanceOf(TypecheckingFacade.getFromContext().getTypeOf(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("typeDef")[0])), CONCEPTS.PrimitiveBasicIntegralType$$2)) {
      SLinkOperations.setTarget(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), LINKS.type$sXU3, SNodeOperations.copyNode(PrimitiveType__BehaviorDescriptor.getCorrespondingC99Type_id1rZqEK2gLnh.invoke(SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("typeDef")[0])), CONCEPTS.PrimitiveBasicIntegralType$$2))));
    } else {
      SLinkOperations.setTarget(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("function")[0]), LINKS.type$sXU3, SNodeOperations.cast(TypecheckingFacade.getFromContext().getTypeOf(SLinkOperations.getTarget(SNodeOperations.cast(SLinkOperations.getTarget(((SNode) syncFunctionTypeSignature_QuickFix.this.getField("typeDef")[0]), LINKS.original$$TxO), CONCEPTS.FunctionRefType$7x), LINKS.returnType$R8O_)), CONCEPTS.Type$dP));
    }
  }
  private static boolean isEmptyString(String str) {
    return str == null || str.isEmpty();
  }

  private static final class PROPS {
    /*package*/ static final SProperty exported$V4am = MetaAdapterFactory.getProperty(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x595522006a5b934fL, 0x124a1a47a69807f0L, "exported");
    /*package*/ static final SProperty extern$WI8W = MetaAdapterFactory.getProperty(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x5d18402e8bd5672eL, 0x5d18402e8bd56731L, "extern");
    /*package*/ static final SProperty preventNameMangling$DOH5 = MetaAdapterFactory.getProperty(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x595522006a5b934fL, 0x5d18402e8bd65342L, "preventNameMangling");
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
    /*package*/ static final SProperty value$_XOt = MetaAdapterFactory.getProperty(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x202159c126244789L, 0x202159c126246abeL, "value");
    /*package*/ static final SProperty value$1$x_ = MetaAdapterFactory.getProperty(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0xc42f172f6d01a6eL, 0xc42f172f6d01b82L, "value");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink arguments$6da0 = MetaAdapterFactory.getContainmentLink(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x707ac195dd5d51f2L, 0x4f39f90935e92f45L, "arguments");
    /*package*/ static final SContainmentLink type$sXU3 = MetaAdapterFactory.getContainmentLink(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x46a2a92ac61b183L, 0x46a2a92ac61b184L, "type");
    /*package*/ static final SContainmentLink smodelAttribute$KJ43 = MetaAdapterFactory.getContainmentLink(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x10802efe25aL, 0x47bf8397520e5942L, "smodelAttribute");
    /*package*/ static final SContainmentLink kind$ebZT = MetaAdapterFactory.getContainmentLink(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x75302b1261129ff9L, 0xc42f172f6d02776L, "kind");
    /*package*/ static final SContainmentLink original$$TxO = MetaAdapterFactory.getContainmentLink(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x6b0ac27ac5014717L, 0x54e261614fd09a16L, "original");
    /*package*/ static final SContainmentLink argTypes$R93A = MetaAdapterFactory.getContainmentLink(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x76ad8d576f00349bL, 0x76ad8d576f00349dL, "argTypes");
    /*package*/ static final SContainmentLink returnType$R8O_ = MetaAdapterFactory.getContainmentLink(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x76ad8d576f00349bL, 0x76ad8d576f00349cL, "returnType");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept PrimitiveBasicIntegralType$$2 = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x4d4a3140e3e01fdaL, "com.mbeddr.core.expressions.structure.PrimitiveBasicIntegralType");
    /*package*/ static final SConcept Type$dP = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba36L, "com.mbeddr.core.expressions.structure.Type");
    /*package*/ static final SConcept ArgumentKindAnnotation$FQ = MetaAdapterFactory.getConcept(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x202159c126244789L, "com.mbeddr.core.modules.structure.ArgumentKindAnnotation");
    /*package*/ static final SConcept FunctionRefType$7x = MetaAdapterFactory.getConcept(0x6d11763d483d4b2bL, 0x8efc09336c1b0001L, 0x76ad8d576f00349bL, "com.mbeddr.core.modules.structure.FunctionRefType");
  }
}
