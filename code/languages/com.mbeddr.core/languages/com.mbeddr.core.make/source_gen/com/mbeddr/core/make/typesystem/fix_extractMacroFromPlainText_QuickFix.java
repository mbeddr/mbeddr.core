package com.mbeddr.core.make.typesystem;

/*Generated by MPS */

import jetbrains.mps.errors.QuickFix_Runtime;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import com.mbeddr.core.make.behavior.IMakefileItem__BehaviorDescriptor;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SProperty;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;

public class fix_extractMacroFromPlainText_QuickFix extends QuickFix_Runtime {
  public fix_extractMacroFromPlainText_QuickFix() {
    super(new SNodePointer("r:b8819a61-c3aa-4469-b5b3-43fb13a35cb6(com.mbeddr.core.make.typesystem)", "5591170374840097826"));
  }
  public String getDescription(SNode node) {
    return "Extract " + SConceptOperations.conceptAlias(((SConcept) fix_extractMacroFromPlainText_QuickFix.this.getField("macroConcept")[0])) + " from Plain Text Fragment";
  }
  public void execute(SNode node) {
    SNode macro = SConceptOperations.createNewNode(SNodeOperations.asInstanceConcept(((SConcept) fix_extractMacroFromPlainText_QuickFix.this.getField("macroConcept")[0])));

    String prefix = null;
    String postfix = null;
    int macroIdx = SPropertyOperations.getString(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), PROPS.text$Iv7e).indexOf(SConceptOperations.conceptAlias(((SConcept) fix_extractMacroFromPlainText_QuickFix.this.getField("macroConcept")[0])));
    if (macroIdx < 0) {
      return;
    }
    if (macroIdx > 0) {
      SPropertyOperations.assign(macro, PROPS.escaped$Vhnz, SPropertyOperations.getString(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), PROPS.text$Iv7e).substring(0, macroIdx).endsWith(IMakefileItem__BehaviorDescriptor.getEscapePrefix_id7EZ1Spo3k6R.invoke(macro)));
      prefix = (SPropertyOperations.getBoolean(macro, PROPS.escaped$Vhnz) ? SPropertyOperations.getString(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), PROPS.text$Iv7e).substring(0, macroIdx - IMakefileItem__BehaviorDescriptor.getEscapePrefix_id7EZ1Spo3k6R.invoke(macro).length()) : SPropertyOperations.getString(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), PROPS.text$Iv7e).substring(0, macroIdx));
    }
    if (macroIdx + SConceptOperations.conceptAlias(((SConcept) fix_extractMacroFromPlainText_QuickFix.this.getField("macroConcept")[0])).length() < SPropertyOperations.getString(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), PROPS.text$Iv7e).length()) {
      postfix = SPropertyOperations.getString(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), PROPS.text$Iv7e).substring(macroIdx + SConceptOperations.conceptAlias(((SConcept) fix_extractMacroFromPlainText_QuickFix.this.getField("macroConcept")[0])).length());

    }

    if (prefix == null && postfix == null) {
      SNodeOperations.replaceWithAnother(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), macro);
    } else {
      if (prefix != null) {
        SNodeOperations.insertPrevSiblingChild(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), createPlainTextFragment_826vnr_a0a0a0a0j0c(prefix));
      }
      SNodeOperations.insertPrevSiblingChild(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), macro);
      if (postfix != null) {
        SNodeOperations.insertPrevSiblingChild(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), createPlainTextFragment_826vnr_a0a0a2a0j0c(postfix));
      }
      SNodeOperations.deleteNode(((SNode) fix_extractMacroFromPlainText_QuickFix.this.getField("plainTextFragment")[0]));
    }
  }
  private static SNode createPlainTextFragment_826vnr_a0a0a0a0j0c(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.PlainTextFragment$55);
    n0.setProperty(PROPS.text$Iv7e, p0);
    return n0.getResult();
  }
  private static SNode createPlainTextFragment_826vnr_a0a0a2a0j0c(String p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.PlainTextFragment$55);
    n0.setProperty(PROPS.text$Iv7e, p0);
    return n0.getResult();
  }

  private static final class PROPS {
    /*package*/ static final SProperty text$Iv7e = MetaAdapterFactory.getProperty(0xf93d1dbebfd142ddL, 0x932af375fa6f5373L, 0x2ed28d95c2ca1923L, 0x2ed28d95c2ca1924L, "text");
    /*package*/ static final SProperty escaped$Vhnz = MetaAdapterFactory.getProperty(0xf93d1dbebfd142ddL, 0x932af375fa6f5373L, 0x4d97d3d526ace831L, 0xa9bb2127b8b4dd5L, "escaped");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept PlainTextFragment$55 = MetaAdapterFactory.getConcept(0xf93d1dbebfd142ddL, 0x932af375fa6f5373L, 0x2ed28d95c2ca1923L, "com.mbeddr.core.make.structure.PlainTextFragment");
  }
}
