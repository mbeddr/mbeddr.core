package com.mbeddr.core.make.typesystem;

/*Generated by MPS */

import jetbrains.mps.errors.QuickFix_Runtime;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.core.behavior.BaseConcept__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import java.util.Objects;
import jetbrains.mps.lang.core.behavior.PropertyAttribute__BehaviorDescriptor;
import jetbrains.mps.lang.core.behavior.LinkAttribute__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public class fix_extractRuleRefFromPlainText_QuickFix extends QuickFix_Runtime {
  public fix_extractRuleRefFromPlainText_QuickFix() {
    super(new SNodePointer("r:b8819a61-c3aa-4469-b5b3-43fb13a35cb6(com.mbeddr.core.make.typesystem)", "8844796466748287857"));
  }
  public String getDescription(SNode node) {
    return "Extract " + BaseConcept__BehaviorDescriptor.getPresentation_idhEwIMiw.invoke(((SNode) fix_extractRuleRefFromPlainText_QuickFix.this.getField("referencedRule")[0])) + " from Plain Text Fragment";
  }
  public void execute(SNode node) {
    SNode ruleRef = createRuleRef_78yefx_a0a0c(((SNode) fix_extractRuleRefFromPlainText_QuickFix.this.getField("referencedRule")[0]));

    SNode plainTextFragmentTextPropertyMacro = Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(((SNode) fix_extractRuleRefFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), LINKS.smodelAttribute$KJ43), CONCEPTS.PropertyMacro$c9)).findFirst((it) -> Objects.equals(PropertyAttribute__BehaviorDescriptor.getProperty_id1avfQ4BBzOo.invoke(it), PROPS.text$Iv7e));
    if ((plainTextFragmentTextPropertyMacro != null)) {
      SNode ruleReferenceMacro = createReferenceMacro_78yefx_a0a0d0c(SNodeOperations.copyNode(SLinkOperations.getTarget(SLinkOperations.getTarget(plainTextFragmentTextPropertyMacro, LINKS.propertyValueFunction$7Sh_), LINKS.body$e68K)));
      LinkAttribute__BehaviorDescriptor.setLink_id6Gg5KlvuxxF.invoke(ruleReferenceMacro, LINKS.rule$O3Le);
      ListSequence.fromList(SLinkOperations.getChildren(ruleRef, LINKS.smodelAttribute$KJ43)).addElement(ruleReferenceMacro);
    }

    SNode plainTextFragmentNodeMacro = Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(((SNode) fix_extractRuleRefFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), LINKS.smodelAttribute$KJ43), CONCEPTS.NodeMacro$qU)).first();
    if ((plainTextFragmentNodeMacro != null)) {
      SNode ruleRefNodeMacro = SNodeOperations.copyNode(plainTextFragmentNodeMacro);
      ListSequence.fromList(SLinkOperations.getChildren(ruleRef, LINKS.smodelAttribute$KJ43)).addElement(ruleRefNodeMacro);
    }

    SNodeOperations.replaceWithAnother(((SNode) fix_extractRuleRefFromPlainText_QuickFix.this.getField("plainTextFragment")[0]), ruleRef);
  }
  private static SNode createRuleRef_78yefx_a0a0c(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.RuleRef$ep);
    n0.setReferenceTarget(LINKS.rule$O3Le, p0);
    return n0.getResult();
  }
  private static SNode createReferenceMacro_78yefx_a0a0d0c(SNode p0) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.ReferenceMacro$30);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.referentFunction$6c9k).init(CONCEPTS.ReferenceMacro_GetReferent$ww);
      n1.forChild(LINKS.body$e68K).initNode(p0, CONCEPTS.StatementList$m_, true);
    }
    return n0.getResult();
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink smodelAttribute$KJ43 = MetaAdapterFactory.getContainmentLink(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x10802efe25aL, 0x47bf8397520e5942L, "smodelAttribute");
    /*package*/ static final SContainmentLink propertyValueFunction$7Sh_ = MetaAdapterFactory.getContainmentLink(0xb401a68083254110L, 0x8fd384331ff25befL, 0xfd47e9f6f0L, 0x10fe3b4023fL, "propertyValueFunction");
    /*package*/ static final SContainmentLink body$e68K = MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x108bbca0f48L, 0x108bbd29b4aL, "body");
    /*package*/ static final SReferenceLink rule$O3Le = MetaAdapterFactory.getReferenceLink(0xf93d1dbebfd142ddL, 0x932af375fa6f5373L, 0x7abf07865612f2b5L, 0x7abf07865612f2b6L, "rule");
    /*package*/ static final SContainmentLink referentFunction$6c9k = MetaAdapterFactory.getContainmentLink(0xb401a68083254110L, 0x8fd384331ff25befL, 0xfd7f44d616L, 0x10fe489d9feL, "referentFunction");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept PropertyMacro$c9 = MetaAdapterFactory.getConcept(0xb401a68083254110L, 0x8fd384331ff25befL, 0xfd47e9f6f0L, "jetbrains.mps.lang.generator.structure.PropertyMacro");
    /*package*/ static final SConcept NodeMacro$qU = MetaAdapterFactory.getConcept(0xb401a68083254110L, 0x8fd384331ff25befL, 0xfd47ed6742L, "jetbrains.mps.lang.generator.structure.NodeMacro");
    /*package*/ static final SConcept RuleRef$ep = MetaAdapterFactory.getConcept(0xf93d1dbebfd142ddL, 0x932af375fa6f5373L, 0x7abf07865612f2b5L, "com.mbeddr.core.make.structure.RuleRef");
    /*package*/ static final SConcept ReferenceMacro$30 = MetaAdapterFactory.getConcept(0xb401a68083254110L, 0x8fd384331ff25befL, 0xfd7f44d616L, "jetbrains.mps.lang.generator.structure.ReferenceMacro");
    /*package*/ static final SConcept ReferenceMacro_GetReferent$ww = MetaAdapterFactory.getConcept(0xb401a68083254110L, 0x8fd384331ff25befL, 0x10fe485cc9bL, "jetbrains.mps.lang.generator.structure.ReferenceMacro_GetReferent");
    /*package*/ static final SConcept StatementList$m_ = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0xf8cc56b200L, "jetbrains.mps.baseLanguage.structure.StatementList");
  }

  private static final class PROPS {
    /*package*/ static final SProperty text$Iv7e = MetaAdapterFactory.getProperty(0xf93d1dbebfd142ddL, 0x932af375fa6f5373L, 0x2ed28d95c2ca1923L, 0x2ed28d95c2ca1924L, "text");
  }
}
