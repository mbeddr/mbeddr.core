package com.mbeddr.core.util.interpreter.plugin;

/*Generated by MPS */

import com.mbeddr.mpsutil.interpreter.rt.ConditionalInterpreterBase;
import java.util.List;
import com.mbeddr.mpsutil.interpreter.rt.IEvaluator;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import com.mbeddr.mpsutil.interpreter.rt.IConditionalEvaluator;
import com.mbeddr.mpsutil.interpreter.rt.ConditionalConceptEvaluatorBase;
import org.jetbrains.mps.openapi.model.SNode;
import com.mbeddr.mpsutil.interpreter.rt.IContext;
import com.mbeddr.mpsutil.interpreter.rt.ICoverageAnalyzer;
import com.mbeddr.mpsutil.interpreter.rt.ComputationTrace;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import com.mbeddr.mpsutil.interpreter.rt.InterpreterEscapeException;
import com.mbeddr.mpsutil.interpreter.rt.InterpreterRuntimeException;
import jetbrains.mps.internal.collections.runtime.Sequence;
import com.mbeddr.mpsutil.interpreter.rt.IConditionalInterpreter;
import com.mbeddr.mpsutil.interpreter.rt.EvaluatorInfo;
import com.mbeddr.mpsutil.interpreter.rt.ITypeMapper;
import com.mbeddr.mpsutil.interpreter.rt.IRelationship;
import com.mbeddr.mpsutil.interpreter.rt.InterpretAfterRelationshipImpl;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;

public class InterpreterCExtInterpreter extends ConditionalInterpreterBase {
  public InterpreterCExtInterpreter() {
    init();
  }

  @Override
  public String getCategory() {
    return "CInterpreter";
  }

  protected void populateEvaluators(List<? extends IEvaluator> evaluators) {
    ListSequence.fromList(((List<IConditionalEvaluator>) evaluators)).addElement(new ConditionalConceptEvaluatorBase(CONCEPTS.DecTab$yC, "r:7b666de7-002f-4492-b5bd-942c41bb2387(com.mbeddr.core.util.interpreter.plugin)/4535693827938077180", true) {
      public Object evaluateEvaluator(SNode node, final IContext context, final ICoverageAnalyzer coverage, final ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          if (this.concept != SNodeOperations.getConcept(node)) {
            coverage.visitedConcept(SNodeOperations.getConcept(node));
          }
          SNode x = ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.xExpr$c$rM)).findFirst((it) -> ((Boolean) context.getRootInterpreter().evaluate(it, context, coverage, trace, false)));
          SNode y = ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.yExpr$c$EN)).findFirst((it) -> ((Boolean) context.getRootInterpreter().evaluate(it, context, coverage, trace, false)));
          if (x == null || y == null) {
            return context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.def$$UYK), context, coverage, trace, false);
          }
          return context.getRootInterpreter().evaluate(ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.cExpr$c$TO)).getElement((SNodeOperations.getIndexInParent(y)) * (ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.xExpr$c$rM)).count()) + (SNodeOperations.getIndexInParent(x))), context, coverage, trace, false);
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("dectab()", node, ex, trace);
        }
      }
      public boolean isEvaluable(SNode node, final IContext context) {
        return Sequence.fromIterable(SNodeOperations.ofConcept(SNodeOperations.getChildren(node), CONCEPTS.Expression$bT)).all((it) -> {
          boolean b = ((IConditionalInterpreter) context.getRootInterpreter()).isEvaluable(it, context);
          System.out.println("Dectab part: " + SNodeOperations.present(it) + ": " + b);
          return b;
        });
      }

      @Override
      public String toString() {
        return "DecTab";
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("DecTab", "http://127.0.0.1:63320/node?ref=9d6058ab-ae41-4b52-9649-81f5f077e48e%2Fi%3A10000001%28com.mbeddr.core.util.interpreter%40transient40%2Fcom.mbeddr.core.util.interpreter.plugin%400%29%2F4535693827938077180");
      }

      @Override
      public boolean canLookupBeCached() {
        return false;
      }

    });
    ListSequence.fromList(((List<IConditionalEvaluator>) evaluators)).addElement(new ConditionalConceptEvaluatorBase(CONCEPTS.GSwitchExpression$$w, "r:7b666de7-002f-4492-b5bd-942c41bb2387(com.mbeddr.core.util.interpreter.plugin)/4535693827938077288", true) {
      public Object evaluateEvaluator(SNode node, final IContext context, final ICoverageAnalyzer coverage, final ComputationTrace trace) {
        try {
          coverage.visitedEvaluator(this);
          coverage.visitedConcept(this.concept);
          if (this.concept != SNodeOperations.getConcept(node)) {
            coverage.visitedConcept(SNodeOperations.getConcept(node));
          }
          SNode c = ListSequence.fromList(SLinkOperations.getChildren(node, LINKS.cases$qxxE)).findFirst((it) -> ((Boolean) context.getRootInterpreter().evaluate(SLinkOperations.getTarget(it, LINKS.condition$qayB), context, coverage, trace, false)));
          if (c != null) {
            return context.getRootInterpreter().evaluate(SLinkOperations.getTarget(c, LINKS.result$qaLC), context, coverage, trace, false);
          }
          return context.getRootInterpreter().evaluate(SLinkOperations.getTarget(node, LINKS.def$qDwc), context, coverage, trace, false);
        } catch (InterpreterEscapeException ex) {
          throw ex;
        } catch (RuntimeException ex) {
          throw new InterpreterRuntimeException("gswitch()", node, ex, trace);
        }
      }

      @Override
      public String toString() {
        return "GSwitchExpression";
      }
      public EvaluatorInfo getInfo() {
        return new EvaluatorInfo("GSwitchExpression", "http://127.0.0.1:63320/node?ref=9d6058ab-ae41-4b52-9649-81f5f077e48e%2Fi%3A10000001%28com.mbeddr.core.util.interpreter%40transient40%2Fcom.mbeddr.core.util.interpreter.plugin%400%29%2F4535693827938077288");
      }

      @Override
      public boolean canLookupBeCached() {
        return false;
      }

    });
  }


  protected void populateTypeMappers(List<? extends ITypeMapper> typeMappers) {
  }



  protected void populateRelationships(List<? extends IRelationship> relationships) {
    ListSequence.fromList(((List<IRelationship>) relationships)).addElement(new InterpretAfterRelationshipImpl("com.mbeddr.core.util.interpreter.plugin.InterpreterCExtInterpreter", "com.mbeddr.core.expressions.interpreter.plugin.InterpreterCExpressionsInterpreter"));
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink xExpr$c$rM = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589fd7ddL, 0x562cea45589fd7deL, "xExpr");
    /*package*/ static final SContainmentLink yExpr$c$EN = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589fd7ddL, 0x562cea45589fd7dfL, "yExpr");
    /*package*/ static final SContainmentLink def$$UYK = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589fd7ddL, 0x397f0b8bfd125416L, "def");
    /*package*/ static final SContainmentLink cExpr$c$TO = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589fd7ddL, 0x562cea45589fd7e0L, "cExpr");
    /*package*/ static final SContainmentLink cases$qxxE = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589f7be6L, 0x562cea45589f7c0bL, "cases");
    /*package*/ static final SContainmentLink condition$qayB = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589f7be7L, 0x562cea45589f7be8L, "condition");
    /*package*/ static final SContainmentLink result$qaLC = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589f7be7L, 0x562cea45589f7be9L, "result");
    /*package*/ static final SContainmentLink def$qDwc = MetaAdapterFactory.getContainmentLink(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589f7be6L, 0x562cea45589f7c18L, "def");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Expression$bT = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba32L, "com.mbeddr.core.expressions.structure.Expression");
    /*package*/ static final SConcept DecTab$yC = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589fd7ddL, "com.mbeddr.core.util.structure.DecTab");
    /*package*/ static final SConcept GSwitchExpression$$w = MetaAdapterFactory.getConcept(0x2693fc719b0e4b05L, 0xab13f57227d675f2L, 0x562cea45589f7be6L, "com.mbeddr.core.util.structure.GSwitchExpression");
  }
}
