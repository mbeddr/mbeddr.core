package com.mbeddr.cc.trace.typesystem;

/*Generated by MPS */

import jetbrains.mps.lang.typesystem.runtime.AbstractNonTypesystemRule_Runtime;
import jetbrains.mps.lang.typesystem.runtime.NonTypesystemRule_Runtime;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.typesystem.inference.TypeCheckingContext;
import jetbrains.mps.lang.typesystem.runtime.IsApplicableStatus;
import com.mbeddr.cc.trace.behavior.TraceKind__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.errors.messageTargets.MessageTarget;
import jetbrains.mps.errors.messageTargets.NodeMessageTarget;
import jetbrains.mps.errors.IErrorReporter;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class check_TraceKind_NonTypesystemRule extends AbstractNonTypesystemRule_Runtime implements NonTypesystemRule_Runtime {
  public check_TraceKind_NonTypesystemRule() {
  }
  public void applyRule(final SNode tk, final TypeCheckingContext typeCheckingContext, IsApplicableStatus status) {
    String locationError = TraceKind__BehaviorDescriptor.cannotBeUsedHereErrorMessage_id6pDXxhBbHL_.invoke(tk, SNodeOperations.getParent(SNodeOperations.getParent(tk)));
    if (locationError != null) {
      {
        final MessageTarget errorTarget = new NodeMessageTarget();
        IErrorReporter _reporter_2309309498 = typeCheckingContext.reportTypeError(tk, "This tracekind cannot be used here: " + locationError, "r:0934fbfc-465d-4db6-a286-a64cc07392f2(com.mbeddr.cc.trace.typesystem)", "7379700031914209805", null, errorTarget);
      }
    }
    SNode annotation = SNodeOperations.getNodeAncestor(tk, CONCEPTS.TraceAnnotation$ho, false, false);
    for (SNode traceRef : Sequence.fromIterable(SNodeOperations.ofConcept(SLinkOperations.getChildren(annotation, LINKS.refs$Khba), CONCEPTS.TraceTargetRef$EW))) {
      String targetError = TraceKind__BehaviorDescriptor.cannotTraceToTargetErrorMessage_id6pDXxhBbHPs.invoke(tk, SLinkOperations.getTarget(traceRef, LINKS.target$hiva));
      if (targetError != null) {
        {
          final MessageTarget errorTarget = new NodeMessageTarget();
          IErrorReporter _reporter_2309309498 = typeCheckingContext.reportTypeError(traceRef, "This tracekind cannot be used here: " + locationError, "r:0934fbfc-465d-4db6-a286-a64cc07392f2(com.mbeddr.cc.trace.typesystem)", "7379700031914218188", null, errorTarget);
        }
      }
    }
  }
  public SAbstractConcept getApplicableConcept() {
    return CONCEPTS.TraceKind$jN;
  }
  public IsApplicableStatus isApplicableAndPattern(SNode argument) {
    return new IsApplicableStatus(argument.getConcept().isSubConceptOf(getApplicableConcept()), null);
  }
  public boolean overrides() {
    return false;
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept TraceAnnotation$ho = MetaAdapterFactory.getConcept(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408b62L, "com.mbeddr.cc.trace.structure.TraceAnnotation");
    /*package*/ static final SConcept TraceTargetRef$EW = MetaAdapterFactory.getConcept(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408cb3L, "com.mbeddr.cc.trace.structure.TraceTargetRef");
    /*package*/ static final SConcept TraceKind$jN = MetaAdapterFactory.getConcept(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408b67L, "com.mbeddr.cc.trace.structure.TraceKind");
  }

  private static final class LINKS {
    /*package*/ static final SReferenceLink target$hiva = MetaAdapterFactory.getReferenceLink(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408cb3L, 0x619a854eb410247L, "target");
    /*package*/ static final SContainmentLink refs$Khba = MetaAdapterFactory.getContainmentLink(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x3f878a0314aee6c0L, 0x3f878a0314aeff4dL, "refs");
  }
}
