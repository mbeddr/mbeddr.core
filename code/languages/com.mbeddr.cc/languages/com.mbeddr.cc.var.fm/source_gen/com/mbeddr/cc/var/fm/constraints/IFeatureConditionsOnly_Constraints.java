package com.mbeddr.cc.var.fm.constraints;

/*Generated by MPS */

import jetbrains.mps.smodel.runtime.base.BaseConstraintsDescriptor;
import jetbrains.mps.smodel.runtime.ConstraintFunction;
import jetbrains.mps.smodel.runtime.ConstraintContext_CanBeAncestor;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.smodel.runtime.CheckingNodeContext;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.smodel.SNodePointer;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SConcept;

public class IFeatureConditionsOnly_Constraints extends BaseConstraintsDescriptor {
  public IFeatureConditionsOnly_Constraints() {
    super(CONCEPTS.IFeatureConditionsOnly$n8);
  }

  @Override
  protected ConstraintFunction<ConstraintContext_CanBeAncestor, Boolean> calculateCanBeAncestorConstraint() {
    return new ConstraintFunction<ConstraintContext_CanBeAncestor, Boolean>() {
      @NotNull
      public Boolean invoke(@NotNull ConstraintContext_CanBeAncestor context, @Nullable CheckingNodeContext checkingNodeContext) {
        boolean result = staticCanBeAnAncestor(context.getNode(), context.getChildNode(), context.getChildConcept(), context.getParentNode(), context.getLink());

        if (!(result) && checkingNodeContext != null) {
          checkingNodeContext.setBreakingNode(canBeAncestorBreakingPoint);
        }

        return result;
      }
    };
  }
  private static boolean staticCanBeAnAncestor(SNode node, SNode childNode, SAbstractConcept childConcept, SNode parentNode, SContainmentLink link) {
    if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(childConcept), CONCEPTS.Expression$bT)) {
      // all these restrictions are driven by limitations in the interpreter FeatureConditionEvalHelper
      if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(childConcept), CONCEPTS.BinaryExpression$cR)) {
        return true;
      }
      if (childConcept == CONCEPTS.NotExpression$pF) {
        return true;
      }
      if (childConcept == CONCEPTS.FeatureRef$MU) {
        return true;
      }
      if (childConcept == CONCEPTS.FeatureAttributeRef$It) {
        return true;
      }
      if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(childConcept), CONCEPTS.NumberLiteral$jK)) {
        return true;
      }
      if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(childConcept), CONCEPTS.EnumLiteralRef$ZN)) {
        return true;
      }
      if (SConceptOperations.isSubConceptOf(SNodeOperations.asSConcept(childConcept), CONCEPTS.ParensExpression$Ng)) {
        return true;
      }
      return false;
    }
    return true;
  }
  private static final SNodePointer canBeAncestorBreakingPoint = new SNodePointer("r:6931d509-c614-495e-afa5-7bb50f15b429(com.mbeddr.cc.var.fm.constraints)", "8237807170236525595");

  private static final class CONCEPTS {
    /*package*/ static final SInterfaceConcept IFeatureConditionsOnly$n8 = MetaAdapterFactory.getInterfaceConcept(0xe401b44780194ccdL, 0xa72cbfb0230f5782L, 0x6a0e1211f136a3f3L, "com.mbeddr.cc.var.fm.structure.IFeatureConditionsOnly");
    /*package*/ static final SConcept BinaryExpression$cR = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba34L, "com.mbeddr.core.expressions.structure.BinaryExpression");
    /*package*/ static final SConcept NotExpression$pF = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x352a4cc97cbac907L, "com.mbeddr.core.expressions.structure.NotExpression");
    /*package*/ static final SConcept FeatureRef$MU = MetaAdapterFactory.getConcept(0xe401b44780194ccdL, 0xa72cbfb0230f5782L, 0x6a0e1211f0e3a631L, "com.mbeddr.cc.var.fm.structure.FeatureRef");
    /*package*/ static final SConcept FeatureAttributeRef$It = MetaAdapterFactory.getConcept(0x17fba0eaf154a23L, 0xb0a802b5c1141e75L, 0x6f686b5f00f0a7L, "com.mbeddr.cc.var.annotations.structure.FeatureAttributeRef");
    /*package*/ static final SConcept NumberLiteral$jK = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba67L, "com.mbeddr.core.expressions.structure.NumberLiteral");
    /*package*/ static final SConcept EnumLiteralRef$ZN = MetaAdapterFactory.getConcept(0xefda956e491e4f00L, 0xba1436af2f213ecfL, 0x7a4924c71c1b40b7L, "com.mbeddr.core.udt.structure.EnumLiteralRef");
    /*package*/ static final SConcept ParensExpression$Ng = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x4ffba68fe82dd4c7L, "com.mbeddr.core.expressions.structure.ParensExpression");
    /*package*/ static final SConcept Expression$bT = MetaAdapterFactory.getConcept(0x61c69711ed614850L, 0x81d97714ff227fb0L, 0x7af69e2e83a1ba32L, "com.mbeddr.core.expressions.structure.Expression");
  }
}
