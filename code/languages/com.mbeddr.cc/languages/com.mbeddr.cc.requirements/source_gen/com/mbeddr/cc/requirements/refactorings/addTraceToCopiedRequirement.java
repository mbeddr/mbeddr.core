package com.mbeddr.cc.requirements.refactorings;

/*Generated by MPS */

import jetbrains.mps.refactoring.framework.BaseRefactoring;
import jetbrains.mps.refactoring.framework.IRefactoringTarget;
import jetbrains.mps.refactoring.framework.RefactoringContext;
import org.jetbrains.mps.openapi.model.SNode;
import com.mbeddr.cc.requirements.actions.ReqCopier;
import jetbrains.mps.smodel.MPSModuleRepository;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;

public class addTraceToCopiedRequirement extends BaseRefactoring {
  public addTraceToCopiedRequirement() {
  }
  public IRefactoringTarget getRefactoringTarget() {
    return new addTraceToCopiedRequirement_Target();
  }
  public String getUserFriendlyName() {
    return "Trace to Copied Requirement";
  }
  public void refactor(final RefactoringContext refactoringContext) {
    SNode req = ((SNode) ReqCopier.ptr.resolve(MPSModuleRepository.getInstance()));
    for (SNode n : ListSequence.fromList(refactoringContext.getSelectedNodes())) {
      SNode trace = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408b62L, "com.mbeddr.cc.trace.structure.TraceAnnotation"));
      new IAttributeDescriptor.NodeAttribute(CONCEPTS.TraceAnnotation$ho).set(n, trace);
      SLinkOperations.setTarget(trace, LINKS.tracekind$KgW9, SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408b6bL, "com.mbeddr.cc.trace.structure.ImplementsTraceKind")));
      SNode ref = SConceptOperations.createNewNode(MetaAdapterFactory.getConcept(0xe865cad27cc8437aL, 0x951a665bcbcb8b1aL, 0x619a854eb41655dL, "com.mbeddr.cc.requirements.structure.RequirementRef"));
      SLinkOperations.setTarget(ref, LINKS.target$hiva, req);
      ListSequence.fromList(SLinkOperations.getChildren(trace, LINKS.refs$Khba)).addElement(ref);
    }
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept TraceAnnotation$ho = MetaAdapterFactory.getConcept(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408b62L, "com.mbeddr.cc.trace.structure.TraceAnnotation");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink tracekind$KgW9 = MetaAdapterFactory.getContainmentLink(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x3f878a0314aee6c0L, 0x3f878a0314aeff4cL, "tracekind");
    /*package*/ static final SReferenceLink target$hiva = MetaAdapterFactory.getReferenceLink(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x619a854eb408cb3L, 0x619a854eb410247L, "target");
    /*package*/ static final SContainmentLink refs$Khba = MetaAdapterFactory.getContainmentLink(0x53bab999e9c3428aL, 0x80befef5bed08f55L, 0x3f878a0314aee6c0L, 0x3f878a0314aeff4dL, "refs");
  }
}
