package com.mbeddr.cc.requirements.typesystem;

/*Generated by MPS */

import jetbrains.mps.lang.typesystem.runtime.AbstractNonTypesystemRule_Runtime;
import jetbrains.mps.lang.typesystem.runtime.NonTypesystemRule_Runtime;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.typesystem.inference.TypeCheckingContext;
import jetbrains.mps.lang.typesystem.runtime.IsApplicableStatus;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import com.mbeddr.cc.requirements.behavior.RequirementsKind__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.errors.messageTargets.MessageTarget;
import jetbrains.mps.errors.messageTargets.NodeMessageTarget;
import jetbrains.mps.errors.IErrorReporter;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import jetbrains.mps.errors.BaseQuickFixProvider;
import com.mbeddr.mpsutil.suppresswarning.behavior.SuppressWarnings__BehaviorDescriptor;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.errors.messageTargets.PropertyMessageTarget;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SConcept;

public class check_Requirement_NonTypesystemRule extends AbstractNonTypesystemRule_Runtime implements NonTypesystemRule_Runtime {
  public check_Requirement_NonTypesystemRule() {
  }
  public void applyRule(final SNode r, final TypeCheckingContext typeCheckingContext, IsApplicableStatus status) {
    for (final SAbstractConcept rdk : ListSequence.fromList(RequirementsKind__BehaviorDescriptor.getRequiredDataKind_id2AZbPfMcvYE.invoke(SNodeOperations.asSConcept(SNodeOperations.getConcept(SLinkOperations.getTarget(r, LINKS.kind$XKhf)))))) {
      if (!(ListSequence.fromList(SLinkOperations.getChildren(r, LINKS.additionalData$Mhbk)).any((it) -> SNodeOperations.isInstanceOf(it, SNodeOperations.asSConcept(rdk))))) {
        {
          final MessageTarget errorTarget = new NodeMessageTarget();
          IErrorReporter _reporter_2309309498 = typeCheckingContext.reportTypeError(SLinkOperations.getTarget(r, LINKS.kind$XKhf), "an instance of " + SConceptOperations.conceptAlias(rdk) + " is expected in requirements of kind " + SLinkOperations.getTarget(r, LINKS.kind$XKhf), "r:6d955fa4-5e1f-4ac1-9307-613a95ee3b74(com.mbeddr.cc.requirements.typesystem)", "6514529288614030934", null, errorTarget);
          {
            BaseQuickFixProvider intentionProvider = new BaseQuickFixProvider("com.mbeddr.cc.requirements.typesystem.fixDataForReqKind_QuickFix", "6514529288614031102", true);
            intentionProvider.putArgument("r", r);
            intentionProvider.putArgument("c", rdk);
            _reporter_2309309498.addIntentionProvider(intentionProvider);
          }
        }
      }
    }
    if ((boolean) SuppressWarnings__BehaviorDescriptor.isNotSuppressed_id7U3Fobb_8Eq.invoke(SNodeOperations.asSConcept(CONCEPTS.SuppressWarnings$uu), r)) {
      if (isNotEmptyString(SPropertyOperations.getString(r, PROPS.summmary$yOcD)) && SPropertyOperations.getString(r, PROPS.summmary$yOcD).length() > 80) {
        {
          final MessageTarget errorTarget = new PropertyMessageTarget(PROPS.summmary$yOcD);
          IErrorReporter _reporter_2309309498 = typeCheckingContext.reportWarning(r, "This should not be longer than 80 characters (for reasons of formatting reports)", "r:6d955fa4-5e1f-4ac1-9307-613a95ee3b74(com.mbeddr.cc.requirements.typesystem)", "4557518620047946998", null, errorTarget);
        }
      }
    }


  }
  public SAbstractConcept getApplicableConcept() {
    return CONCEPTS.Requirement$sS;
  }
  public IsApplicableStatus isApplicableAndPattern(SNode argument) {
    return new IsApplicableStatus(argument.getConcept().isSubConceptOf(getApplicableConcept()), null);
  }
  public boolean overrides() {
    return false;
  }
  private static boolean isNotEmptyString(String str) {
    return str != null && str.length() > 0;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink additionalData$Mhbk = MetaAdapterFactory.getContainmentLink(0xe865cad27cc8437aL, 0x951a665bcbcb8b1aL, 0x795de87bb67288a5L, 0x795de87bb6776476L, "additionalData");
    /*package*/ static final SContainmentLink kind$XKhf = MetaAdapterFactory.getContainmentLink(0xe865cad27cc8437aL, 0x951a665bcbcb8b1aL, 0x795de87bb67288a5L, 0x7bceab23f9071900L, "kind");
  }

  private static final class PROPS {
    /*package*/ static final SProperty summmary$yOcD = MetaAdapterFactory.getProperty(0xe865cad27cc8437aL, 0x951a665bcbcb8b1aL, 0x795de87bb67288a5L, 0x2f37dd3a4d6226c7L, "summmary");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept SuppressWarnings$uu = MetaAdapterFactory.getConcept(0xc1c2a88a323c4605L, 0xa37d9ab77a2ccbd2L, 0x7e83ad82cb948a95L, "com.mbeddr.mpsutil.suppresswarning.structure.SuppressWarnings");
    /*package*/ static final SConcept Requirement$sS = MetaAdapterFactory.getConcept(0xe865cad27cc8437aL, 0x951a665bcbcb8b1aL, 0x795de87bb67288a5L, "com.mbeddr.cc.requirements.structure.Requirement");
  }
}
