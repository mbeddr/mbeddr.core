package com.mbeddr.doc.terms.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import com.mbeddr.mpsutil.plantuml.node.behavior.VisGraph;
import java.util.List;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import java.util.Set;
import jetbrains.mps.internal.collections.runtime.SetSequence;
import java.util.HashSet;
import com.mbeddr.doc.behavior.IDocumentLike__BehaviorDescriptor;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import de.slisson.mps.richtext.behavior.Text__BehaviorDescriptor;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public final class TermDefParagraph__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0xc61970b487fb4429L, 0x8a3ac87719f000a3L, 0x76fd5c33d5beb851L, "com.mbeddr.doc.terms.structure.TermDefParagraph");

  public static final SMethod<String[]> getCategories_id2N1CSrzPN_a = new SMethodBuilder<String[]>(new SJavaCompoundTypeImpl(String[].class)).name("getCategories").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3225038607917463882L).languageId(0x943e3a41f97a0e52L, 0xb4d28e197d2d47e9L).build2();
  public static final SMethod<Void> getVisualization_id2N1CSrzPN_f = new SMethodBuilder<Void>(new SJavaCompoundTypeImpl(Void.class)).name("getVisualization").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3225038607917463887L).languageId(0x943e3a41f97a0e52L, 0xb4d28e197d2d47e9L).build2(SMethodBuilder.createJavaParameter(String.class, ""), SMethodBuilder.createJavaParameter(VisGraph.class, ""));

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(getCategories_id2N1CSrzPN_a, getVisualization_id2N1CSrzPN_f);

  private static void ___init___(@NotNull SNode __thisNode__) {
    SLinkOperations.setNewChild(__thisNode__, LINKS.text$68WF, null);
  }

  /*package*/ static String[] getCategories_id2N1CSrzPN_a(@NotNull SNode __thisNode__) {
    return new String[]{"term dependencies"};
  }
  /*package*/ static void getVisualization_id2N1CSrzPN_f(@NotNull SNode __thisNode__, String category, VisGraph graph) {
    SNode d = SNodeOperations.getNodeAncestor(__thisNode__, CONCEPTS.Document$4G, false, false);
    Set<SNode> allDocs = SetSequence.fromSet(new HashSet<SNode>());
    IDocumentLike__BehaviorDescriptor.collectTransitivelyIncludedDocuments_id5mf_X_LbzMD.invoke(d, allDocs);
    Iterable<SNode> allTerms = SetSequence.fromSet(allDocs).translate((it) -> SNodeOperations.getNodeDescendants(it, CONCEPTS.TermDefParagraph$_y, false, new SAbstractConcept[]{}));
    for (SNode t : Sequence.fromIterable(allTerms)) {
      graph.add("class " + SPropertyOperations.getString(t, PROPS.term$63Ml) + " << (T,#FF7700) >> " + "{");
      graph.add("}");
      graph.add("url of " + SPropertyOperations.getString(t, PROPS.term$63Ml) + " is " + graph.createLink(t));
    }

    for (SNode t : Sequence.fromIterable(allTerms)) {
      List<SNode> rels = SNodeOperations.getNodeDescendants(t, CONCEPTS.TermRelationshipText$Ru, false, new SAbstractConcept[]{});
      for (SNode r : ListSequence.fromList(rels)) {
        String label = Text__BehaviorDescriptor.asTextString_id3Q5enzfMT4l.invoke(SLinkOperations.getTarget(r, LINKS.text$eJIi));
        List<SNode> targetWords = SNodeOperations.getNodeDescendants(r, CONCEPTS.TermRefWord$z2, false, new SAbstractConcept[]{});
        for (SNode tw : ListSequence.fromList(targetWords)) {
          graph.add(SPropertyOperations.getString(t, PROPS.term$63Ml) + " ..> " + SPropertyOperations.getString(SLinkOperations.getTarget(tw, LINKS.term$gD6L), PROPS.term$63Ml) + ": " + label);
        }
      }
    }
    graph.add("hide members");
  }

  /*package*/ TermDefParagraph__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((String[]) getCategories_id2N1CSrzPN_a(node));
      case 1:
        getVisualization_id2N1CSrzPN_f(node, (String) parameters[0], (VisGraph) parameters[1]);
        return null;
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink text$68WF = MetaAdapterFactory.getContainmentLink(0xc61970b487fb4429L, 0x8a3ac87719f000a3L, 0x76fd5c33d5beb851L, 0x76fd5c33d5beb854L, "text");
    /*package*/ static final SContainmentLink text$eJIi = MetaAdapterFactory.getContainmentLink(0x2374bc907e3741f1L, 0xa9c4c2e35194c36aL, 0x558f97d9712a5ce4L, 0x558f97d9712a5ce5L, "text");
    /*package*/ static final SReferenceLink term$gD6L = MetaAdapterFactory.getReferenceLink(0xc61970b487fb4429L, 0x8a3ac87719f000a3L, 0x76fd5c33d5bddfa0L, 0x76fd5c33d5bddfa9L, "term");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Document$4G = MetaAdapterFactory.getConcept(0x2374bc907e3741f1L, 0xa9c4c2e35194c36aL, 0x2e7fd03a4b7a1830L, "com.mbeddr.doc.structure.Document");
    /*package*/ static final SConcept TermDefParagraph$_y = MetaAdapterFactory.getConcept(0xc61970b487fb4429L, 0x8a3ac87719f000a3L, 0x76fd5c33d5beb851L, "com.mbeddr.doc.terms.structure.TermDefParagraph");
    /*package*/ static final SConcept TermRelationshipText$Ru = MetaAdapterFactory.getConcept(0xc61970b487fb4429L, 0x8a3ac87719f000a3L, 0x111ef2679b49634cL, "com.mbeddr.doc.terms.structure.TermRelationshipText");
    /*package*/ static final SConcept TermRefWord$z2 = MetaAdapterFactory.getConcept(0xc61970b487fb4429L, 0x8a3ac87719f000a3L, 0x76fd5c33d5bddfa0L, "com.mbeddr.doc.terms.structure.TermRefWord");
  }

  private static final class PROPS {
    /*package*/ static final SProperty term$63Ml = MetaAdapterFactory.getProperty(0xc61970b487fb4429L, 0x8a3ac87719f000a3L, 0x76fd5c33d5beb851L, 0x76fd5c33d5beb853L, "term");
  }
}
