package com.mbeddr.doc.behavior;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import org.apache.commons.lang3.StringUtils;

public class StableIdHelper {
  private static final String USER_OBJECT_KEY = "__stableId";
  private static final String STABLE_ID_PREFIX = "sid";

  public static String getStableId(SNode n) {
    String userObject = (String) n.getUserObject(USER_OBJECT_KEY);
    if (userObject != null) {
      return userObject;
    } else {
      // create a stableId on demand and store it for next time
      String newStableId = computeStableId(n);
      n.putUserObject(USER_OBJECT_KEY, newStableId);
      return newStableId;
    }
  }

  public static void setStableId(SNode n) {
    n.putUserObject(USER_OBJECT_KEY, computeStableId(n));
  }

  private static String computeStableId(SNode n) {
    return STABLE_ID_PREFIX + StringUtils.deleteWhitespace(n.getNodeId().toString());
  }
}
