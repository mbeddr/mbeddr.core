package com.mbeddr.mpsutil.actionsfilter.runtime.tests;

/*Generated by MPS */

import jetbrains.mps.MPSLaunch;
import jetbrains.mps.lang.test.runtime.BaseTransformationTest;
import org.junit.jupiter.api.extension.RegisterExtension;
import jetbrains.mps.lang.test.runtime.TestParametersCacheExtension;
import jetbrains.mps.lang.test.runtime.TestParametersCacheBuilder;
import org.junit.jupiter.api.Test;
import jetbrains.mps.lang.test.runtime.BaseTestBody;
import jetbrains.mps.lang.test.runtime.TransformationTest;
import com.mbeddr.mpsutil.actionsfilter.runtime.Model;
import com.mbeddr.mpsutil.actionsfilter.runtime.Profile;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import org.junit.Assert;
import com.mbeddr.mpsutil.actionsfilter.runtime.ToolbarSettings;
import com.mbeddr.mpsutil.actionsfilter.runtime.ToolBarEntry;

@MPSLaunch
public class ModelTest_Test extends BaseTransformationTest {
  @RegisterExtension
  private static final TestParametersCacheExtension ourParametersCacheExtension = new TestParametersCacheExtension(new TestParametersCacheBuilder(ModelTest_Test.class).projectPath(null).modelRef("r:eddc3924-ccea-4ced-aea2-faf864d53897(com.mbeddr.mpsutil.actionsfilter.runtime.tests)").reopenProject(null).build());

  public ModelTest_Test() {
    super(ourParametersCacheExtension.getParametersCache());
  }

  @Test
  public void test_testAddProfile() throws Throwable {
    new TestBody(this).test_testAddProfile();
  }
  @Test
  public void test_removeProfile() throws Throwable {
    new TestBody(this).test_removeProfile();
  }
  @Test
  public void test_cloning() throws Throwable {
    new TestBody(this).test_cloning();
  }
  @Test
  public void test_equalsAndHashCode() throws Throwable {
    new TestBody(this).test_equalsAndHashCode();
  }
  @Test
  public void test_setActiveProfile() throws Throwable {
    new TestBody(this).test_setActiveProfile();
  }
  @Test
  public void test_copyProfileCreatesCloneOfActive() throws Throwable {
    new TestBody(this).test_copyProfileCreatesCloneOfActive();
  }
  @Test
  public void test_updateProfileReplacesExisting() throws Throwable {
    new TestBody(this).test_updateProfileReplacesExisting();
  }

  /*package*/ static class TestBody extends BaseTestBody {

    /*package*/ TestBody(TransformationTest owner) {
      super(owner);
    }

    @Override
    protected void initTestNodes() {
      prepareTestNodes();
    }

    public void test_testAddProfile() throws Exception {
      initTestNodes();
      runWithinCommand(() -> {
        Model model = new Model();
        Profile baseProfile = new Profile("BaseProfile");
        model.setProfiles(ListSequence.fromListAndArray(new ArrayList<>(), baseProfile));
        Profile newProfile = new Profile("NewProfile");
        model.addProfile(newProfile);
        Assert.assertTrue(ListSequence.fromList(model.getAllProfiles()).contains(newProfile));
      });
    }
    public void test_removeProfile() throws Exception {
      initTestNodes();
      runWithinCommand(() -> {
        Model model = new Model();
        Profile baseProfile = new Profile("Base");
        model.setProfiles(ListSequence.fromListAndArray(new ArrayList<>(), baseProfile));
        model.removeProfile(baseProfile);
        Assert.assertFalse(ListSequence.fromList(model.getAllProfiles()).contains(baseProfile));
      });
    }
    public void test_cloning() throws Exception {
      initTestNodes();
      runWithinCommand(() -> {
        final Model model = new Model();
        model.createProfile("CloneMe");
        final Model cloned = model.clone();
        Assert.assertEquals(model, cloned);
        Assert.assertEquals(model.allProfiles, cloned.allProfiles);
        Assert.assertEquals(model.getActiveProfile(), cloned.getActiveProfile());
      });
    }
    public void test_equalsAndHashCode() throws Exception {
      initTestNodes();
      runWithinCommand(() -> {
        Model model = TestBody.this.createTestModel();
        model.createProfile("EqualTest");
        Model other = model.clone();
        other.setProfiles(model.getAllProfiles());
        Assert.assertEquals(model, other);
        Assert.assertEquals(model.hashCode(), other.hashCode());
      });
    }
    public void test_setActiveProfile() throws Exception {
      initTestNodes();
      runWithinCommand(() -> {
        Model model = new Model();
        Profile targetProfile = new Profile("Target");
        model.setProfiles(ListSequence.fromListAndArray(new ArrayList<>(), targetProfile));
        model.setActiveProfile(targetProfile);
        Assert.assertEquals(targetProfile, model.getActiveProfile());
      });
    }
    public void test_copyProfileCreatesCloneOfActive() throws Exception {
      initTestNodes();
      runWithinCommand(() -> {
        Model model = new Model();
        Profile profile = new Profile("Copied");
        model.setProfiles(ListSequence.fromListAndArray(new ArrayList<>(), profile));
        model.setActiveProfile(profile);
        Profile copy = model.copyProfile();
        Assert.assertNotNull(copy);
        Assert.assertEquals(copy, profile);
        Assert.assertFalse(copy.isPredefined());
        Assert.assertTrue(ListSequence.fromList(model.getAllProfiles()).contains(copy));
      });
    }
    public void test_updateProfileReplacesExisting() throws Exception {
      initTestNodes();
      runWithinCommand(() -> {
        Model model = new Model();
        Profile oldProfile = new Profile("Old");
        Profile newProfile = new Profile("New");
        model.setProfiles(ListSequence.fromListAndArray(new ArrayList<>(), oldProfile));
        model.updateProfile(oldProfile, newProfile);
        Assert.assertTrue(ListSequence.fromList(model.getAllProfiles()).contains(newProfile));
        Assert.assertFalse(ListSequence.fromList(model.getAllProfiles()).contains(oldProfile));
      });
    }

    public Model createTestModel() {
      Model model = new Model();
      for (int i = 0; i < 5; i++) {
        Profile profile = new Profile("Profile" + i, Math.random() > 0.5);
        for (int j = 0; j < 5; j++) {
          profile.filterSettings.addFilteredId(Math.random() + "");
          profile.toolbarSettings = new ToolbarSettings();
          profile.toolbarSettings.addEntry(new ToolBarEntry(Math.random() + "", null, ToolBarEntry.EntryType.TOOLBAR_ACTION));
        }
        model.addProfile(profile);
      }
      model.activeProfileId = ListSequence.fromList(model.allProfiles).getElement((int) Math.random() * 5).getId();
      return model;
    }
  }
}
