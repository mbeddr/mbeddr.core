package com.mbeddr.core.base.pluginSolution.plugin;

/*Generated by MPS */

import jetbrains.mps.references.Reference;
import java.util.Deque;
import jetbrains.mps.internal.collections.runtime.LinkedListSequence;
import java.util.LinkedList;
import com.mbeddr.core.base.behavior.AbstractTreeViewNode;

public class TreeHistory {
  private HistoryElement myCurrent;
  public HistoryElement getCurrent() {
    return this.myCurrent;
  }
  private void _setCurrent(HistoryElement value) {
    this.myCurrent = value;
  }
  private HistoryElement setCurrent(HistoryElement value) {
    _setCurrent(value);
    return value;
  }
  private Reference<HistoryElement> refToCurrent() {
    return new Reference<HistoryElement>() {
      public HistoryElement get() {
        return getCurrent();
      }
      public void set(HistoryElement value) {
        _setCurrent(value);
      }
    };
  }
  private Deque<HistoryElement> history = LinkedListSequence.fromLinkedList(new LinkedList<HistoryElement>());
  public TreeHistory() {
  }
  public void add(AbstractTreeViewNode n) {
    HistoryElement element = new HistoryElement(n);
    LinkedListSequence.fromLinkedListNew(history).addElement(element);
    setCurrent(element);
  }
  public boolean hasNext() {
    int currentIndex = LinkedListSequence.fromLinkedListNew(history).indexOf(getCurrent());
    return currentIndex < LinkedListSequence.fromLinkedListNew(history).count() - 1;
  }
  public HistoryElement moveToNext() {
    int currentIndex = LinkedListSequence.fromLinkedListNew(history).indexOf(getCurrent());
    setCurrent(LinkedListSequence.fromLinkedListNew(history).getElement(currentIndex + 1));
    return getCurrent();
  }
  public boolean hasPrevious() {
    int currentIndex = LinkedListSequence.fromLinkedListNew(history).indexOf(getCurrent());
    return currentIndex > 0;
  }
  public HistoryElement moveToPrevious() {
    int currentIndex = LinkedListSequence.fromLinkedListNew(history).indexOf(getCurrent());
    if (currentIndex >= 1) {
      setCurrent(LinkedListSequence.fromLinkedListNew(history).getElement(currentIndex - 1));
    }
    return getCurrent();
  }
  public class HistoryElement {
    private AbstractTreeViewNode root;
    private String expansionState;
    public HistoryElement(AbstractTreeViewNode node) {
      this.root = node;
    }
    @Override
    public int hashCode() {
      return this.root.hashCode();
    }
    @Override
    public boolean equals(Object object) {
      if (object instanceof HistoryElement) {
        HistoryElement other = ((HistoryElement) object);
        return root.equals(other.root);
      }
      return false;
    }
    public void updateExpansionState(String expState) {
      this.expansionState = expState;
    }
    public AbstractTreeViewNode getTreeNode() {
      return root;
    }
    public String getExpansionState() {
      return expansionState;
    }
  }
}
