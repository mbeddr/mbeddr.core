package com.mbeddr.mpsutil.userstyles.runtime.plugin;

/*Generated by MPS */

import jetbrains.mps.plugins.part.ApplicationPluginPart;
import com.intellij.application.options.colors.ColorAndFontPanelFactory;
import com.intellij.openapi.options.colors.ColorAndFontDescriptorsProvider;
import org.jetbrains.annotations.NotNull;
import com.intellij.openapi.options.colors.AttributesDescriptor;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import com.intellij.openapi.editor.colors.TextAttributesKey;
import com.intellij.openapi.options.colors.ColorDescriptor;
import com.intellij.openapi.options.ConfigurableEP;
import com.intellij.openapi.options.Configurable;
import com.intellij.openapi.extensions.Extensions;
import com.intellij.application.options.colors.ColorAndFontOptions;
import com.intellij.openapi.extensions.DefaultPluginDescriptor;
import com.intellij.openapi.extensions.PluginId;

public class ApplicationPlugin_AppPluginPart extends ApplicationPluginPart {
  private ColorAndFontPanelFactory myFactory = new UserColorsPageFactory();
  private ColorAndFontDescriptorsProvider myProvider = new ColorAndFontDescriptorsProvider() {
    @NotNull
    public AttributesDescriptor[] getAttributeDescriptors() {
      return ListSequence.fromList(UserStylesDescriptors.getAllUserStyleItems()).select((it) -> new AttributesDescriptor(it.getDisplayText(), TextAttributesKey.createTextAttributesKey(it.getId()))).toGenericArray(AttributesDescriptor.class);
    }
    @NotNull
    public ColorDescriptor[] getColorDescriptors() {
      return new ColorDescriptor[0];
    }
    @NotNull
    public String getDisplayName() {
      return "Code";
    }
  };
  private ConfigurableEP<Configurable> myConfigurableEP;
  public ApplicationPlugin_AppPluginPart() {
  }
  @Override
  public void init() {
    Extensions.getArea(null).getExtensionPoint(ColorAndFontPanelFactory.EP_NAME).registerExtension(ApplicationPlugin_AppPluginPart.this.myFactory);
    Extensions.getArea(null).getExtensionPoint(ColorAndFontDescriptorsProvider.EP_NAME).registerExtension(ApplicationPlugin_AppPluginPart.this.myProvider);

    ApplicationPlugin_AppPluginPart.this.myConfigurableEP = new ConfigurableEP<Configurable>() {
      @Override
      public String getDisplayName() {
        return "Colors & Fonts";
      }
    };
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.groupId = "editor";
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.groupWeight = 180;
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.dynamic = true;
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.instanceClass = ColorAndFontOptions.class.getName();
    ClassLoader moduleCL = ApplicationPlugin_AppPluginPart.this.getClass().getClassLoader();
    DefaultPluginDescriptor customPluginDesc = new DefaultPluginDescriptor(PluginId.getId("com.mbeddr.mpsutil.userstyles.runtime"), moduleCL);
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.setPluginDescriptor(customPluginDesc);
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.id = "reference.settingsdialog.IDE.editor.colors";
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.key = "title.colors.and.fonts";
    ApplicationPlugin_AppPluginPart.this.myConfigurableEP.bundle = "messages.ApplicationBundle";
    Extensions.getArea(null).getExtensionPoint(Configurable.APPLICATION_CONFIGURABLE).registerExtension(ApplicationPlugin_AppPluginPart.this.myConfigurableEP);

  }
  @Override
  public void dispose() {
    Extensions.getArea(null).getExtensionPoint(ColorAndFontPanelFactory.EP_NAME).unregisterExtension(ApplicationPlugin_AppPluginPart.this.myFactory);
    Extensions.getArea(null).getExtensionPoint(ColorAndFontDescriptorsProvider.EP_NAME).unregisterExtension(ApplicationPlugin_AppPluginPart.this.myProvider);
    Extensions.getArea(null).getExtensionPoint(Configurable.APPLICATION_CONFIGURABLE).unregisterExtension(ApplicationPlugin_AppPluginPart.this.myConfigurableEP);
  }
}
