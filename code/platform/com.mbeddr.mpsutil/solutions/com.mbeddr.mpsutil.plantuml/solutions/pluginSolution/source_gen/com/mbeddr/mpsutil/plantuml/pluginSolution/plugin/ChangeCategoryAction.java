package com.mbeddr.mpsutil.plantuml.pluginSolution.plugin;

/*Generated by MPS */

import com.intellij.openapi.actionSystem.AnAction;
import com.intellij.openapi.actionSystem.ex.CustomComponentAction;
import jetbrains.mps.project.Project;
import javax.swing.MutableComboBoxModel;
import javax.swing.JComponent;
import com.intellij.openapi.actionSystem.Presentation;
import javax.swing.JComboBox;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;
import com.intellij.openapi.actionSystem.AnActionEvent;
import org.jetbrains.annotations.NotNull;
import com.intellij.openapi.actionSystem.ActionUpdateThread;

public class ChangeCategoryAction extends AnAction implements CustomComponentAction {
  private Project project;
  private MutableComboBoxModel<String> model;
  private AbstractChanceCategoryCallback callback;
  public ChangeCategoryAction(Project project, MutableComboBoxModel<String> model, AbstractChanceCategoryCallback callback) {
    this.project = project;
    this.model = model;
    this.callback = callback;
  }
  public JComponent createCustomComponent(Presentation presentation) {
    final JComboBox<String> box = new JComboBox(model);
    box.addActionListener(new ActionListener() {
      public void actionPerformed(ActionEvent event) {
        final Object selectedItem = box.getSelectedItem();
        if (selectedItem != null) {
          project.getRepository().getModelAccess().runReadAction(() -> callback.categoryChanged(selectedItem.toString()));
        }
      }
    });
    return box;
  }
  public void actionPerformed(AnActionEvent event) {
  }

  @NotNull
  @Override
  public ActionUpdateThread getActionUpdateThread() {
    return ActionUpdateThread.BGT;
  }

}
