package com.mbeddr.mpsutil.common.util;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNodeId;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.model.SModel;

public class SNodeIdentityWrapper {
  /**
   * This class is used to preserve node identity across model boundaries. This is useful in generator scenarios where
   * nodes are copied between the different phases.
   */
  private final SNodeId wrapped;
  public SNodeIdentityWrapper(SNode toWrap) {
    wrapped = toWrap.getNodeId();
  }

  public SNode unwrap(SModel m) {
    SNode node = m.getNode(wrapped);
    if (node == null) {
      throw new IllegalArgumentException("Can't find node with Id " + wrapped + " in model " + m);
    }
    return node;
  }

  @Override
  public int hashCode() {
    return wrapped.hashCode();
  }
  @Override
  public boolean equals(Object object) {
    if (object instanceof SNodeIdentityWrapper) {
      return wrapped.equals(((SNodeIdentityWrapper) object).wrapped);
    }
    return false;
  }
  public static SNodeIdentityWrapper wrap(SNode toWrap) {
    return new SNodeIdentityWrapper(toWrap);
  }
  @Override
  public String toString() {
    return "SNodeIdentityWrapper for NodeId: " + wrapped.toString();
  }
}
