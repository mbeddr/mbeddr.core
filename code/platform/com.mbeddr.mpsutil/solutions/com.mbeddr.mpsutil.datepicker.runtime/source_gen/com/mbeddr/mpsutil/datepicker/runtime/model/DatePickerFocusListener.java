package com.mbeddr.mpsutil.datepicker.runtime.model;

/*Generated by MPS */

import java.awt.event.FocusListener;
import java.awt.event.FocusEvent;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.openapi.editor.cells.CellTraversalUtil;
import jetbrains.mps.openapi.editor.selection.SelectionManager;
import jetbrains.mps.nodeEditor.cells.EditorCell_Label;

public class DatePickerFocusListener implements FocusListener {
  public DatePickerFocusListener(EditorCell_DatePickerComponent datePickerCell) {
    this.datePickerCell = datePickerCell;
  }
  public void focusGained(FocusEvent p0) {
  }
  public void focusLost(FocusEvent p0) {
    EditorCell otherCell = null;
    boolean setToStart = false;
    switch (p0.getCause()) {
      case TRAVERSAL_FORWARD:
        otherCell = CellTraversalUtil.getNextLeaf(datePickerCell);
        setToStart = true;
        break;
      case TRAVERSAL_BACKWARD:
        otherCell = CellTraversalUtil.getPrevLeaf(datePickerCell);
        setToStart = false;
        break;
      default:
    }

    SelectionManager selectionManager = datePickerCell.getEditorComponent().getEditorContext().getSelectionManager();

    if (otherCell != null) {
      if (otherCell instanceof EditorCell_Label) {
        EditorCell_Label otherLabel = (EditorCell_Label) otherCell;
        int index = 0;
        if (!(setToStart)) {
          index = otherLabel.getText().length();
        }
        selectionManager.setSelection(otherLabel, index);
      } else {
        selectionManager.setSelection(otherCell);
      }
    }
  }

  private EditorCell_DatePickerComponent datePickerCell;
}
