package com.mbeddr.mpsutil.contextactions.runtime;

/*Generated by MPS */

import jetbrains.mps.refactoring.framework.IRefactoring;
import jetbrains.mps.refactoring.framework.RefactoringContext;
import java.util.Collections;
import jetbrains.mps.refactoring.runtime.access.RefactoringAccess;
import org.jetbrains.annotations.Nullable;
import javax.swing.Icon;
import jetbrains.mps.ide.icons.GlobalIconManager;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;

public class RefactoringAction extends AbstractContextAction {

  private IRefactoring myRefactoring;

  public RefactoringAction(IRefactoring myRefactoring1) {
    myRefactoring = myRefactoring1;
  }

  public void execute(IContext context) {
    RefactoringContext refactoringContext = RefactoringContext.createRefactoringContext(myRefactoring, Collections.emptyList(), Collections.emptyList(), getTarget(context), context.getProject());
    RefactoringAccess.getInstance(context.getProject()).getRefactoringFacade().execute(refactoringContext);
  }

  protected Object getTarget(IContext context) {
    return (myRefactoring.getRefactoringTarget().allowMultipleTargets() ? context.getSNodes() : context.getSNode());
  }

  @Nullable
  public Icon getIcon(IContext context) {
    return GlobalIconManager.getInstance().getIconFor(CONCEPTS.Refactoring$bM);
  }

  @NotNull
  public ContextActionId getId() {
    return new ContextActionId(myRefactoring.getClass().getName());
  }

  @NotNull
  public String getLabel(IContext context) {
    return myRefactoring.getUserFriendlyName();
  }

  @Override
  public boolean isVisible(IContext context) {
    return RefactoringAccess.getInstance(context.getProject()).isApplicable(myRefactoring, getTarget(context));
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept Refactoring$bM = MetaAdapterFactory.getConcept(0x3ecd7c84cde345deL, 0x886c135ecc69b742L, 0x5fb04b74a778e245L, "jetbrains.mps.lang.refactoring.structure.Refactoring");
  }
}
