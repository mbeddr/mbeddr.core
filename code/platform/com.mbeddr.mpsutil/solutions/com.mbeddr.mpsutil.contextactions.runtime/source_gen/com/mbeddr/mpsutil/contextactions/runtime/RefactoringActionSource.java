package com.mbeddr.mpsutil.contextactions.runtime;

/*Generated by MPS */

import jetbrains.mps.refactoring.framework.IRefactoring;
import jetbrains.mps.refactoring.runtime.access.RefactoringAccess;
import jetbrains.mps.internal.collections.runtime.Sequence;
import java.util.Collections;

public class RefactoringActionSource extends AbstractActionSource {

  protected String myRefactoringClassName;

  public RefactoringActionSource(String refactoringClassName) {
    myRefactoringClassName = refactoringClassName;
  }

  protected IRefactoring getRefactoring() {
    try {
      Class<?> cls = Class.forName(myRefactoringClassName);
      return ((IRefactoring) cls.newInstance());
    } catch (Exception ex) {
      throw new RuntimeException(ex);
    }
  }

  @Override
  public Iterable<IContextAction> getActions(IContext context) {
    IContextAction action = createAction(RefactoringAccess.getInstance(context.getProject()).getRefactoringByClassName(myRefactoringClassName), context);
    return (action.isVisible(context) ? Sequence.<IContextAction>singleton(action) : Sequence.fromIterable(Collections.<IContextAction>emptyList()));
  }

  protected IContextAction createAction(IRefactoring refactoring, IContext context) {
    return new RefactoringAction(refactoring);
  }

}
