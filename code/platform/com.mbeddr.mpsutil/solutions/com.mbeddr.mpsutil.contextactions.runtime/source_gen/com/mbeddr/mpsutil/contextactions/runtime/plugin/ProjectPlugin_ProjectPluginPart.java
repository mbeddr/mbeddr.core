package com.mbeddr.mpsutil.contextactions.runtime.plugin;

/*Generated by MPS */

import jetbrains.mps.plugins.part.ProjectPluginPart;
import de.slisson.mps.hacks.editor.GlobalSelectionListener;
import jetbrains.mps.project.MPSProject;
import com.intellij.openapi.project.Project;
import jetbrains.mps.ide.project.ProjectHelper;
import jetbrains.mps.openapi.editor.EditorComponent;
import jetbrains.mps.openapi.editor.selection.Selection;
import com.mbeddr.mpsutil.contextactions.runtime.ToolComponent;
import com.mbeddr.mpsutil.contextactions.runtime.EditorSelectionContext;

public class ProjectPlugin_ProjectPluginPart extends ProjectPluginPart {
  private GlobalSelectionListener mySelectionListener;
  public ProjectPlugin_ProjectPluginPart() {
  }
  @Override
  public void init(MPSProject project) {
    final Project ideaProject = ProjectHelper.toIdeaProject(project);
    ProjectPlugin_ProjectPluginPart.this.mySelectionListener = new GlobalSelectionListener(project) {
      @Override
      public void selectionChanged(EditorComponent component, Selection oldSelection, Selection newSelection) {
        try {
          if (newSelection != null) {
            ToolComponent toolComponent = ToolComponent.getInstance(ideaProject);
            if (toolComponent != null) {
              toolComponent.update(new EditorSelectionContext(newSelection));
            }
          }
        } catch (Exception ex) {
        }
      }
    };
    ProjectPlugin_ProjectPluginPart.this.mySelectionListener.start();
  }
  @Override
  public void dispose(MPSProject project) {
    ProjectPlugin_ProjectPluginPart.this.mySelectionListener.stop();
  }
}
