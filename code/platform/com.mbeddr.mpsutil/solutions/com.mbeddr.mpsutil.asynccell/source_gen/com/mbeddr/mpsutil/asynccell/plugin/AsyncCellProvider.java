package com.mbeddr.mpsutil.asynccell.plugin;

/*Generated by MPS */

import jetbrains.mps.nodeEditor.AbstractCellProvider;
import java.util.concurrent.Callable;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.openapi.editor.EditorContext;

/**
 * I allow you to create a custom cell with a callable.
 * That callable is called multiple times until it returns a nonnull value.
 * The cell will show a spinner until then.
 */
public class AsyncCellProvider extends AbstractCellProvider {
  private Callable<AsyncCellValue> _valueCallable;

  public AsyncCellProvider(SNode node, Callable<AsyncCellValue> valueCallable) {
    super(node);
    _valueCallable = valueCallable;
  }

  @Override
  public EditorCell createEditorCell(EditorContext editorContext) {
    EditorCell_Async asyncCell = new EditorCell_Async(editorContext, getSNode(), _valueCallable);
    AsyncCellManager.getInstance().registerAsyncCell(asyncCell);
    return asyncCell;
  }
}
