package com.mbeddr.mpsutil.targetchooser;

/*Generated by MPS */

import org.jetbrains.annotations.Nullable;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.model.SModel;
import org.jetbrains.annotations.NotNull;
import org.jetbrains.mps.openapi.module.SModule;

public class TargetChooserOptions {
  @Nullable
  private Object myInitial;
  @Nullable
  private SNodeFilter mySNodeFilter;
  @Nullable
  private SelectionValidator mySelectionValidator;
  @Nullable
  private ModuleScope myModuleScope;
  private boolean myShowModulesPool = false;
  @Nullable
  private ModelFilter myModelFilter;
  @Nullable
  private TargetChooserScope myScope;

  public TargetChooserOptions() {
  }

  @Nullable
  public Object getInitial() {
    return myInitial;
  }

  public void setInitial(@Nullable SNode node) {
    myInitial = node;
  }

  public void setInitial(@Nullable SModel model) {
    myInitial = model;
  }

  protected void setInitial(@Nullable Object initial) {
    myInitial = initial;
  }

  @NotNull
  public SelectionValidator getSelectionValidator() {
    return (mySelectionValidator != null ? mySelectionValidator : SelectionValidator.ALWAYS_VALID);
  }

  public void setSelectionValidator(@Nullable SelectionValidator selectionValidator) {
    mySelectionValidator = selectionValidator;
  }

  @NotNull
  public SNodeFilter getSNodeFilter() {
    return (mySNodeFilter != null ? mySNodeFilter : SNodeFilter.FILTER_NOTHING);
  }

  /**
   * To show a node you also have to return true for the root node, but not for all ancestors.
   */
  public void setSNodeFilter(@Nullable SNodeFilter snodeFilter) {
    mySNodeFilter = snodeFilter;
  }

  public void setModuleScope(@Nullable ModuleScope moduleScope) {
    myModuleScope = moduleScope;
  }

  @NotNull
  public ModuleScope getModuleScope() {
    if (myModuleScope == null) {
      myModuleScope = new DefaultModuleScope();
    }
    return myModuleScope;
  }

  public void addModuleFilter(@NotNull Filter<SModule> filter) {
    setModuleScope(new FilteringModuleScope(getModuleScope(), filter));
  }

  public boolean isShowModulesPool() {
    return myShowModulesPool;
  }

  public void showModulesPool(boolean show) {
    myShowModulesPool = show;
  }

  public void showModulesPool() {
    showModulesPool(true);
  }

  public void hideModulesPool() {
    showModulesPool(false);
  }

  public void setModelFilter(@Nullable ModelFilter filter) {
    myModelFilter = filter;
  }

  @NotNull
  public ModelFilter getModelFilter() {
    return (myModelFilter != null ? myModelFilter : ModelFilter.FILTER_NOTHING);
  }

  public void setScope(@Nullable TargetChooserScope scope) {
    myScope = scope;
  }

  public void setScope(@NotNull Iterable<SNode> snodes) {
    setScope(snodes, null);
  }

  public void setScope(@NotNull Iterable<SNode> snodes, @Nullable SNodeFilter ancestorFilter) {
    setScope(new SNodesScope(snodes, ancestorFilter));
  }

  @NotNull
  public TargetChooserScope getScope() {
    return (myScope != null ? myScope : new LegacyScope(getModuleScope(), getModelFilter(), getSNodeFilter()));
  }

}
