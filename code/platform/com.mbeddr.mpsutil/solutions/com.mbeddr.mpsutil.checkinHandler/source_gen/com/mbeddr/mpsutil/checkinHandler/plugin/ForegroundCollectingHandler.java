package com.mbeddr.mpsutil.checkinHandler.plugin;

/*Generated by MPS */

import com.intellij.openapi.vcs.checkin.CheckinHandler;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.Objects;
import java.util.List;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.smodel.structure.ExtensionPoint;

public class ForegroundCollectingHandler extends CollectingCheckinHandler<ForegroundCheckinHandler> {

  @Override
  public CheckinHandler.ReturnResult beforeCheckin() {
    for (ForegroundCheckinHandler checkinHandler : ListSequence.fromList(handlers).where((it) -> it.getKeyValue())) {
      CheckinHandler.ReturnResult result = checkinHandler.actionBeforeCommit();
      if (Objects.equals(result, CheckinHandler.ReturnResult.CANCEL) || Objects.equals(result, CheckinHandler.ReturnResult.CLOSE_WINDOW)) {
        return result;
      }
    }
    return CheckinHandler.ReturnResult.COMMIT;
  }

  @Override
  public List<ForegroundCheckinHandler> queryHandlers() {
    return Sequence.fromIterable(new ExtensionPoint<ForegroundCheckinHandler>("com.mbeddr.mpsutil.checkinHandler.ForegroundCheckin").getObjects()).toList();
  }
}
