package com.mbeddr.mpsutil.checkinHandler.plugin;

/*Generated by MPS */

import jetbrains.mps.plugins.part.ApplicationPluginPart;
import com.intellij.openapi.Disposable;
import com.intellij.openapi.util.Disposer;
import java.util.List;
import com.intellij.openapi.vcs.checkin.CheckinHandlerFactory;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.LinkedList;
import com.intellij.openapi.extensions.ExtensionPoint;

public class CheckinPlugin_AppPluginPart extends ApplicationPluginPart {
  private Disposable disposable = Disposer.newDisposable(CheckinPlugin_AppPluginPart.this.getClass().getName());
  private List<CheckinHandlerFactory> factories = ListSequence.fromList(new LinkedList<CheckinHandlerFactory>());
  public CheckinPlugin_AppPluginPart() {
  }
  @Override
  public void init() {
    ExtensionPoint<CheckinHandlerFactory> extensionPoint = CheckinHandlerFactory.EP_NAME.getPoint();
    CollectingCheckinHandler[] handlers = new CollectingCheckinHandler[]{new ForegroundCollectingHandler(), new EarlyBackgroundCollectingHandler(), new LateBackgroundCollectingHandler(), new ModificationBackgroundCollectingHandler(), new PostCommitBackgroundCollectingHandler()};
    for (CollectingCheckinHandler handler : handlers) {
      CheckinHandlerFactory factory = handler.createFactory();
      extensionPoint.registerExtension(factory, CheckinPlugin_AppPluginPart.this.disposable);
      ListSequence.fromList(CheckinPlugin_AppPluginPart.this.factories).addElement(factory);
    }
  }
  @Override
  public void dispose() {
    ExtensionPoint<CheckinHandlerFactory> extensionPoint = CheckinHandlerFactory.EP_NAME.getPoint();
    Disposer.dispose(CheckinPlugin_AppPluginPart.this.disposable);

    for (CheckinHandlerFactory factory : ListSequence.fromList(CheckinPlugin_AppPluginPart.this.factories)) {
      extensionPoint.unregisterExtension(factory.getClass());
    }
  }
}
