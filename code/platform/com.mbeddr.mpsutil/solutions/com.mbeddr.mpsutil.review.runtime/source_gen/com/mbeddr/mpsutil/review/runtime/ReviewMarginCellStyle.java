package com.mbeddr.mpsutil.review.runtime;

/*Generated by MPS */

import com.mbeddr.mpsutil.margincell.runtime.MarginCellStyle;
import java.util.Map;
import java.awt.Color;
import jetbrains.mps.internal.collections.runtime.MapSequence;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Arrays;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.internal.collections.runtime.Sequence;
import java.util.Random;

public class ReviewMarginCellStyle extends MarginCellStyle {
  public static final String CREATOR_KEY = ReviewMarginCellStyle.class.getName() + ".CREATOR_KEY";

  protected static final Map<String, Color> creatorColors = MapSequence.fromMap(new LinkedHashMap<String, Color>(16, (float) 0.75, false));

  protected static final List<Color> availableCreatorColors = Arrays.asList(Color.BLUE, Color.CYAN, Color.GREEN, Color.MAGENTA, Color.ORANGE, Color.PINK);


  @Override
  public Color getLineColor(EditorCell contentCell) {
    String creator = (String) contentCell.getUserObject(CREATOR_KEY);

    if (!(MapSequence.fromMap(creatorColors).containsKey(creator))) {
      MapSequence.fromMap(creatorColors).put(creator, ListSequence.fromList(availableCreatorColors).findFirst((it) -> !(Sequence.fromIterable(MapSequence.fromMap(creatorColors).values()).contains(it))));
      if (MapSequence.fromMap(creatorColors).get(creator) == null) {
        MapSequence.fromMap(creatorColors).put(creator, ListSequence.fromList(availableCreatorColors).getElement(new Random().nextInt(ListSequence.fromList(availableCreatorColors).count())));
      }
    }

    return MapSequence.fromMap(creatorColors).get(creator);
  }
}
