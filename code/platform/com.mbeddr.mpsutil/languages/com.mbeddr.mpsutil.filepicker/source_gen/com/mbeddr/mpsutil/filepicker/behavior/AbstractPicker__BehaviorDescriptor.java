package com.mbeddr.mpsutil.filepicker.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import org.jetbrains.mps.openapi.model.SModel;
import org.jetbrains.mps.openapi.model.SNode;
import java.util.List;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.IAttributeDescriptor;
import java.nio.file.Path;
import java.nio.file.Paths;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;
import java.nio.file.Files;
import org.apache.commons.io.FilenameUtils;
import java.util.regex.Pattern;
import java.io.File;
import java.io.IOException;
import java.util.regex.Matcher;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SConceptOperations;
import java.awt.Desktop;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SInterfaceConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public final class AbstractPicker__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0xd3a0fd26445a466cL, 0x900e10444ddfed52L, 0x55705e73a6773808L, "com.mbeddr.mpsutil.filepicker.structure.AbstractPicker");

  public static final SMethod<Boolean> mustExist_id2RM$2quh1HO = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("mustExist").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3310867171609156468L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> mayBeEmpty_id2RM$2qudEJJ = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("mayBeEmpty").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3310867171608275951L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> pickDirOnly_id5lKnBeB0qXj = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("pickDirOnly").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541431623507L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> pickFileOnly_id48DzgHgr2tO = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("pickFileOnly").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4767496760281802612L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<String> getPrefix_id5lKnBeAIfOh = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getPrefix").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541426859281L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<String> getPrefix_id6WnTJkDceu8 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getPrefix").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(8005120803306792840L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<String> findInstalledSolutionPrefix_id6WnTJkDU6W6 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("findInstalledSolutionPrefix").modifiers(0, AccessPrivileges.PROTECTED).concept(CONCEPT).baseMethodId(8005120803318820614L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<String> getErrorMessage_id5lKnBeAutg0 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getErrorMessage").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422720000L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<String> getEditorPrefix_id5lKnBeAulu0 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getEditorPrefix").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422688128L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> isValidSelection_id5lKnBeAusVW = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isValidSelection").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422718716L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<String> getOutputLocationRelativePath_id5Fmx6J52q6D = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getOutputLocationRelativePath").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6545564706831704489L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""), SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<String> getCanonicalPath_id5lKnBeAuKov = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getCanonicalPath").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422798367L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<String> getCanonicalPath_id35YirduUIVl = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getCanonicalPath").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3566368989664440021L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<String> getCanonicalPath_id5lKnBeAuiS4 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getCanonicalPath").modifiers(8, AccessPrivileges.PROTECTED).concept(CONCEPT).baseMethodId(6156524541422677508L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter(String.class, ""));
  public static final SMethod<String> getCanonicalPath_id35YirduUNg0 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getCanonicalPath").modifiers(8, AccessPrivileges.PROTECTED).concept(CONCEPT).baseMethodId(3566368989664457728L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter(String.class, ""), SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<String> getNonCanonicalPath_id2_BfG8PE78n = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getNonCanonicalPath").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(2983422282001052183L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<String> getNonCanonicalPath_id2_BfG8PE9Jr = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getNonCanonicalPath").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(2983422282001062875L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<String> getNonCanonicalPath_id7c_RIoAVXmk = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getNonCanonicalPath").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(8297282968577103252L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter(String.class, ""));
  public static final SMethod<String> getNonCanonicalPath_id35YirduUTni = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getNonCanonicalPath").modifiers(8, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3566368989664482770L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter(String.class, ""), SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<String> resolvePath_id4_vItr5cCkz = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("resolvePath").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5287148819638813987L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter(String.class, ""));
  public static final SMethod<String> resolvePath_id35YirduUVCr = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("resolvePath").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3566368989664492059L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2(SMethodBuilder.createJavaParameter(String.class, ""), SMethodBuilder.createJavaParameter((Class<SModel>) ((Class) Object.class), ""));
  public static final SMethod<Boolean> exists_id5lKnBeAtTZu = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("exists").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422575582L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> isValidFile_id5lKnBeAufga = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isValidFile").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422662666L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> isValidDirectory_id5lKnBeAuiv7 = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("isValidDirectory").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422675911L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<List<String>> proposals_id5lKnBeAuxBd = new SMethodBuilder<List<String>>(new SJavaCompoundTypeImpl((Class<List<String>>) ((Class) Object.class))).name("proposals").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(6156524541422737869L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> editWithSystemEditor_id2HwAvL$nzbX = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("editWithSystemEditor").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3125667450689827581L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> openWithSystemEditor_id2HwAvL$nEXJ = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("openWithSystemEditor").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(3125667450689859439L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<Boolean> openWithSystemFileExplorer_id6uhyUqXhg1F = new SMethodBuilder<Boolean>(new SJavaCompoundTypeImpl(Boolean.TYPE)).name("openWithSystemFileExplorer").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(7462899605785870443L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();
  public static final SMethod<SNode> getCompanionFileOrFolderPicker_id3xqp6yeWGLu = new SMethodBuilder<SNode>(new SJavaCompoundTypeImpl((Class<SNode>) ((Class) Object.class))).name("getCompanionFileOrFolderPicker").modifiers(12, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(4060668414265576542L).languageId(0x900e10444ddfed52L, 0xd3a0fd26445a466cL).build2();

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(mustExist_id2RM$2quh1HO, mayBeEmpty_id2RM$2qudEJJ, pickDirOnly_id5lKnBeB0qXj, pickFileOnly_id48DzgHgr2tO, getPrefix_id5lKnBeAIfOh, getPrefix_id6WnTJkDceu8, findInstalledSolutionPrefix_id6WnTJkDU6W6, getErrorMessage_id5lKnBeAutg0, getEditorPrefix_id5lKnBeAulu0, isValidSelection_id5lKnBeAusVW, getOutputLocationRelativePath_id5Fmx6J52q6D, getCanonicalPath_id5lKnBeAuKov, getCanonicalPath_id35YirduUIVl, getCanonicalPath_id5lKnBeAuiS4, getCanonicalPath_id35YirduUNg0, getNonCanonicalPath_id2_BfG8PE78n, getNonCanonicalPath_id2_BfG8PE9Jr, getNonCanonicalPath_id7c_RIoAVXmk, getNonCanonicalPath_id35YirduUTni, resolvePath_id4_vItr5cCkz, resolvePath_id35YirduUVCr, exists_id5lKnBeAtTZu, isValidFile_id5lKnBeAufga, isValidDirectory_id5lKnBeAuiv7, proposals_id5lKnBeAuxBd, editWithSystemEditor_id2HwAvL$nzbX, openWithSystemEditor_id2HwAvL$nEXJ, openWithSystemFileExplorer_id6uhyUqXhg1F, getCompanionFileOrFolderPicker_id3xqp6yeWGLu);

  private static void ___init___(@NotNull SNode __thisNode__) {
  }

  /*package*/ static boolean mustExist_id2RM$2quh1HO(@NotNull SNode __thisNode__) {
    return true;
  }
  /*package*/ static boolean mayBeEmpty_id2RM$2qudEJJ(@NotNull SNode __thisNode__) {
    return false;
  }
  /*package*/ static boolean pickDirOnly_id5lKnBeB0qXj(@NotNull SNode __thisNode__) {
    return false;
  }
  /*package*/ static boolean pickFileOnly_id48DzgHgr2tO(@NotNull SNode __thisNode__) {
    return false;
  }
  /*package*/ static String getPrefix_id5lKnBeAIfOh(@NotNull SNode __thisNode__) {
    return AbstractPicker__BehaviorDescriptor.getPrefix_id6WnTJkDceu8.invoke(__thisNode__, SNodeOperations.getModel(__thisNode__));
  }
  /*package*/ static String getPrefix_id6WnTJkDceu8(@NotNull SNode __thisNode__, SModel originalModel) {
    return null;
  }
  /*package*/ static String findInstalledSolutionPrefix_id6WnTJkDU6W6(@NotNull SNode __thisNode__, SModel originalModel) {
    SNode info = new IAttributeDescriptor.NodeAttribute(CONCEPTS.SourceModelInfo$bD).get(SNodeOperations.getContainingRoot(__thisNode__));
    SModel sourceModel = ((info != null) ? SourceModelInfo__BehaviorDescriptor.resolve_id3YjQI$iKLTv.invoke(info, originalModel.getRepository()) : originalModel);

    if (sourceModel.getModule().isPackaged()) {
      String sourceSolutionRoot = SolutionUtil.getSolutionRootPath(sourceModel);
      if (sourceSolutionRoot != null) {
        // Option 1: /path/to/library/root/<idea plugin short (folder) name>/languages/<mps group name>/<language/solution name>.jar
        // => /path/to/library/root/<idea plugin short (folder) name>/languages/<mps group name>/<language/solution name>/
        Path prefix = Paths.get(sourceSolutionRoot, SPropertyOperations.getString(SModelOperations.getModuleStub(sourceModel), PROPS.name$MnvL));
        if (Files.exists(prefix.resolve(SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg)))) {
          return FilenameUtils.separatorsToUnix(prefix.toString());
        }

        // Option 2: /path/to/library/root/<idea plugin short (folder) name>/languages/<mps group name>/<language/solution name>.jar
        // => /path/to/library/root/<idea plugin short (folder) name>/languages/<mps group name>/
        prefix = Paths.get(sourceSolutionRoot);
        if (Files.exists(prefix.resolve(SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg)))) {
          return sourceSolutionRoot;
        }
      }
    }
    return null;
  }
  /*package*/ static String getErrorMessage_id5lKnBeAutg0(@NotNull SNode __thisNode__) {
    return "";
  }
  /*package*/ static String getEditorPrefix_id5lKnBeAulu0(@NotNull SNode __thisNode__) {
    return "";
  }
  /*package*/ static boolean isValidSelection_id5lKnBeAusVW(@NotNull SNode __thisNode__) {
    return false;
  }
  /*package*/ static String getOutputLocationRelativePath_id5Fmx6J52q6D(@NotNull SNode __thisNode__, SModel originalModel, SNode outputLocationProvider) {
    String path = AbstractPicker__BehaviorDescriptor.getCanonicalPath_id35YirduUIVl.invoke(__thisNode__, originalModel);

    // Ignore paths that already are relative
    if (Pattern.compile("^(\\.|\\.\\.)").matcher(path).find()) {
      return path;
    }

    // Don't try to relativize paths starting with a make variable or environment variable reference
    if (Pattern.compile("^(\\$\\{?\\(?[\\w_-]+\\)?\\}?|%[\\w_-]+%)").matcher(path).find()) {
      return path;
    }

    Path targetPath = Paths.get(path);
    String outputLocation = IOutputLocationProvider__BehaviorDescriptor.getOutputLocation_id7fn1GcIr3Ns.invoke(outputLocationProvider, originalModel);
    if (outputLocation == null) {
      return null;
    }
    Path outputPath = Paths.get(outputLocation);
    try {
      path = outputPath.relativize(targetPath).toString();
      return FilenameUtils.separatorsToUnix(path);
    } catch (IllegalArgumentException ex) {
      throw new IllegalArgumentException("Failed to create relative path from '" + outputPath + "' to '" + targetPath + "'", ex);
    }
  }
  /*package*/ static String getCanonicalPath_id5lKnBeAuKov(@NotNull SNode __thisNode__) {
    return AbstractPicker__BehaviorDescriptor.getCanonicalPath_id35YirduUIVl.invoke(__thisNode__, SNodeOperations.getModel(__thisNode__));
  }
  /*package*/ static String getCanonicalPath_id35YirduUIVl(@NotNull SNode __thisNode__, SModel originalModel) {
    return AbstractPicker__BehaviorDescriptor.getCanonicalPath_id35YirduUNg0.invoke(__thisNode__, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg), originalModel);
  }
  @Deprecated
  /*package*/ static String getCanonicalPath_id5lKnBeAuiS4(@NotNull SNode __thisNode__, String path) {
    return AbstractPicker__BehaviorDescriptor.getCanonicalPath_id35YirduUNg0.invoke(__thisNode__, path, SNodeOperations.getModel(__thisNode__));
  }
  /*package*/ static String getCanonicalPath_id35YirduUNg0(@NotNull SNode __thisNode__, String path, SModel originalModel) {
    path = AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id35YirduUTni.invoke(__thisNode__, path, originalModel);
    if (!(path == null || path.length() == 0)) {
      File file = new File(path);
      if (file.exists()) {
        try {
          return FilenameUtils.separatorsToUnix(file.getCanonicalPath());
        } catch (IOException e) {
          // Ignore exception
        }
      }
    }
    return path;
  }
  /*package*/ static String getNonCanonicalPath_id2_BfG8PE78n(@NotNull SNode __thisNode__) {
    return AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id2_BfG8PE9Jr.invoke(__thisNode__, SNodeOperations.getModel(__thisNode__));
  }
  /*package*/ static String getNonCanonicalPath_id2_BfG8PE9Jr(@NotNull SNode __thisNode__, SModel originalModel) {
    return AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id35YirduUTni.invoke(__thisNode__, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg), originalModel);
  }
  /*package*/ static String getNonCanonicalPath_id7c_RIoAVXmk(@NotNull SNode __thisNode__, String path) {
    return ((String) AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id35YirduUTni.invoke(__thisNode__, path, SNodeOperations.getModel(__thisNode__)));
  }
  /*package*/ static String getNonCanonicalPath_id35YirduUTni(@NotNull SNode __thisNode__, String path, SModel originalModel) {
    path = AbstractPicker__BehaviorDescriptor.resolvePath_id35YirduUVCr.invoke(__thisNode__, path, originalModel);
    if (AbstractPicker__BehaviorDescriptor.getPrefix_id6WnTJkDceu8.invoke(__thisNode__, originalModel) == null) {
      return path;
    } else {
      return FilenameUtils.separatorsToUnix(AbstractPicker__BehaviorDescriptor.getPrefix_id6WnTJkDceu8.invoke(__thisNode__, originalModel)) + "/" + path;
    }
  }
  /*package*/ static String resolvePath_id4_vItr5cCkz(@NotNull SNode __thisNode__, String path) {
    return AbstractPicker__BehaviorDescriptor.resolvePath_id35YirduUVCr.invoke(__thisNode__, path, SNodeOperations.getModel(__thisNode__));
  }
  /*package*/ static String resolvePath_id35YirduUVCr(@NotNull SNode __thisNode__, String path, SModel originalModel) {
    if (path == null) {
      path = "";
    }

    SNode pathVariableProvider = SNodeOperations.getNodeAncestor(__thisNode__, CONCEPTS.IPathVariableProvider$lK, false, false);
    if ((pathVariableProvider != null)) {
      Pattern pathVariablePattern = Pattern.compile("(.*)\\$([^$()]+)\\$(.*)");
      Matcher pathVariableMatcher = pathVariablePattern.matcher(path);
      while (pathVariableMatcher.matches()) {
        String name = pathVariableMatcher.group(2);
        String value = IPathVariableProvider__BehaviorDescriptor.getValue_id51aJIRsy2vi.invoke(pathVariableProvider, name, originalModel);
        if (value == null) {
          value = "UnknownPathVariable";
        }
        path = pathVariableMatcher.group(1) + value + pathVariableMatcher.group(3);
        pathVariableMatcher = pathVariablePattern.matcher(path);
      }
    }

    return FilenameUtils.separatorsToUnix(path);
  }
  /*package*/ static boolean exists_id5lKnBeAtTZu(@NotNull SNode __thisNode__) {
    File f = new File(AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id7c_RIoAVXmk.invoke(__thisNode__, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg)));
    return f.exists();
  }
  /*package*/ static boolean isValidFile_id5lKnBeAufga(@NotNull SNode __thisNode__) {
    File f = new File(AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id7c_RIoAVXmk.invoke(__thisNode__, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg)));
    return f.exists() && f.isFile();
  }
  /*package*/ static boolean isValidDirectory_id5lKnBeAuiv7(@NotNull SNode __thisNode__) {
    File f = new File(AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id7c_RIoAVXmk.invoke(__thisNode__, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg)));
    return f.exists() && f.isDirectory();
  }
  /*package*/ static List<String> proposals_id5lKnBeAuxBd(@NotNull SNode __thisNode__) {
    // Collect file proposals
    List<File> proposedFiles = ListSequence.fromList(new ArrayList<File>());
    if (!(SConceptOperations.isExactly(SNodeOperations.asSConcept(SNodeOperations.getConcept(__thisNode__)), CONCEPTS.AbstractPicker$bM))) {
      if ((SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg) == null || isEmptyString(SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg)) || SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg).lastIndexOf("/") < 0) && AbstractPicker__BehaviorDescriptor.getPrefix_id5lKnBeAIfOh.invoke(__thisNode__) == null) {
        // empty path so far
        File[] roots = File.listRoots();
        if (roots.length == 1) {
          // only one file system root
          for (File file : roots[0].listFiles()) {
            ListSequence.fromList(proposedFiles).addElement(file);
          }
        } else {
          // multiple file system roots
          for (File root : roots) {
            ListSequence.fromList(proposedFiles).addElement(root);
          }
        }
      } else {
        String stemPath = null;
        if (SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg) == null) {
          stemPath = "";
        } else {
          int index = SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg).lastIndexOf("/");
          if (index >= 0) {
            stemPath = SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg).substring(0, index + 1);
          }
        }

        File stem = new File(AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id7c_RIoAVXmk.invoke(__thisNode__, stemPath));
        File[] files = stem.listFiles();
        if (files != null) {
          for (File file : files) {
            if (!((boolean) AbstractPicker__BehaviorDescriptor.pickDirOnly_id5lKnBeB0qXj.invoke(__thisNode__)) || file.isDirectory()) {
              ListSequence.fromList(proposedFiles).addElement(file);
            }
          }
        }
      }
    }

    List<String> result = ListSequence.fromList(new ArrayList<String>());
    String resolvedPath = AbstractPicker__BehaviorDescriptor.resolvePath_id4_vItr5cCkz.invoke(__thisNode__, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg));
    String nonCanonicalPath = AbstractPicker__BehaviorDescriptor.getNonCanonicalPath_id7c_RIoAVXmk.invoke(__thisNode__, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg));
    for (File proposedFile : ListSequence.fromList(proposedFiles)) {
      String proposedPath = FilenameUtils.separatorsToUnix(proposedFile.getPath());
      // Only keep proposed paths that match already entered partial path
      if (proposedPath.startsWith(nonCanonicalPath)) {
        if (AbstractPicker__BehaviorDescriptor.getPrefix_id5lKnBeAIfOh.invoke(__thisNode__) != null) {
          // Remove prefix
          proposedPath = proposedPath.substring(AbstractPicker__BehaviorDescriptor.getPrefix_id5lKnBeAIfOh.invoke(__thisNode__).length() + 1);
        }
        if (SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg) != null && !(isEmptyString(SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg)))) {
          // Deresolve path variables
          proposedPath = proposedPath.replace(resolvedPath, SPropertyOperations.getString(__thisNode__, PROPS.path$VaYg));
        }
        ListSequence.fromList(result).addElement(proposedPath);
      }
    }

    // Collect path variable proposals
    SNode pathVariableProvider = SNodeOperations.getNodeAncestor(__thisNode__, CONCEPTS.IPathVariableProvider$lK, false, false);
    if ((pathVariableProvider != null)) {
      Pattern pathVariableFragmentPattern = Pattern.compile("(.*)\\$[^$()]*$");
      Matcher pathVariableFragmentMatcher = pathVariableFragmentPattern.matcher(resolvedPath);
      if (pathVariableFragmentMatcher.matches()) {
        for (String name : IPathVariableProvider__BehaviorDescriptor.getNames_id51aJIRsy1_6.invoke(pathVariableProvider)) {
          String proposedPath = pathVariableFragmentMatcher.group(1) + "$" + name + "$";
          ListSequence.fromList(result).addElement(proposedPath);
        }
      }
    }
    return result;
  }
  /*package*/ static boolean editWithSystemEditor_id2HwAvL$nzbX(@NotNull SNode __thisNode__) {
    if (!((boolean) AbstractPicker__BehaviorDescriptor.isValidFile_id5lKnBeAufga.invoke(__thisNode__))) {
      return false;
    }
    try {
      Desktop d = (Desktop.isDesktopSupported() ? Desktop.getDesktop() : null);
      if (d != null) {
        d.edit(new File(AbstractPicker__BehaviorDescriptor.getCanonicalPath_id5lKnBeAuKov.invoke(__thisNode__)));
      }
      return true;
    } catch (Exception ex) {
      ex.printStackTrace();
      return false;
    }
  }
  /*package*/ static boolean openWithSystemEditor_id2HwAvL$nEXJ(@NotNull SNode __thisNode__) {
    if (!((boolean) AbstractPicker__BehaviorDescriptor.isValidFile_id5lKnBeAufga.invoke(__thisNode__))) {
      return false;
    }
    try {
      Desktop d = (Desktop.isDesktopSupported() ? Desktop.getDesktop() : null);
      if (d != null) {
        d.open(new File(AbstractPicker__BehaviorDescriptor.getCanonicalPath_id5lKnBeAuKov.invoke(__thisNode__)));
      }
      return true;
    } catch (Exception ex) {
      ex.printStackTrace();
      return false;
    }
  }
  /*package*/ static boolean openWithSystemFileExplorer_id6uhyUqXhg1F(@NotNull SNode __thisNode__) {
    if (!((boolean) AbstractPicker__BehaviorDescriptor.isValidDirectory_id5lKnBeAuiv7.invoke(__thisNode__))) {
      return false;
    }
    try {
      Desktop d = (Desktop.isDesktopSupported() ? Desktop.getDesktop() : null);
      if (d != null) {
        d.open(new File(AbstractPicker__BehaviorDescriptor.getCanonicalPath_id5lKnBeAuKov.invoke(__thisNode__)));
      }
      return true;
    } catch (Exception ex) {
      ex.printStackTrace();
      return false;
    }
  }

  /*package*/ AbstractPicker__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((Boolean) mustExist_id2RM$2quh1HO(node));
      case 1:
        return (T) ((Boolean) mayBeEmpty_id2RM$2qudEJJ(node));
      case 2:
        return (T) ((Boolean) pickDirOnly_id5lKnBeB0qXj(node));
      case 3:
        return (T) ((Boolean) pickFileOnly_id48DzgHgr2tO(node));
      case 4:
        return (T) ((String) getPrefix_id5lKnBeAIfOh(node));
      case 5:
        return (T) ((String) getPrefix_id6WnTJkDceu8(node, (SModel) parameters[0]));
      case 6:
        return (T) ((String) findInstalledSolutionPrefix_id6WnTJkDU6W6(node, (SModel) parameters[0]));
      case 7:
        return (T) ((String) getErrorMessage_id5lKnBeAutg0(node));
      case 8:
        return (T) ((String) getEditorPrefix_id5lKnBeAulu0(node));
      case 9:
        return (T) ((Boolean) isValidSelection_id5lKnBeAusVW(node));
      case 10:
        return (T) ((String) getOutputLocationRelativePath_id5Fmx6J52q6D(node, (SModel) parameters[0], (SNode) parameters[1]));
      case 11:
        return (T) ((String) getCanonicalPath_id5lKnBeAuKov(node));
      case 12:
        return (T) ((String) getCanonicalPath_id35YirduUIVl(node, (SModel) parameters[0]));
      case 13:
        return (T) ((String) getCanonicalPath_id5lKnBeAuiS4(node, (String) parameters[0]));
      case 14:
        return (T) ((String) getCanonicalPath_id35YirduUNg0(node, (String) parameters[0], (SModel) parameters[1]));
      case 15:
        return (T) ((String) getNonCanonicalPath_id2_BfG8PE78n(node));
      case 16:
        return (T) ((String) getNonCanonicalPath_id2_BfG8PE9Jr(node, (SModel) parameters[0]));
      case 17:
        return (T) ((String) getNonCanonicalPath_id7c_RIoAVXmk(node, (String) parameters[0]));
      case 18:
        return (T) ((String) getNonCanonicalPath_id35YirduUTni(node, (String) parameters[0], (SModel) parameters[1]));
      case 19:
        return (T) ((String) resolvePath_id4_vItr5cCkz(node, (String) parameters[0]));
      case 20:
        return (T) ((String) resolvePath_id35YirduUVCr(node, (String) parameters[0], (SModel) parameters[1]));
      case 21:
        return (T) ((Boolean) exists_id5lKnBeAtTZu(node));
      case 22:
        return (T) ((Boolean) isValidFile_id5lKnBeAufga(node));
      case 23:
        return (T) ((Boolean) isValidDirectory_id5lKnBeAuiv7(node));
      case 24:
        return (T) ((List<String>) proposals_id5lKnBeAuxBd(node));
      case 25:
        return (T) ((Boolean) editWithSystemEditor_id2HwAvL$nzbX(node));
      case 26:
        return (T) ((Boolean) openWithSystemEditor_id2HwAvL$nEXJ(node));
      case 27:
        return (T) ((Boolean) openWithSystemFileExplorer_id6uhyUqXhg1F(node));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }
  private static boolean isEmptyString(String str) {
    return str == null || str.isEmpty();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept SourceModelInfo$bD = MetaAdapterFactory.getConcept(0xd3a0fd26445a466cL, 0x900e10444ddfed52L, 0x3f93dae91222f98fL, "com.mbeddr.mpsutil.filepicker.structure.SourceModelInfo");
    /*package*/ static final SInterfaceConcept IPathVariableProvider$lK = MetaAdapterFactory.getInterfaceConcept(0xd3a0fd26445a466cL, 0x900e10444ddfed52L, 0x504abeeddc88193aL, "com.mbeddr.mpsutil.filepicker.structure.IPathVariableProvider");
    /*package*/ static final SConcept AbstractPicker$bM = MetaAdapterFactory.getConcept(0xd3a0fd26445a466cL, 0x900e10444ddfed52L, 0x55705e73a6773808L, "com.mbeddr.mpsutil.filepicker.structure.AbstractPicker");
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
    /*package*/ static final SProperty path$VaYg = MetaAdapterFactory.getProperty(0xd3a0fd26445a466cL, 0x900e10444ddfed52L, 0x55705e73a6773808L, 0x55705e73a6774a6eL, "path");
  }
}
