package com.mbeddr.mpsutil.hyperlink.plugin;

/*Generated by MPS */

import jetbrains.mps.plugins.part.ProjectPluginPart;
import jetbrains.mps.openapi.editor.extensions.EditorExtension;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.openapi.editor.EditorComponent;
import jetbrains.mps.smodel.language.LanguageRegistryListener;
import jetbrains.mps.smodel.language.LanguageRuntime;
import java.util.stream.StreamSupport;
import java.util.Objects;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.project.MPSProject;
import jetbrains.mps.openapi.editor.extensions.EditorExtensionRegistry;
import jetbrains.mps.smodel.language.LanguageRegistry;

public class HyperlinkPlugin_ProjectPluginPart extends ProjectPluginPart {
  private EditorExtension extension = new EditorExtension() {
    @Override
    public boolean isApplicable(@NotNull EditorComponent component) {
      return true;
    }

    @Override
    public void install(@NotNull EditorComponent editorComponent) {
      HyperlinkListener.getOrCreateInstance(((jetbrains.mps.nodeEditor.EditorComponent) editorComponent)).install();
    }
    @Override
    public void uninstall(@NotNull EditorComponent editorComponent) {
      check_vp7zbg_a0a3a0a0(HyperlinkListener.getInstance(((jetbrains.mps.nodeEditor.EditorComponent) editorComponent)));
    }

  };
  private LanguageRegistryListener unloadListener = new LanguageRegistryListener() {
    @Override
    public void afterLanguagesLoaded(Iterable<LanguageRuntime> p1) {
    }

    @Override
    public void beforeLanguagesUnloaded(Iterable<LanguageRuntime> runtimes) {
      if (StreamSupport.stream(runtimes.spliterator(), false).anyMatch((LanguageRuntime runtime) -> Objects.equals(runtime.getIdentity(), MetaAdapterFactory.getLanguage(0x4e1f940330e483bL, 0x9a6a1648b396a81cL, "com.mbeddr.mpsutil.hyperlink")))) {
        HyperlinkListener.uninstallAll();
      }
    }
  };
  public HyperlinkPlugin_ProjectPluginPart() {
  }
  @Override
  public void init(MPSProject project) {
    EditorExtension extension = HyperlinkPlugin_ProjectPluginPart.this.extension;
    check_vp7zbg_a1a0(project.getComponent(EditorExtensionRegistry.class), extension);
    LanguageRegistry.getInstance(project.getRepository()).addRegistryListener(HyperlinkPlugin_ProjectPluginPart.this.unloadListener);
  }
  @Override
  public void dispose(MPSProject project) {
    EditorExtension extension = HyperlinkPlugin_ProjectPluginPart.this.extension;
    check_vp7zbg_a1a0_0(project.getComponent(EditorExtensionRegistry.class), extension);
    LanguageRegistry.getInstance(project.getRepository()).removeRegistryListener(HyperlinkPlugin_ProjectPluginPart.this.unloadListener);
  }
  private static void check_vp7zbg_a0a3a0a0(HyperlinkListener checkedDotOperand) {
    if (null != checkedDotOperand) {
      checkedDotOperand.uninstall();
    }

  }
  private static void check_vp7zbg_a1a0(EditorExtensionRegistry checkedDotOperand, EditorExtension extension) {
    if (null != checkedDotOperand) {
      checkedDotOperand.registerExtension(extension);
    }

  }
  private static void check_vp7zbg_a1a0_0(EditorExtensionRegistry checkedDotOperand, EditorExtension extension) {
    if (null != checkedDotOperand) {
      checkedDotOperand.unregisterExtension(extension);
    }

  }
}
