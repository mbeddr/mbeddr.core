package com.mbeddr.mpsutil.extensionclass.behavior;

/*Generated by MPS */

import jetbrains.mps.core.aspects.behaviour.BaseBHDescriptor;
import org.jetbrains.mps.openapi.language.SAbstractConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.core.aspects.behaviour.api.SMethod;
import java.util.List;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.core.aspects.behaviour.SMethodBuilder;
import jetbrains.mps.core.aspects.behaviour.SJavaCompoundTypeImpl;
import jetbrains.mps.core.aspects.behaviour.AccessPrivileges;
import java.util.Arrays;
import org.jetbrains.annotations.NotNull;
import java.util.ArrayList;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.internal.collections.runtime.Sequence;
import java.util.Objects;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.internal.collections.runtime.IterableUtils;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;
import jetbrains.mps.core.aspects.behaviour.api.SConstructor;
import org.jetbrains.annotations.Nullable;
import jetbrains.mps.core.aspects.behaviour.api.BHMethodNotFoundException;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SReferenceLink;
import org.jetbrains.mps.openapi.language.SContainmentLink;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;

public final class ExtensionClassMethodCall__BehaviorDescriptor extends BaseBHDescriptor {
  private static final SAbstractConcept CONCEPT = MetaAdapterFactory.getConcept(0xf39336d3128847eeL, 0xbbfead2ea7e4504eL, 0x4f4781239a23a494L, "com.mbeddr.mpsutil.extensionclass.structure.ExtensionClassMethodCall");

  public static final SMethod<List<SNode>> getTypeApplicationParameters_id6ffEDrb$cbj = new SMethodBuilder<List<SNode>>(new SJavaCompoundTypeImpl((Class<List<SNode>>) ((Class) Object.class))).name("getTypeApplicationParameters").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(7192154694571049683L).languageId(0xbbfead2ea7e4504eL, 0xf39336d3128847eeL).build2(SMethodBuilder.createJavaParameter(Integer.TYPE, ""));
  public static final SMethod<String> concatAutocompleteEntry_id4X7wieqBDpX = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("concatAutocompleteEntry").modifiers(1, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5712676642260686461L).languageId(0xbbfead2ea7e4504eL, 0xf39336d3128847eeL).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""), SMethodBuilder.createJavaParameter((Class<Iterable<SNode>>) ((Class) Object.class), ""));
  public static final SMethod<String> getParameterName_id4X7wieqBRAN = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getParameterName").modifiers(1, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5712676642260744627L).languageId(0xbbfead2ea7e4504eL, 0xf39336d3128847eeL).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""), SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<String> getParameterName_id4X7wieqC1Yq = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getParameterName").modifiers(1, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5712676642260787098L).languageId(0xbbfead2ea7e4504eL, 0xf39336d3128847eeL).build2(SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""), SMethodBuilder.createJavaParameter((Class<SNode>) ((Class) Object.class), ""));
  public static final SMethod<String> getAutocompleteEntry_id4X7wieq$Ix1 = new SMethodBuilder<String>(new SJavaCompoundTypeImpl(String.class)).name("getAutocompleteEntry").modifiers(0, AccessPrivileges.PUBLIC).concept(CONCEPT).baseMethodId(5712676642259920961L).languageId(0xbbfead2ea7e4504eL, 0xf39336d3128847eeL).build2();

  private static final List<SMethod<?>> BH_METHODS = Arrays.<SMethod<?>>asList(getTypeApplicationParameters_id6ffEDrb$cbj, concatAutocompleteEntry_id4X7wieqBDpX, getParameterName_id4X7wieqBRAN, getParameterName_id4X7wieqC1Yq, getAutocompleteEntry_id4X7wieq$Ix1);

  private static void ___init___(@NotNull SNode __thisNode__) {
  }

  /*package*/ static List<SNode> getTypeApplicationParameters_id6ffEDrb$cbj(@NotNull SNode __thisNode__, int actualArgs) {
    List<SNode> result = new ArrayList<SNode>();
    ListSequence.fromList(result).addSequence(ListSequence.fromList(SLinkOperations.getChildren(SLinkOperations.getTarget(__thisNode__, LINKS.baseMethodDeclaration$pyYw), LINKS.parameter$5xBj)).where((it) -> SNodeOperations.getIndexInParent(it) != 0).select((it) -> SLinkOperations.getTarget(it, LINKS.type$a1UY)));

    if (SNodeOperations.isInstanceOf(ListSequence.fromList(result).last(), CONCEPTS.VariableArityType$KF)) {
      int formalParams = ListSequence.fromList(result).count();
      // replace the vararg formal param for easier computations
      SNode last = ListSequence.fromList(result).removeLastElement();
      if (actualArgs > formalParams) {
        while (actualArgs > ListSequence.fromList(result).count()) {
          ListSequence.fromList(result).addElement(SNodeOperations.copyNode(SLinkOperations.getTarget(SNodeOperations.cast(last, CONCEPTS.VariableArityType$KF), LINKS.componentType$ypmi)));
        }
      } else if (actualArgs == formalParams) {
        // array may be passed as value for vararg
        ListSequence.fromList(result).addElement(_quotation_createNode_uuvdq4_a0a1a0d0d0a(SNodeOperations.copyNode(SLinkOperations.getTarget(SNodeOperations.cast(last, CONCEPTS.VariableArityType$KF), LINKS.componentType$ypmi)), SNodeOperations.copyNode(SLinkOperations.getTarget(SNodeOperations.cast(last, CONCEPTS.VariableArityType$KF), LINKS.componentType$ypmi))));
      }
    }

    return result;
  }
  /*package*/ static String concatAutocompleteEntry_id4X7wieqBDpX(@NotNull final SAbstractConcept __thisConcept__, final SNode method, Iterable<SNode> extensionClasses) {
    final SNode extensionClass = Sequence.fromIterable(extensionClasses).findFirst((it) -> Objects.equals(SLinkOperations.getTarget(it, LINKS.class$kmno), SNodeOperations.getNodeAncestor(method, CONCEPTS.Classifier$Ix, false, false)));
    return SPropertyOperations.getString(method, PROPS.name$MnvL) + "(" + IterableUtils.join(ListSequence.fromList(SLinkOperations.getChildren(method, LINKS.parameter$5xBj)).where((it) -> SNodeOperations.getIndexInParent(it) != 0).select((param) -> SNodeOperations.present(SLinkOperations.getTarget(param, LINKS.type$a1UY)) + " " + ExtensionClassMethodCall__BehaviorDescriptor.getParameterName_id4X7wieqBRAN.invoke(__thisConcept__, param, extensionClass)), ", ") + ")";
  }
  /*package*/ static String getParameterName_id4X7wieqBRAN(@NotNull SAbstractConcept __thisConcept__, SNode param, SNode extensionClass) {
    final SNode method = SNodeOperations.getNodeAncestor(param, CONCEPTS.StaticMethodDeclaration$FJ, false, false);
    SNode methodAnnotation = ListSequence.fromList(SLinkOperations.getChildren(extensionClass, LINKS.annotations$N1J6)).findFirst((it) -> Objects.equals(SLinkOperations.getTarget(it, LINKS.method$9MOt), method));
    return ((String) ExtensionClassMethodCall__BehaviorDescriptor.getParameterName_id4X7wieqC1Yq.invoke(__thisConcept__, param, methodAnnotation));
  }
  /*package*/ static String getParameterName_id4X7wieqC1Yq(@NotNull SAbstractConcept __thisConcept__, SNode param, SNode methodAnnotation) {
    final int origIndex = SNodeOperations.getIndexInParent(param);
    SNode paramAnnotation = ListSequence.fromList(SLinkOperations.getChildren(methodAnnotation, LINKS.parameters$y0fD)).findFirst((it) -> Objects.equals(SNodeOperations.getIndexInParent(it), origIndex - 1));
    return ((paramAnnotation != null) ? SPropertyOperations.getString(paramAnnotation, PROPS.name$MnvL) : SPropertyOperations.getString(param, PROPS.name$MnvL));
  }
  /*package*/ static String getAutocompleteEntry_id4X7wieq$Ix1(@NotNull SNode __thisNode__) {
    return ((String) ExtensionClassMethodCall__BehaviorDescriptor.concatAutocompleteEntry_id4X7wieqBDpX.invoke(__thisNode__.getConcept(), SLinkOperations.getTarget(__thisNode__, LINKS.baseMethodDeclaration$pyYw), SModelOperations.rootsIncludingImported(SNodeOperations.getModel(__thisNode__), CONCEPTS.ExtensionClass$K)));
  }

  /*package*/ ExtensionClassMethodCall__BehaviorDescriptor() {
  }

  @Override
  protected void initNode(@NotNull SNode node, @NotNull SConstructor constructor, @Nullable Object[] parameters) {
    ___init___(node);
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SNode node, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 0:
        return (T) ((List<SNode>) getTypeApplicationParameters_id6ffEDrb$cbj(node, ((int) (Integer) parameters[0])));
      case 4:
        return (T) ((String) getAutocompleteEntry_id4X7wieq$Ix1(node));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @Override
  protected <T> T invokeSpecial0(@NotNull SAbstractConcept concept, @NotNull SMethod<T> method, @Nullable Object[] parameters) {
    int methodIndex = BH_METHODS.indexOf(method);
    if (methodIndex < 0) {
      throw new BHMethodNotFoundException(this, method);
    }
    switch (methodIndex) {
      case 1:
        return (T) ((String) concatAutocompleteEntry_id4X7wieqBDpX(concept, (SNode) parameters[0], (Iterable<SNode>) parameters[1]));
      case 2:
        return (T) ((String) getParameterName_id4X7wieqBRAN(concept, (SNode) parameters[0], (SNode) parameters[1]));
      case 3:
        return (T) ((String) getParameterName_id4X7wieqC1Yq(concept, (SNode) parameters[0], (SNode) parameters[1]));
      default:
        throw new BHMethodNotFoundException(this, method);
    }
  }

  @NotNull
  @Override
  public List<SMethod<?>> getDeclaredMethods() {
    return BH_METHODS;
  }

  @NotNull
  @Override
  public SAbstractConcept getConcept() {
    return CONCEPT;
  }
  private static SNode _quotation_createNode_uuvdq4_a0a1a0d0d0a(Object parameter_1, Object parameter_2) {
    SNode quotedNode_3 = null;
    SNode quotedNode_4 = null;
    SNode quotedNode_5 = null;
    SNode quotedNode_6 = null;
    SNodeBuilder nb = new SNodeBuilder(null, null).init(MetaAdapterFactory.getConcept(MetaAdapterFactory.getLanguage(0x7a5dda6291404668L, 0xab76d5ed1746f2b2L, "jetbrains.mps.lang.typesystem"), 0x1129e737f02L, "JoinType"));
    quotedNode_3 = nb.getResult();
    SNodeBuilder nb1 = new SNodeBuilder(null, null).init(MetaAdapterFactory.getConcept(MetaAdapterFactory.getLanguage(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, "jetbrains.mps.baseLanguage"), 0xf940d819f7L, "ArrayType"));
    quotedNode_4 = nb1.getResult();
    quotedNode_6 = (SNode) parameter_1;
    if (quotedNode_6 != null) {
      quotedNode_4.addChild(MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0xf940d819f7L, 0xf940d819f8L, "componentType"), SNodeOperations.copyIfNecessary(quotedNode_6));
    }
    quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x7a5dda6291404668L, 0xab76d5ed1746f2b2L, 0x1129e737f02L, 0x1129e73a76aL, "argument"), quotedNode_4);
    quotedNode_5 = (SNode) parameter_2;
    if (quotedNode_5 != null) {
      quotedNode_3.addChild(MetaAdapterFactory.getContainmentLink(0x7a5dda6291404668L, 0xab76d5ed1746f2b2L, 0x1129e737f02L, 0x1129e73a76aL, "argument"), SNodeOperations.copyIfNecessary(quotedNode_5));
    }
    return quotedNode_3;
  }

  private static final class LINKS {
    /*package*/ static final SReferenceLink baseMethodDeclaration$pyYw = MetaAdapterFactory.getReferenceLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x11857355952L, 0xf8c78301adL, "baseMethodDeclaration");
    /*package*/ static final SContainmentLink parameter$5xBj = MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0xf8cc56b1fcL, 0xf8cc56b1feL, "parameter");
    /*package*/ static final SContainmentLink type$a1UY = MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x450368d90ce15bc3L, 0x4ed4d318133c80ceL, "type");
    /*package*/ static final SContainmentLink componentType$ypmi = MetaAdapterFactory.getContainmentLink(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x11c08f42e7bL, 0x11c08f5f38cL, "componentType");
    /*package*/ static final SReferenceLink class$kmno = MetaAdapterFactory.getReferenceLink(0xf39336d3128847eeL, 0xbbfead2ea7e4504eL, 0x4f4781239a213505L, 0x4f4781239a213506L, "class");
    /*package*/ static final SContainmentLink annotations$N1J6 = MetaAdapterFactory.getContainmentLink(0xf39336d3128847eeL, 0xbbfead2ea7e4504eL, 0x4f4781239a213505L, 0x4f4781239a797b55L, "annotations");
    /*package*/ static final SReferenceLink method$9MOt = MetaAdapterFactory.getReferenceLink(0xf39336d3128847eeL, 0xbbfead2ea7e4504eL, 0x4f4781239a7100dfL, 0x4f4781239a7100fbL, "method");
    /*package*/ static final SContainmentLink parameters$y0fD = MetaAdapterFactory.getContainmentLink(0xf39336d3128847eeL, 0xbbfead2ea7e4504eL, 0x4f4781239a7100dfL, 0x4f4781239a710390L, "parameters");
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept VariableArityType$KF = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x11c08f42e7bL, "jetbrains.mps.baseLanguage.structure.VariableArityType");
    /*package*/ static final SConcept Classifier$Ix = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0x101d9d3ca30L, "jetbrains.mps.baseLanguage.structure.Classifier");
    /*package*/ static final SConcept StaticMethodDeclaration$FJ = MetaAdapterFactory.getConcept(0xf3061a5392264cc5L, 0xa443f952ceaf5816L, 0xfbbebabf0aL, "jetbrains.mps.baseLanguage.structure.StaticMethodDeclaration");
    /*package*/ static final SConcept ExtensionClass$K = MetaAdapterFactory.getConcept(0xf39336d3128847eeL, 0xbbfead2ea7e4504eL, 0x4f4781239a213505L, "com.mbeddr.mpsutil.extensionclass.structure.ExtensionClass");
  }

  private static final class PROPS {
    /*package*/ static final SProperty name$MnvL = MetaAdapterFactory.getProperty(0xceab519525ea4f22L, 0x9b92103b95ca8c0cL, 0x110396eaaa4L, 0x110396ec041L, "name");
  }
}
