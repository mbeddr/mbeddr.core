package com.mbeddr.core.base.structure;

/*Generated by MPS */

import java.util.List;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import java.util.ArrayList;
import jetbrains.mps.baseLanguage.closures.runtime._FunctionTypes;

public class TextHelper {

  public static List<String> splitIntoLines(String s, int lineLength) {
    List<String> res = ListSequence.fromList(new ArrayList<String>());

    s = s.replaceAll("\n\n", "\n \n");
    String[] splitted = s.split("\n");

    for (int i = 0; i < splitted.length; i++) {
      String l = splitted[i];
      while (l.length() > 0) {
        if (l.length() <= lineLength) {
          ListSequence.fromList(res).addElement(l);
          break;
        }
        int p = s.lastIndexOf(" ", lineLength);
        if (p < 0) {
          ListSequence.fromList(res).addElement(l.substring(0, lineLength));
          l = l.substring(lineLength);
        } else {
          ListSequence.fromList(res).addElement(s.substring(0, p));
          l = l.substring(p + 1);
        }
      }
    }
    return res;
  }

  public static String splitIntoMLString(String s, int lineLength) {
    List<String> lines = splitIntoLines(s, lineLength);
    if (ListSequence.fromList(lines).count() == 1) {
      return ListSequence.fromList(lines).getElement(0);
    } else {
      return ListSequence.fromList(lines).tailListSequence(1).foldLeft(ListSequence.fromList(lines).first(), new _FunctionTypes._return_P2_E0<String, String, String>() {
        public String invoke(String s, String it) {
          return s + "\n" + it;
        }
      });
    }
  }

  public static String splitIntoMLStringWithExplicitNs(String s, int lineLength) {
    List<String> lines = splitIntoLines(s, lineLength);
    if (ListSequence.fromList(lines).count() == 1) {
      return ListSequence.fromList(lines).getElement(0);
    } else {
      return ListSequence.fromList(lines).tailListSequence(1).foldLeft(ListSequence.fromList(lines).first(), new _FunctionTypes._return_P2_E0<String, String, String>() {
        public String invoke(String s, String it) {
          return s + "\\n" + it;
        }
      });
    }
  }
}
