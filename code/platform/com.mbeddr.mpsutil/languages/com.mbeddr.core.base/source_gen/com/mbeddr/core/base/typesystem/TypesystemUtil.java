package com.mbeddr.core.base.typesystem;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.typechecking.TypecheckingFacade;
import jetbrains.mps.typechecking.TypecheckingSession;
import jetbrains.mps.typesystem.inference.TypeCheckerHelper;
import jetbrains.mps.newTypesystem.context.HoleTypecheckingContext;

public class TypesystemUtil {

  public static void simulateF5ForRoot(final SNode root) {
    simulateF5ForRoot(root, 1);
  }
  public static void simulateF5ForRoot(final SNode root, int c) {
    // TODO: deprecated TypeContextManager API replaced with a modern one, need to check if
    //      direct use of HoleTypecheckingContext is ok (copied from 
    //      TypeContextManager.runTypecheckingAction() impl) and all necessary rules (e.g. non-ts)
    //      get activated as necessary
    final TypecheckingFacade tf = TypecheckingFacade.getFromContext();
    tf.runIsolated(TypecheckingSession.Flags.forRoot(root), (TypecheckingSession session) -> {
      TypeCheckerHelper th = session.getData(TypeCheckerHelper.class);
      new HoleTypecheckingContext(root, th).checkRoot();
    });
  }

}
