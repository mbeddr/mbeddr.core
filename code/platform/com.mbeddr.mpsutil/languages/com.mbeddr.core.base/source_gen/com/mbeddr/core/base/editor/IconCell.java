package com.mbeddr.core.base.editor;

/*Generated by MPS */

import jetbrains.mps.nodeEditor.AbstractCellProvider;
import org.jetbrains.mps.openapi.model.SNode;
import jetbrains.mps.nodeEditor.cells.EditorCell;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.nodeEditor.cells.EditorCell_Basic;
import javax.swing.Icon;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.ide.icons.GlobalIconManager;
import java.awt.Graphics;
import jetbrains.mps.nodeEditor.cells.ParentSettings;
import java.awt.image.BufferedImage;
import jetbrains.mps.nodeEditor.cells.EditorCell_Collection;

public class IconCell extends AbstractCellProvider {

  private final int voffset;
  public IconCell(SNode node, int voffset) {
    super(node);
    this.voffset = voffset;
  }
  public EditorCell createEditorCell(EditorContext context) {
    return new MyEditorCell_Basic(context, getSNode(), context, voffset);
  }

  private class MyEditorCell_Basic extends EditorCell_Basic {
    private final Icon icon;
    private int voffset;

    public MyEditorCell_Basic(@NotNull EditorContext p0, SNode node, EditorContext context, int voffset) {
      super(p0, node);
      this.icon = GlobalIconManager.getInstance().getIconFor(node);
      this.voffset = voffset;
    }

    public void paintContent(Graphics g, ParentSettings parentSettings) {
      BufferedImage img = new BufferedImage(icon.getIconWidth(), icon.getIconHeight(), BufferedImage.TYPE_INT_ARGB);
      icon.paintIcon(null, img.getGraphics(), 0, 0);
      EditorCell_Collection parent = this.getParent();
      g.drawImage(img, parent.getX(), parent.getY() + voffset, null);
    }

    public void relayoutImpl() {
      this.myWidth = icon.getIconWidth();
      this.myHeight = icon.getIconHeight();
    }

    public boolean isLastCaretPosition() {
      return true;
    }
  }
}
