package com.mbeddr.core.base.editor;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import java.awt.Color;
import jetbrains.mps.nodeEditor.cells.EditorCell;
import jetbrains.mps.openapi.editor.EditorContext;
import jetbrains.mps.nodeEditor.cells.EditorCell_Basic;
import jetbrains.mps.openapi.editor.selection.SelectionListener;
import org.jetbrains.annotations.NotNull;
import jetbrains.mps.editor.runtime.style.StyleAttributes;
import jetbrains.mps.openapi.editor.cells.CellActionType;
import jetbrains.mps.nodeEditor.cellActions.CellAction_DeleteNode;
import java.awt.Graphics;
import jetbrains.mps.nodeEditor.cells.ParentSettings;
import java.awt.Graphics2D;
import java.awt.RenderingHints;
import com.intellij.ide.ui.AntialiasingType;
import com.intellij.util.ui.UIUtil;
import jetbrains.mps.nodeEditor.cells.EditorCell_Collection;
import java.awt.geom.GeneralPath;
import java.awt.geom.AffineTransform;
import jetbrains.mps.openapi.editor.EditorComponent;
import jetbrains.mps.openapi.editor.selection.Selection;

public class CRHelperCell extends AbstractBracketCell {
  public CRHelperCell(SNode node) {
    super(node);
  }
  public CRHelperCell(SNode node, Color c) {
    super(node, c);
  }

  public EditorCell createEditorCell(final EditorContext context) {
    EditorCell_Basic result = new Cell(context, getSNode());
    return result;
  }

  public class Cell extends EditorCell_Basic implements SelectionListener {

    public Cell(@NotNull EditorContext context, SNode node) {
      super(context, node);
      getStyle().set(StyleAttributes.getInstance().<Boolean>getAttribute("de.itemis.mps.editor.celllayout.styles", "_grow-y"), true);
      getStyle().set(StyleAttributes.getInstance().<Boolean>getAttribute("de.itemis.mps.editor.celllayout.styles", "_push-y"), true);
      setAction(CellActionType.DELETE, new CellAction_DeleteNode(node));
      setAction(CellActionType.BACKSPACE, new CellAction_DeleteNode(node));
    }

    public void paintContent(Graphics g, ParentSettings parentSettings) {
      if (shouldPaintBracket(getContext(), this, parentSettings)) {
        Graphics2D g2d = ((Graphics2D) g);
        g2d.setRenderingHint(RenderingHints.KEY_TEXT_ANTIALIASING, AntialiasingType.getKeyForCurrentScope(true));
        g2d.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
        g2d.setRenderingHint(RenderingHints.KEY_RENDERING, RenderingHints.VALUE_RENDER_QUALITY);
        g2d.setRenderingHint(RenderingHints.KEY_TEXT_LCD_CONTRAST, UIUtil.getLcdContrastValue());

        prepareGraphicsColor(g);

        int height = getHeight();
        EditorCell_Collection parent = this.getParent();
        int y = parent.getY();

        double leftEndTopStraightX = 11.0;
        double deltaY = 8.1;

        double rightmostX = 16.3;
        double bottomY = height;

        double leftEndRightLegX = 14.6;
        double upperEndLegsY = 9.6;

        double rightEndLeftLegX = 12.3;

        double leftEndLeftLegX = 10.7;
        double lowerEndBellyY = 18.1;

        double bezierA1X = 9.0;
        double bezierA1Y = 18.0;
        double bezierA2X = 7.6;
        double bezierA2Y = 17.5;
        double endAX = 6.7;
        double endAY = 16.6;

        double bezierB1X = 5.8;
        double bezierB1Y = 15.7;
        double bezierB2X = 5.3;
        double bezierB2Y = 14.6;
        double deltaX = 5.3;
        double centerBellyY = 13.1;

        double bezierC1X = 5.3;
        double bezierC1Y = 11.6;
        double bezierC2X = 5.8;
        double bezierC2Y = 10.4;
        double endCX = 6.9;
        double endCY = 9.5;

        double bezierD1X = 7.9;
        double bezierD1Y = 8.5;
        double bezierD2X = 9.3;
        double bezierD2Y = 8.1;

        GeneralPath shape0 = new GeneralPath();
        shape0.moveTo(leftEndTopStraightX, deltaY);
        // top straight
        shape0.lineTo(rightmostX, deltaY);
        // right leg
        shape0.lineTo(rightmostX, bottomY);
        shape0.lineTo(leftEndRightLegX, bottomY);
        shape0.lineTo(leftEndRightLegX, upperEndLegsY);
        // horizontal straight between legs
        shape0.lineTo(rightEndLeftLegX, upperEndLegsY);
        // left leg
        shape0.lineTo(rightEndLeftLegX, bottomY);
        shape0.lineTo(leftEndLeftLegX, bottomY);
        shape0.lineTo(leftEndLeftLegX, lowerEndBellyY);
        // belly
        shape0.curveTo(bezierA1X, bezierA1Y, bezierA2X, bezierA2Y, endAX, endAY);
        shape0.curveTo(bezierB1X, bezierB1Y, bezierB2X, bezierB2Y, deltaX, centerBellyY);
        shape0.curveTo(bezierC1X, bezierC1Y, bezierC2X, bezierC2Y, endCX, endCY);
        shape0.curveTo(bezierD1X, bezierD1Y, bezierD2X, bezierD2Y, leftEndTopStraightX, deltaY);

        shape0.transform(AffineTransform.getTranslateInstance(getX() - deltaX, y - 5));

        g2d.fill(shape0);
      }
    }

    public void relayoutImpl() {
      this.myWidth = 12;
      this.myHeight = 20;
    }

    public boolean isLastCaretPosition() {
      return true;
    }

    @Override
    public void onAdd() {
      getEditorComponent().getSelectionManager().addSelectionListener(this);
    }

    @Override
    public void onRemove() {
      getEditorComponent().getSelectionManager().removeSelectionListener(this);
    }

    public void selectionChanged(EditorComponent component, Selection selection, Selection selection1) {
      ((jetbrains.mps.nodeEditor.EditorComponent) getEditorComponent()).repaint(this);
    }
  }
}
