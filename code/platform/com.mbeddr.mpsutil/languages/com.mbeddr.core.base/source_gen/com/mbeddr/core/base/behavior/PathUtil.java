package com.mbeddr.core.base.behavior;

/*Generated by MPS */

import java.util.regex.Pattern;
import java.util.regex.Matcher;
import org.apache.commons.io.FilenameUtils;

public class PathUtil {

  public static final Pattern WINDOWS_DRIVE_PATH_PATTERN = Pattern.compile("([a-zA-Z]):(.*)");

  private static final String CYGPATH_FORMAT = "/%s%s";
  private static final String WSL_PATH_FORMAT = "/mnt/%s%s";

  public static boolean isAbsoluteWindowsPath(String path) {
    Matcher windowsDrivePathMatcher = WINDOWS_DRIVE_PATH_PATTERN.matcher(path);
    return windowsDrivePathMatcher.matches();
  }

  public static String toLinuxPath(String path) {
    return FilenameUtils.separatorsToUnix(path);
  }

  public static String toCygPath(String path) {
    path = FilenameUtils.separatorsToUnix(path);

    Matcher windowsDrivePathMatcher = WINDOWS_DRIVE_PATH_PATTERN.matcher(path);
    if (windowsDrivePathMatcher.matches()) {
      // Convert to cygpath (see https://cygwin.com/cygwin-ug-net/cygpath.html for details)
      return String.format(CYGPATH_FORMAT, windowsDrivePathMatcher.group(1).toLowerCase(), windowsDrivePathMatcher.group(2));
    }

    return path;
  }

  public static String toWSLPath(String path) {
    path = FilenameUtils.separatorsToUnix(path);

    Matcher windowsDrivePathMatcher = WINDOWS_DRIVE_PATH_PATTERN.matcher(path);
    if (windowsDrivePathMatcher.matches()) {
      // Convert to WSL path (C:/... => /mnt/c/...)
      return String.format(WSL_PATH_FORMAT, windowsDrivePathMatcher.group(1).toLowerCase(), windowsDrivePathMatcher.group(2));
    }

    return path;
  }
}
