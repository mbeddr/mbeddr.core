package com.mbeddr.mpsutil.framecell.runtime;

/*Generated by MPS */

import jetbrains.mps.nodeEditor.cellLayout.AbstractCellLayout;
import jetbrains.mps.openapi.editor.cells.EditorCell_Collection;
import jetbrains.mps.openapi.editor.cells.EditorCell;
import jetbrains.mps.editor.runtime.style.StyleAttributes;
import jetbrains.mps.openapi.editor.TextBuilder;
import jetbrains.mps.editor.runtime.TextBuilderImpl;
import jetbrains.mps.internal.collections.runtime.Sequence;

public class FrameCellLayout extends AbstractCellLayout {
  @Override
  public void doLayout(EditorCell_Collection collection) {
    EditorCell child = collection.firstCell();
    if (child != null) {
      child.relayout();

      int borderWidth = collection.getStyle().get(StyleAttributes.getInstance().<Integer>getAttribute("com.mbeddr.mpsutil.framecell", "frame-width"));
      int padding = collection.getStyle().get(StyleAttributes.getInstance().<Integer>getAttribute("com.mbeddr.mpsutil.framecell", "frame-padding"));
      int totalFrameWidth = borderWidth + padding;
      child.moveTo(collection.getX() + totalFrameWidth, collection.getY() + totalFrameWidth);
      child.relayout();
      collection.setWidth(child.getWidth() + totalFrameWidth * 2);
      collection.setHeight(child.getHeight() + totalFrameWidth * 2);
    }
  }
  public TextBuilder doLayoutText(Iterable<EditorCell> collection) {
    Iterable<EditorCell> children = collection;
    TextBuilder result = new TextBuilderImpl();
    EditorCell child = Sequence.fromIterable(children).first();
    if (child != null) {
      result.appendToTheRight(child.renderText(), false);
    }
    return result;
  }
}
