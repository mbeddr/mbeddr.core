package com.mbeddr.mpsutil.iconchar.migration;

/*Generated by MPS */

import jetbrains.mps.lang.migration.runtime.base.MigrationScriptBase;
import org.jetbrains.mps.openapi.model.SNode;
import org.jetbrains.mps.openapi.module.SModule;
import org.jetbrains.mps.openapi.model.SModel;
import jetbrains.mps.internal.collections.runtime.ListSequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SModelOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SNodeOperations;
import jetbrains.mps.lang.resources.actions.IconHelper;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SLinkOperations;
import jetbrains.mps.lang.migration.runtime.base.MigrationScriptReference;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import jetbrains.mps.smodel.builder.SNodeBuilder;
import org.jetbrains.mps.openapi.language.SConcept;
import org.jetbrains.mps.openapi.language.SProperty;
import org.jetbrains.mps.openapi.language.SContainmentLink;

public class goodByeIconChars extends MigrationScriptBase {
  private final String description = "Good bye IconChar you have served us good as long as you lasted, but now it's time to leave for the better.";
  public String getCaption() {
    return description;
  }
  @Override
  public boolean isRerunnable() {
    return true;
  }
  public SNode execute(final SModule m) {
    doExecute(m);
    return null;
  }
  public void doExecute(final SModule m) {
    for (SModel mdl : m.getModels()) {
      for (SNode icon : ListSequence.fromList(SModelOperations.nodes(mdl, CONCEPTS.IconChar$o7))) {
        SNode decl = SNodeOperations.as(SNodeOperations.getParent(icon), CONCEPTS.ConceptDeclaration$gH);
        if (decl != null) {
          SNode textIcon = createTextIcon_op8t4p_a0a0b0a0a0g(IconHelper.createId(mdl), SPropertyOperations.getString(icon, PROPS.char$etDn), SPropertyOperations.getString(icon, PROPS.textColor$e$sO).substring(1), SPropertyOperations.getString(icon, PROPS.borderColor$h3Kr).substring(1), SPropertyOperations.getString(icon, PROPS.backgroundColor$eumq).substring(1));
          SLinkOperations.setTarget(decl, LINKS.icon$HKhR, textIcon);
          SNodeOperations.deleteNode(icon);
        }
      }
    }
  }
  public MigrationScriptReference getReference() {
    return new MigrationScriptReference(MetaAdapterFactory.getLanguage(0xe840b8ae64d94b5bL, 0xb3b4eca3f222d4daL, "com.mbeddr.mpsutil.iconchar"), 0);
  }

  private static SNode createTextIcon_op8t4p_a0a0b0a0a0g(String p0, String p1, String p2, String p3, String p4) {
    SNodeBuilder n0 = new SNodeBuilder().init(CONCEPTS.TextIcon$X0);
    n0.setProperty(PROPS.iconId$SZ3g, p0);
    {
      SNodeBuilder n1 = n0.forChild(LINKS.layers$pqJD).init(CONCEPTS.Text$Bm);
      n1.setProperty(PROPS.text$pUhb, p1);
      {
        SNodeBuilder n2 = n1.forChild(LINKS.color$VAO2).init(CONCEPTS.ColorLiteral$LB);
        n2.setProperty(PROPS.val$$ZaE, p2);
      }
    }
    {
      SNodeBuilder n3 = n0.forChild(LINKS.layers$pqJD).init(CONCEPTS.Circle$43);
      {
        SNodeBuilder n4 = n3.forChild(LINKS.borderColor$VA37).init(CONCEPTS.ColorLiteral$LB);
        n4.setProperty(PROPS.val$$ZaE, p3);
      }
      {
        SNodeBuilder n5 = n3.forChild(LINKS.fillColor$VwDK).init(CONCEPTS.ColorLiteral$LB);
        n5.setProperty(PROPS.val$$ZaE, p4);
      }
    }
    return n0.getResult();
  }

  private static final class CONCEPTS {
    /*package*/ static final SConcept ConceptDeclaration$gH = MetaAdapterFactory.getConcept(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0xf979ba0450L, "jetbrains.mps.lang.structure.structure.ConceptDeclaration");
    /*package*/ static final SConcept IconChar$o7 = MetaAdapterFactory.getConcept(0xe840b8ae64d94b5bL, 0xb3b4eca3f222d4daL, 0x7b0afcb877ece1f6L, "com.mbeddr.mpsutil.iconchar.structure.IconChar");
    /*package*/ static final SConcept TextIcon$X0 = MetaAdapterFactory.getConcept(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e0d45L, "jetbrains.mps.lang.resources.structure.TextIcon");
    /*package*/ static final SConcept Text$Bm = MetaAdapterFactory.getConcept(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e28b9L, "jetbrains.mps.lang.resources.structure.Text");
    /*package*/ static final SConcept ColorLiteral$LB = MetaAdapterFactory.getConcept(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x19d079f4ec114bddL, "jetbrains.mps.lang.resources.structure.ColorLiteral");
    /*package*/ static final SConcept Circle$43 = MetaAdapterFactory.getConcept(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e0e60L, "jetbrains.mps.lang.resources.structure.Circle");
  }

  private static final class PROPS {
    /*package*/ static final SProperty char$etDn = MetaAdapterFactory.getProperty(0xe840b8ae64d94b5bL, 0xb3b4eca3f222d4daL, 0x7b0afcb877ece1f6L, 0x7b0afcb877f1364dL, "char");
    /*package*/ static final SProperty textColor$e$sO = MetaAdapterFactory.getProperty(0xe840b8ae64d94b5bL, 0xb3b4eca3f222d4daL, 0x7b0afcb877ece1f6L, 0x7b0afcb877f13655L, "textColor");
    /*package*/ static final SProperty borderColor$h3Kr = MetaAdapterFactory.getProperty(0xe840b8ae64d94b5bL, 0xb3b4eca3f222d4daL, 0x7b0afcb877ece1f6L, 0x7b0afcb877f1365cL, "borderColor");
    /*package*/ static final SProperty backgroundColor$eumq = MetaAdapterFactory.getProperty(0xe840b8ae64d94b5bL, 0xb3b4eca3f222d4daL, 0x7b0afcb877ece1f6L, 0x7b0afcb877f13650L, "backgroundColor");
    /*package*/ static final SProperty iconId$SZ3g = MetaAdapterFactory.getProperty(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e0d45L, 0x12dbb53bb6b60039L, "iconId");
    /*package*/ static final SProperty text$pUhb = MetaAdapterFactory.getProperty(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e28b9L, 0x26417c37742e28beL, "text");
    /*package*/ static final SProperty val$$ZaE = MetaAdapterFactory.getProperty(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x19d079f4ec114bddL, 0x19d079f4ec114be1L, "val");
  }

  private static final class LINKS {
    /*package*/ static final SContainmentLink icon$HKhR = MetaAdapterFactory.getContainmentLink(0xc72da2b97cce4447L, 0x8389f407dc1158b7L, 0xf979ba0450L, 0x57cf4eb14c4f9ef5L, "icon");
    /*package*/ static final SContainmentLink layers$pqJD = MetaAdapterFactory.getContainmentLink(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e0d45L, 0x26417c37742e0e66L, "layers");
    /*package*/ static final SContainmentLink color$VAO2 = MetaAdapterFactory.getContainmentLink(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e28b9L, 0x19d079f4ec114c16L, "color");
    /*package*/ static final SContainmentLink borderColor$VA37 = MetaAdapterFactory.getContainmentLink(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e28b1L, 0x19d079f4ec114c13L, "borderColor");
    /*package*/ static final SContainmentLink fillColor$VwDK = MetaAdapterFactory.getContainmentLink(0x982eb8df2c964bd7L, 0x996311712ea622e5L, 0x26417c37742e28b1L, 0x19d079f4ec114c11L, "fillColor");
  }
}
