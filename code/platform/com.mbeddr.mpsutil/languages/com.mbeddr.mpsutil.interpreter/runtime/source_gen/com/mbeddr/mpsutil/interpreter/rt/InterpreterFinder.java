package com.mbeddr.mpsutil.interpreter.rt;

/*Generated by MPS */

import org.jetbrains.mps.openapi.model.SNode;
import com.mbeddr.mpsutil.common.model.ConceptInstanceFinder;
import jetbrains.mps.internal.collections.runtime.Sequence;
import jetbrains.mps.lang.smodel.generator.smodelAdapter.SPropertyOperations;
import org.jetbrains.mps.openapi.language.SConcept;
import jetbrains.mps.smodel.adapter.structure.MetaAdapterFactory;
import org.jetbrains.mps.openapi.language.SProperty;

public class InterpreterFinder {
  private static InterpreterFinder instance;

  protected InterpreterFinder() {
  }

  public static InterpreterFinder getInstance() {
    if (instance == null) {
      instance = new InterpreterFinder();
    }

    return instance;
  }

  public static Iterable<SNode> findAllVisibleInterpreters(SNode ctx) {
    return getInstance().findAllVisibleInterpretersInternal(ctx);
  }
  public static Iterable<SNode> findVisibleInterpretersForCategory(SNode ctx, String cat) {
    return getInstance().findVisibleInterpretersForCategoryInternal(ctx, cat);
  }

  public Iterable<SNode> findAllVisibleInterpretersInternal(SNode ctx) {
    return ((Iterable<SNode>) ConceptInstanceFinder.findAllVisibleInstances(ctx, CONCEPTS.Interpreter$pR));
  }

  public Iterable<SNode> findVisibleInterpretersForCategoryInternal(SNode ctx, final String cat) {
    return Sequence.fromIterable(findAllVisibleInterpreters(ctx)).where((it) -> SPropertyOperations.getString(it, PROPS.category$ODvC) != null && SPropertyOperations.getString(it, PROPS.category$ODvC).equals(cat));
  }


  private static final class CONCEPTS {
    /*package*/ static final SConcept Interpreter$pR = MetaAdapterFactory.getConcept(0x47f075a6558e4640L, 0xa6067ce0236c8023L, 0x778ee47a6de672eaL, "com.mbeddr.mpsutil.interpreter.structure.Interpreter");
  }

  private static final class PROPS {
    /*package*/ static final SProperty category$ODvC = MetaAdapterFactory.getProperty(0x47f075a6558e4640L, 0xa6067ce0236c8023L, 0x778ee47a6de672eaL, 0x74efbb724e165bf7L, "category");
  }
}
