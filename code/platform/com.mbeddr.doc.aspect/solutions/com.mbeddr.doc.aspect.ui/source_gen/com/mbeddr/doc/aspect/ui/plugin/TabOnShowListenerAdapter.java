package com.mbeddr.doc.aspect.ui.plugin;

/*Generated by MPS */

import com.intellij.ui.AncestorListenerAdapter;
import jetbrains.mps.nodeEditor.EditorComponent;
import javax.swing.event.AncestorEvent;
import jetbrains.mps.openapi.editor.selection.SelectionManager;
import jetbrains.mps.openapi.editor.selection.Selection;
import jetbrains.mps.openapi.editor.selection.SingularSelection;

/*package*/ final class TabOnShowListenerAdapter extends AncestorListenerAdapter {

  private final EditorComponent component;
  private final IDocumentationHandler docHandler;

  /*package*/ TabOnShowListenerAdapter(final EditorComponent component, final IDocumentationHandler docHandler) {
    this.component = component;
    this.docHandler = docHandler;
  }

  @Override
  public void ancestorAdded(final AncestorEvent event) {
    // For the case when the documentation tab is opened by the user.
    // All attached listeners will be triggered but documentation will be shown only for the component which is currently in focus.
    if (this.component.getFocusTracker().getEffectiveFocusState()) {
      final SelectionManager selectionManager = this.component.getSelectionManager();
      final Selection selection = selectionManager.getSelection();
      if (selection instanceof SingularSelection) {
        this.docHandler.showDoc(this.component, (SingularSelection) selection);
      }
    }
  }
}
